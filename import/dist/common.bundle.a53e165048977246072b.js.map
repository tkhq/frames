{"version":3,"file":"common.bundle.a53e165048977246072b.js","mappings":"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","sources":["webpack://import/./src/turnkey-core.js"],"sourcesContent":["/** constants for LocalStorage */\nconst TURNKEY_TARGET_EMBEDDED_KEY = \"TURNKEY_TARGET_EMBEDDED_KEY\";\nconst TURNKEY_SETTINGS = \"TURNKEY_SETTINGS\";\n\nvar parentFrameMessageChannelPort = null;\n\n/*\n * Load a key to encrypt to as a CryptoKey and return it as a JSON Web Key.\n */\nasync function loadTargetKey(targetPublic) {\n  const targetKey = await crypto.subtle.importKey(\n    \"raw\",\n    targetPublic,\n    {\n      name: \"ECDH\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    []\n  );\n\n  return await crypto.subtle.exportKey(\"jwk\", targetKey);\n}\n\n/*\n * Loads the quorum public key as a CryptoKey.\n */\nasync function loadQuorumKey(quorumPublic) {\n  return await crypto.subtle.importKey(\n    \"raw\",\n    quorumPublic,\n    {\n      name: \"ECDSA\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    [\"verify\"]\n  );\n}\n\n/**\n * Gets the current target embedded private key JWK. Returns `null` if not found.\n */\nfunction getTargetEmbeddedKey() {\n  const jwtKey = window.localStorage.getItem(\n    TURNKEY_TARGET_EMBEDDED_KEY\n  );\n  return jwtKey ? JSON.parse(jwtKey) : null;\n}\n\n/**\n * Sets the target embedded public key JWK.\n * @param {JsonWebKey} targetKey\n */\nfunction setTargetEmbeddedKey(targetKey) {\n  window.localStorage.setItem(\n    TURNKEY_TARGET_EMBEDDED_KEY,\n    JSON.stringify(targetKey)\n  );\n}\n\n/**\n * Resets the current target embedded private key JWK.\n */\nfunction resetTargetEmbeddedKey() {\n  window.localStorage.removeItem(TURNKEY_TARGET_EMBEDDED_KEY);\n}\n\n/**\n * Gets the current settings.\n */\nfunction getSettings() {\n  const settings = window.localStorage.getItem(TURNKEY_SETTINGS);\n  return settings ? JSON.parse(settings) : null;\n}\n\n/**\n * Sets the settings object.\n * @param {Object} settings\n */\nfunction setSettings(settings) {\n  window.localStorage.setItem(\n    TURNKEY_SETTINGS,\n    JSON.stringify(settings)\n  );\n}\n\n/**\n * Takes a hex string (e.g. \"e4567ab\") and returns an array buffer (Uint8Array)\n * @param {string} hexString\n * @returns {Uint8Array}\n */\nfunction uint8arrayFromHexString(hexString) {\n  var hexRegex = /^[0-9A-Fa-f]+$/;\n  if (\n    !hexString ||\n    hexString.length % 2 != 0 ||\n    !hexRegex.test(hexString)\n  ) {\n    throw new Error(\"cannot create uint8array from invalid hex string\");\n  }\n  return new Uint8Array(\n    hexString.match(/../g).map((h) => parseInt(h, 16))\n  );\n}\n\n/**\n * Takes a Uint8Array and returns a hex string\n * @param {Uint8Array} buffer\n * @return {string}\n */\nfunction uint8arrayToHexString(buffer) {\n  return [...buffer]\n    .map((x) => x.toString(16).padStart(2, \"0\"))\n    .join(\"\");\n}\n\n/**\n * Decodes a base58-encoded string into a buffer\n * This function throws an error when the string contains invalid characters.\n * @param {string} s The base58-encoded string.\n * @return {Uint8Array} The decoded buffer.\n */\nfunction base58Decode(s) {\n  // See https://en.bitcoin.it/wiki/Base58Check_encoding\n  var alphabet =\n    \"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\";\n  var decoded = BigInt(0);\n  var decodedBytes = [];\n  var leadingZeros = [];\n  for (var i = 0; i < s.length; i++) {\n    if (alphabet.indexOf(s[i]) === -1) {\n      throw new Error(\n        `cannot base58-decode: ${s[i]} isn't a valid character`\n      );\n    }\n    var carry = alphabet.indexOf(s[i]);\n\n    // If the current base58 digit is 0, append a 0 byte.\n    // \"i == leadingZeros.length\" can only be true if we have not seen non-zero bytes so far.\n    // If we had seen a non-zero byte, carry wouldn't be 0, and i would be strictly more than `leadingZeros.length`\n    if (carry == 0 && i === leadingZeros.length) {\n      leadingZeros.push(0);\n    }\n\n    var j = 0;\n    while (j < decodedBytes.length || carry > 0) {\n      var currentByte = decodedBytes[j];\n\n      // shift the current byte 58 units and add the carry amount\n      // (or just add the carry amount if this is a new byte -- undefined case)\n      if (currentByte === undefined) {\n        currentByte = carry;\n      } else {\n        currentByte = currentByte * 58 + carry;\n      }\n\n      // find the new carry amount (1-byte shift of current byte value)\n      carry = currentByte >> 8;\n      // reset the current byte to the remainder (the carry amount will pass on the overflow)\n      decodedBytes[j] = currentByte % 256;\n      j++;\n    }\n  }\n\n  var result = leadingZeros.concat(decodedBytes.reverse());\n  return new Uint8Array(result);\n}\n\n/**\n * Returns private key bytes from a private key, represented in\n * the encoding and format specified by `keyFormat`. Defaults to\n * hex-encoding if `keyFormat` isn't passed.\n * @param {string} privateKey\n * @param {string} keyFormat Can be \"HEXADECIMAL\" or \"SOLANA\"\n */\nfunction decodeKey(privateKey, keyFormat) {\n  switch (keyFormat) {\n    case \"SOLANA\":\n      const decodedKeyBytes = base58Decode(privateKey);\n      if (decodedKeyBytes.length !== 64) {\n        throw new Error(\n          `invalid key length. Expected 64 bytes. Got ${decodedKeyBytes.length()}.`\n        );\n      }\n      return decodedKeyBytes.subarray(0, 32);\n    case \"HEXADECIMAL\":\n      if (privateKey.startsWith(\"0x\")) {\n        return uint8arrayFromHexString(privateKey.slice(2));\n      }\n      return uint8arrayFromHexString(privateKey);\n    default:\n      console.warn(\n        `invalid key format: ${keyFormat}. Defaulting to HEXADECIMAL.`\n      );\n      if (privateKey.startsWith(\"0x\")) {\n        return uint8arrayFromHexString(privateKey.slice(2));\n      }\n      return uint8arrayFromHexString(privateKey);\n  }\n}\n\nfunction setParentFrameMessageChannelPort(port) {\n  parentFrameMessageChannelPort = port;\n}\n\n/**\n * Function to normalize padding of byte array with 0's to a target length\n */\nfunction normalizePadding(byteArray, targetLength) {\n  const paddingLength = targetLength - byteArray.length;\n\n  // Add leading 0's to array\n  if (paddingLength > 0) {\n    const padding = new Uint8Array(paddingLength).fill(0);\n    return new Uint8Array([...padding, ...byteArray]);\n  }\n\n  // Remove leading 0's from array\n  if (paddingLength < 0) {\n    const expectedZeroCount = paddingLength * -1;\n    let zeroCount = 0;\n    for (\n      let i = 0;\n      i < expectedZeroCount && i < byteArray.length;\n      i++\n    ) {\n      if (byteArray[i] === 0) {\n        zeroCount++;\n      }\n    }\n    // Check if the number of zeros found equals the number of zeroes expected\n    if (zeroCount !== expectedZeroCount) {\n      throw new Error(\n        `invalid number of starting zeroes. Expected number of zeroes: ${expectedZeroCount}. Found: ${zeroCount}.`\n      );\n    }\n    return byteArray.slice(\n      expectedZeroCount,\n      expectedZeroCount + targetLength\n    );\n  }\n  return byteArray;\n}\n\n/**\n * Additional Associated Data (AAD) in the format dictated by the enclave_encrypt crate.\n */\nfunction additionalAssociatedData(senderPubBuf, receiverPubBuf) {\n  const s = Array.from(new Uint8Array(senderPubBuf));\n  const r = Array.from(new Uint8Array(receiverPubBuf));\n  return new Uint8Array([...s, ...r]);\n}\n\n/**\n * Converts an ASN.1 DER-encoded ECDSA signature to the raw format that WebCrypto uses.\n */\nfunction fromDerSignature(derSignature) {\n  const derSignatureBuf = uint8arrayFromHexString(derSignature);\n\n  // Check and skip the sequence tag (0x30)\n  let index = 2;\n\n  // Parse 'r' and check for integer tag (0x02)\n  if (derSignatureBuf[index] !== 0x02) {\n    throw new Error(\n      \"failed to convert DER-encoded signature: invalid tag for r\"\n    );\n  }\n  index++; // Move past the INTEGER tag\n  const rLength = derSignatureBuf[index];\n  index++; // Move past the length byte\n  const r = derSignatureBuf.slice(index, index + rLength);\n  index += rLength; // Move to the start of s\n\n  // Parse 's' and check for integer tag (0x02)\n  if (derSignatureBuf[index] !== 0x02) {\n    throw new Error(\n      \"failed to convert DER-encoded signature: invalid tag for s\"\n    );\n  }\n  index++; // Move past the INTEGER tag\n  const sLength = derSignatureBuf[index];\n  index++; // Move past the length byte\n  const s = derSignatureBuf.slice(index, index + sLength);\n\n  // Normalize 'r' and 's' to 32 bytes each\n  const rPadded = normalizePadding(r, 32);\n  const sPadded = normalizePadding(s, 32);\n\n  // Concatenate and return the raw signature\n  return new Uint8Array([...rPadded, ...sPadded]);\n}\n\n/**\n * Function to verify enclave signature on import bundle received from the server.\n * @param {string} enclaveQuorumPublic uncompressed public key for the quorum key which produced the signature\n * @param {string} publicSignature signature bytes encoded as a hexadecimal string\n * @param {string} signedData signed bytes encoded as a hexadecimal string. This could be public key bytes directly, or JSON-encoded bytes\n */\nasync function verifyEnclaveSignature(\n  enclaveQuorumPublic,\n  publicSignature,\n  signedData\n) {\n  /** Turnkey Signer enclave's public keys */\n  const TURNKEY_SIGNERS_ENCLAVES = {\n    prod: \"04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569\",\n    preprod:\n      \"04f3422b8afbe425d6ece77b8d2469954715a2ff273ab7ac89f1ed70e0a9325eaa1698b4351fd1b23734e65c0b6a86b62dd49d70b37c94606aac402cbd84353212\",\n  };\n\n  const TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY =\n    TURNKEY_SIGNERS_ENCLAVES[\"${TURNKEY_SIGNER_ENVIRONMENT}\"];\n  if (TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY === undefined) {\n    throw new Error(\n      \"Configuration error: TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY is undefined\"\n    );\n  }\n\n  // todo(olivia): throw error if enclave quorum public is null once server changes are deployed\n  if (enclaveQuorumPublic) {\n    if (\n      enclaveQuorumPublic !== TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY\n    ) {\n      throw new Error(\n        `enclave quorum public keys from client and bundle do not match. Client: ${TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY}. Bundle: ${enclaveQuorumPublic}.`\n      );\n    }\n  }\n\n  const encryptionQuorumPublicBuf = new Uint8Array(\n    uint8arrayFromHexString(TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY)\n  );\n  const quorumKey = await loadQuorumKey(encryptionQuorumPublicBuf);\n  if (!quorumKey) {\n    throw new Error(\"failed to load quorum key\");\n  }\n\n  // The ECDSA signature is ASN.1 DER encoded but WebCrypto uses raw format\n  const publicSignatureBuf = fromDerSignature(publicSignature);\n  const signedDataBuf = uint8arrayFromHexString(signedData);\n  return await crypto.subtle.verify(\n    { name: \"ECDSA\", hash: \"SHA-256\" },\n    quorumKey,\n    publicSignatureBuf,\n    signedDataBuf\n  );\n}\n\n/**\n * Function to validate and sanitize the styles object using the accepted map of style keys and values (as regular expressions).\n * Any invalid style throws an error. Returns an object of valid styles.\n * @param {Object} styles\n * @return {Object}\n */\nfunction validateStyles(styles, element) {\n  const validStyles = {};\n\n  const cssValidationRegex = {\n    padding: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    margin: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    borderWidth: \"^(\\\\d+(px|em|rem) ?){1,4}$\",\n    borderStyle:\n      \"^(none|solid|dashed|dotted|double|groove|ridge|inset|outset)$\",\n    borderColor:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    borderRadius: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    fontSize:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax))$\",\n    fontWeight: \"^(normal|bold|bolder|lighter|\\\\d{3})$\",\n    fontFamily: '^[^\";<>]*$', // checks for the absence of some characters that could lead to CSS/HTML injection\n    color:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    backgroundColor:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    width:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|auto)$\",\n    height:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|auto)$\",\n    maxWidth:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|none)$\",\n    maxHeight:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|none)$\",\n    lineHeight:\n      \"^(\\\\d+(\\\\.\\\\d+)?(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|normal)$\",\n    boxShadow:\n      \"^(none|(\\\\d+(px|em|rem) ?){2,4} (#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)) ?(inset)?)$\",\n    textAlign: \"^(left|right|center|justify|initial|inherit)$\",\n    overflowWrap: \"^(normal|break-word|anywhere)$\",\n    wordWrap: \"^(normal|break-word)$\",\n    resize: \"^(none|both|horizontal|vertical|block|inline)$\",\n  };\n\n  Object.entries(styles).forEach(([property, value]) => {\n    const styleProperty = property.trim();\n    if (styleProperty.length === 0) {\n      throw new Error(\"css style property cannot be empty\");\n    }\n    const styleRegexStr = cssValidationRegex[styleProperty];\n    if (!styleRegexStr) {\n      throw new Error(\n        `invalid or unsupported css style property: \"${styleProperty}\"`\n      );\n    }\n    const styleRegex = new RegExp(styleRegexStr);\n    const styleValue = value.trim();\n    if (styleValue.length == 0) {\n      throw new Error(`css style for \"${styleProperty}\" is empty`);\n    }\n    const isValidStyle = styleRegex.test(styleValue);\n    if (!isValidStyle) {\n      throw new Error(\n        `invalid css style value for property \"${styleProperty}\"`\n      );\n    }\n    validStyles[styleProperty] = styleValue;\n  });\n\n  return validStyles;\n}\n\n/**\n * Function to apply settings on this page. For now, the only settings that can be applied\n * are for \"styles\". Upon successful application, return the valid, sanitized settings JSON string.\n * @param {string} settings\n * @return {string}\n */\nfunction applySettings(settings) {\n  const validSettings = {};\n  const settingsObj = JSON.parse(settings);\n  if (settingsObj.styles) {\n    // Valid styles will be applied the \"plaintext\" textarea HTML element.\n    const plaintextTextarea = document.getElementById(\"plaintext\");\n    if (!plaintextTextarea) {\n      throw new Error(\n        \"no plaintext textarea HTML element found to apply settings to.\"\n      );\n    }\n\n    // Validate, sanitize, and apply the styles to the \"plaintext\" textarea.\n    const validStyles = validateStyles(settingsObj.styles);\n    Object.entries(validStyles).forEach(([key, value]) => {\n      plaintextTextarea.style[key] = value;\n    });\n\n    if (validStyles.backgroundColor) {\n      // Apply background color to document and body as well.\n      document.documentElement.style.backgroundColor =\n        validStyles.backgroundColor;\n      document.body.style.backgroundColor = validStyles.backgroundColor;\n    }\n\n    validSettings[\"styles\"] = validStyles;\n  }\n\n  return JSON.stringify(validSettings);\n}\n\n/**\n * Function to send a message.\n *\n * If this page is embedded as an iframe we'll send a postMessage\n * in one of two ways depending on the version of @turnkey/iframe-stamper:\n *   1. newer versions (>=v2.1.0) pass a MessageChannel MessagePort from the parent frame for postMessages.\n *   2. older versions (<v2.1.0) still use the contentWindow so we will postMessage to the window.parent for backwards compatibility.\n *\n * Otherwise we'll display it in the DOM.\n * @param type message type. Can be \"PUBLIC_KEY_CREATED\" or \"BUNDLE_INJECTED\"\n * @param value message value\n * @param requestId serves as an idempotency key to match incoming requests. Backwards compatible: if not provided, it isn't passed in.\n */\nfunction sendMessageUp(type, value, requestId) {\n  const message = {\n    type: type,\n    value: value,\n  };\n\n  // Only include requestId if it was provided\n  if (requestId) {\n    message.requestId = requestId;\n  }\n\n  if (parentFrameMessageChannelPort) {\n    parentFrameMessageChannelPort.postMessage(message);\n  } else if (window.parent !== window) {\n    window.parent.postMessage(\n      {\n        type: type,\n        value: value,\n      },\n      \"*\"\n    );\n  }\n}\n\nexport {\n  loadTargetKey,\n  getTargetEmbeddedKey,\n  setTargetEmbeddedKey,\n  resetTargetEmbeddedKey,\n  getSettings,\n  setSettings,\n  sendMessageUp,\n  uint8arrayFromHexString,\n  uint8arrayToHexString,\n  base58Decode,\n  decodeKey,\n  setParentFrameMessageChannelPort,\n  normalizePadding,\n  fromDerSignature,\n  additionalAssociatedData,\n  verifyEnclaveSignature,\n  validateStyles,\n  applySettings,\n};\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_OverloadYield","k","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_nonIterableSpread","toString","slice","constructor","name","test","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","TURNKEY_TARGET_EMBEDDED_KEY","TURNKEY_SETTINGS","parentFrameMessageChannelPort","loadTargetKey","_x","_loadTargetKey","_regeneratorRuntime","mark","_callee","targetPublic","targetKey","wrap","_context","prev","crypto","subtle","importKey","namedCurve","sent","exportKey","abrupt","stop","loadQuorumKey","_x2","_loadQuorumKey","_callee2","quorumPublic","_context2","getTargetEmbeddedKey","jwtKey","window","localStorage","getItem","JSON","parse","setTargetEmbeddedKey","setItem","stringify","resetTargetEmbeddedKey","removeItem","getSettings","settings","setSettings","uint8arrayFromHexString","hexString","Error","Uint8Array","match","map","h","parseInt","uint8arrayToHexString","buffer","x","padStart","join","base58Decode","s","alphabet","decodedBytes","BigInt","leadingZeros","indexOf","concat","carry","j","currentByte","undefined","result","reverse","decodeKey","privateKey","keyFormat","decodedKeyBytes","subarray","startsWith","console","warn","setParentFrameMessageChannelPort","port","normalizePadding","byteArray","targetLength","paddingLength","padding","fill","expectedZeroCount","zeroCount","additionalAssociatedData","senderPubBuf","receiverPubBuf","fromDerSignature","derSignature","derSignatureBuf","index","rLength","sLength","rPadded","sPadded","verifyEnclaveSignature","_x3","_x4","_x5","_verifyEnclaveSignature","_callee3","enclaveQuorumPublic","publicSignature","signedData","TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY","encryptionQuorumPublicBuf","quorumKey","publicSignatureBuf","signedDataBuf","_context3","prod","preprod","verify","hash","validateStyles","styles","element","validStyles","cssValidationRegex","margin","borderWidth","borderStyle","borderColor","borderRadius","fontSize","fontWeight","fontFamily","color","backgroundColor","width","height","maxWidth","maxHeight","lineHeight","boxShadow","textAlign","overflowWrap","wordWrap","resize","entries","forEach","_ref","_ref2","property","styleProperty","trim","styleRegexStr","styleRegex","RegExp","styleValue","applySettings","validSettings","settingsObj","plaintextTextarea","document","getElementById","_ref3","_ref4","key","style","documentElement","body","sendMessageUp","type","requestId","message","postMessage","parent"],"sourceRoot":""}