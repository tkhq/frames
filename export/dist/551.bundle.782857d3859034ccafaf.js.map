{"version":3,"file":"551.bundle.782857d3859034ccafaf.js","mappings":"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","sources":["webpack://export-tests/../shared/turnkey-core.js","webpack://export-tests/./src/turnkey-core.js","webpack://export-tests/../shared/crypto-utils.js"],"sourcesContent":["import { bech32 } from \"bech32\";\n\n/**\n * Turnkey Core Module - Shared\n * Contains all the core cryptographic and utility functions shared across frames\n */\n\n/** constants for LocalStorage */\nconst TURNKEY_EMBEDDED_KEY = \"TURNKEY_EMBEDDED_KEY\";\nconst TURNKEY_TARGET_EMBEDDED_KEY = \"TURNKEY_TARGET_EMBEDDED_KEY\";\nconst TURNKEY_SETTINGS = \"TURNKEY_SETTINGS\";\n/** 48 hours in milliseconds */\nconst TURNKEY_EMBEDDED_KEY_TTL_IN_MILLIS = 1000 * 60 * 60 * 48;\nconst TURNKEY_EMBEDDED_KEY_ORIGIN = \"TURNKEY_EMBEDDED_KEY_ORIGIN\";\n\nlet parentFrameMessageChannelPort = null;\nvar cryptoProviderOverride = null;\n\n/*\n * Returns a reference to the WebCrypto subtle interface regardless of the host environment.\n */\nfunction getSubtleCrypto() {\n  if (cryptoProviderOverride && cryptoProviderOverride.subtle) {\n    return cryptoProviderOverride.subtle;\n  }\n  if (\n    typeof globalThis !== \"undefined\" &&\n    globalThis.crypto &&\n    globalThis.crypto.subtle\n  ) {\n    return globalThis.crypto.subtle;\n  }\n  if (typeof window !== \"undefined\" && window.crypto && window.crypto.subtle) {\n    return window.crypto.subtle;\n  }\n  if (typeof global !== \"undefined\" && global.crypto && global.crypto.subtle) {\n    return global.crypto.subtle;\n  }\n  if (typeof crypto !== \"undefined\" && crypto.subtle) {\n    return crypto.subtle;\n  }\n\n  return null;\n}\n\n/*\n * Allows tests to explicitly set the crypto provider (e.g. crypto.webcrypto) when the runtime\n * environment does not expose one on the global/window objects.\n */\nfunction setCryptoProvider(cryptoProvider) {\n  cryptoProviderOverride = cryptoProvider || null;\n}\n\n/* Security functions */\n\nfunction isDoublyIframed() {\n  if (window.location.ancestorOrigins !== undefined) {\n    // Does not exist in IE and firefox.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/Location/ancestorOrigins for how this works\n    return window.location.ancestorOrigins.length > 1;\n  } else {\n    return window.parent !== window.top;\n  }\n}\n\n/*\n * Loads the quorum public key as a CryptoKey.\n */\nasync function loadQuorumKey(quorumPublic) {\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n  return await subtle.importKey(\n    \"raw\",\n    quorumPublic,\n    {\n      name: \"ECDSA\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    [\"verify\"]\n  );\n}\n\n/*\n * Load a key to encrypt to as a CryptoKey and return it as a JSON Web Key.\n */\nasync function loadTargetKey(targetPublic) {\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n  const targetKey = await subtle.importKey(\n    \"raw\",\n    targetPublic,\n    {\n      name: \"ECDH\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    []\n  );\n\n  return await subtle.exportKey(\"jwk\", targetKey);\n}\n\n/**\n * Creates a new public/private key pair and persists it in localStorage\n */\nasync function initEmbeddedKey() {\n  if (isDoublyIframed()) {\n    throw new Error(\"Doubly iframed\");\n  }\n  const retrievedKey = await getEmbeddedKey();\n  if (retrievedKey === null) {\n    const targetKey = await generateTargetKey();\n    setEmbeddedKey(targetKey);\n  }\n  // Nothing to do, key is correctly initialized!\n}\n\n/*\n * Generate a key to encrypt to and export it as a JSON Web Key.\n */\nasync function generateTargetKey() {\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n  const p256key = await subtle.generateKey(\n    {\n      name: \"ECDH\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    [\"deriveBits\"]\n  );\n\n  return await subtle.exportKey(\"jwk\", p256key.privateKey);\n}\n\n/**\n * Gets the current embedded private key JWK. Returns `null` if not found.\n */\nfunction getEmbeddedKey() {\n  const jwtKey = getItemWithExpiry(TURNKEY_EMBEDDED_KEY);\n  return jwtKey ? JSON.parse(jwtKey) : null;\n}\n\n/**\n * Sets the embedded private key JWK with the default expiration time.\n * @param {JsonWebKey} targetKey\n */\nfunction setEmbeddedKey(targetKey) {\n  setItemWithExpiry(\n    TURNKEY_EMBEDDED_KEY,\n    JSON.stringify(targetKey),\n    TURNKEY_EMBEDDED_KEY_TTL_IN_MILLIS\n  );\n}\n\n/**\n * Gets the current target embedded private key JWK. Returns `null` if not found.\n */\nfunction getTargetEmbeddedKey() {\n  const jwtKey = window.localStorage.getItem(TURNKEY_TARGET_EMBEDDED_KEY);\n  return jwtKey ? JSON.parse(jwtKey) : null;\n}\n\n/**\n * Sets the target embedded public key JWK.\n * @param {JsonWebKey} targetKey\n */\nfunction setTargetEmbeddedKey(targetKey) {\n  window.localStorage.setItem(\n    TURNKEY_TARGET_EMBEDDED_KEY,\n    JSON.stringify(targetKey)\n  );\n}\n\n/**\n * Resets the current embedded private key JWK.\n */\nfunction onResetEmbeddedKey() {\n  window.localStorage.removeItem(TURNKEY_EMBEDDED_KEY);\n  window.localStorage.removeItem(TURNKEY_EMBEDDED_KEY_ORIGIN);\n}\n\n/**\n * Resets the current target embedded private key JWK.\n */\nfunction resetTargetEmbeddedKey() {\n  window.localStorage.removeItem(TURNKEY_TARGET_EMBEDDED_KEY);\n}\n\nfunction setParentFrameMessageChannelPort(port) {\n  parentFrameMessageChannelPort = port;\n}\n\n/**\n * Gets the current settings.\n */\nfunction getSettings() {\n  const settings = window.localStorage.getItem(TURNKEY_SETTINGS);\n  return settings ? JSON.parse(settings) : null;\n}\n\n/**\n * Sets the settings object.\n * @param {Object} settings\n */\nfunction setSettings(settings) {\n  window.localStorage.setItem(TURNKEY_SETTINGS, JSON.stringify(settings));\n}\n\n/**\n * Set an item in localStorage with an expiration time\n * @param {string} key\n * @param {string} value\n * @param {number} ttl expiration time in milliseconds\n */\nfunction setItemWithExpiry(key, value, ttl) {\n  const now = new Date();\n  const item = {\n    value: value,\n    expiry: now.getTime() + ttl,\n  };\n  window.localStorage.setItem(key, JSON.stringify(item));\n}\n\n/**\n * Get an item from localStorage. Returns `null` and\n * removes the item from localStorage if expired or\n * expiry time is missing.\n * @param {string} key\n */\nfunction getItemWithExpiry(key) {\n  const itemStr = window.localStorage.getItem(key);\n  if (!itemStr) {\n    return null;\n  }\n  const item = JSON.parse(itemStr);\n  if (\n    !Object.prototype.hasOwnProperty.call(item, \"expiry\") ||\n    !Object.prototype.hasOwnProperty.call(item, \"value\")\n  ) {\n    window.localStorage.removeItem(key);\n    return null;\n  }\n  const now = new Date();\n  if (now.getTime() > item.expiry) {\n    window.localStorage.removeItem(key);\n    return null;\n  }\n  return item.value;\n}\n\n/**\n * Takes a hex string (e.g. \"e4567ab\" or \"0xe4567ab\") and returns an array buffer (Uint8Array)\n * @param {string} hexString - Hex string with or without \"0x\" prefix\n * @returns {Uint8Array}\n */\nfunction uint8arrayFromHexString(hexString) {\n  if (!hexString || typeof hexString !== \"string\") {\n    throw new Error(\"cannot create uint8array from invalid hex string\");\n  }\n\n  // Remove 0x prefix if present\n  const hexWithoutPrefix =\n    hexString.startsWith(\"0x\") || hexString.startsWith(\"0X\")\n      ? hexString.slice(2)\n      : hexString;\n\n  var hexRegex = /^[0-9A-Fa-f]+$/;\n  if (hexWithoutPrefix.length % 2 != 0 || !hexRegex.test(hexWithoutPrefix)) {\n    throw new Error(\"cannot create uint8array from invalid hex string\");\n  }\n  return new Uint8Array(\n    hexWithoutPrefix.match(/../g).map((h) => parseInt(h, 16))\n  );\n}\n\n/**\n * Takes a Uint8Array and returns a hex string\n * @param {Uint8Array} buffer\n * @return {string}\n */\nfunction uint8arrayToHexString(buffer) {\n  return [...buffer].map((x) => x.toString(16).padStart(2, \"0\")).join(\"\");\n}\n\n/**\n * Function to normalize padding of byte array with 0's to a target length\n */\nfunction normalizePadding(byteArray, targetLength) {\n  const paddingLength = targetLength - byteArray.length;\n\n  // Add leading 0's to array\n  if (paddingLength > 0) {\n    const padding = new Uint8Array(paddingLength).fill(0);\n    return new Uint8Array([...padding, ...byteArray]);\n  }\n\n  // Remove leading 0's from array\n  if (paddingLength < 0) {\n    const expectedZeroCount = paddingLength * -1;\n    let zeroCount = 0;\n    for (let i = 0; i < expectedZeroCount && i < byteArray.length; i++) {\n      if (byteArray[i] === 0) {\n        zeroCount++;\n      }\n    }\n    // Check if the number of zeros found equals the number of zeroes expected\n    if (zeroCount !== expectedZeroCount) {\n      throw new Error(\n        `invalid number of starting zeroes. Expected number of zeroes: ${expectedZeroCount}. Found: ${zeroCount}.`\n      );\n    }\n    return byteArray.slice(expectedZeroCount, expectedZeroCount + targetLength);\n  }\n  return byteArray;\n}\n\n/**\n * Additional Associated Data (AAD) in the format dictated by the enclave_encrypt crate.\n */\nfunction additionalAssociatedData(senderPubBuf, receiverPubBuf) {\n  const s = Array.from(new Uint8Array(senderPubBuf));\n  const r = Array.from(new Uint8Array(receiverPubBuf));\n  return new Uint8Array([...s, ...r]);\n}\n\n/**\n * Converts an ASN.1 DER-encoded ECDSA signature to the raw format that WebCrypto uses.\n */\nfunction fromDerSignature(derSignature) {\n  const derSignatureBuf = uint8arrayFromHexString(derSignature);\n\n  // Check and skip the sequence tag (0x30)\n  let index = 2;\n\n  // Parse 'r' and check for integer tag (0x02)\n  if (derSignatureBuf[index] !== 0x02) {\n    throw new Error(\n      \"failed to convert DER-encoded signature: invalid tag for r\"\n    );\n  }\n  index++; // Move past the INTEGER tag\n  const rLength = derSignatureBuf[index];\n  index++; // Move past the length byte\n  const r = derSignatureBuf.slice(index, index + rLength);\n  index += rLength; // Move to the start of s\n\n  // Parse 's' and check for integer tag (0x02)\n  if (derSignatureBuf[index] !== 0x02) {\n    throw new Error(\n      \"failed to convert DER-encoded signature: invalid tag for s\"\n    );\n  }\n  index++; // Move past the INTEGER tag\n  const sLength = derSignatureBuf[index];\n  index++; // Move past the length byte\n  const s = derSignatureBuf.slice(index, index + sLength);\n\n  // Normalize 'r' and 's' to 32 bytes each\n  const rPadded = normalizePadding(r, 32);\n  const sPadded = normalizePadding(s, 32);\n\n  // Concatenate and return the raw signature\n  return new Uint8Array([...rPadded, ...sPadded]);\n}\n\n/**\n * Function to verify enclave signature on import bundle received from the server.\n * @param {string} enclaveQuorumPublic uncompressed public key for the quorum key which produced the signature\n * @param {string} publicSignature signature bytes encoded as a hexadecimal string\n * @param {string} signedData signed bytes encoded as a hexadecimal string. This could be public key bytes directly, or JSON-encoded bytes\n */\nasync function verifyEnclaveSignature(\n  enclaveQuorumPublic,\n  publicSignature,\n  signedData\n) {\n  /** Turnkey Signer enclave's public keys */\n  const TURNKEY_SIGNERS_ENCLAVES = {\n    prod: \"04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569\",\n    preprod:\n      \"04f3422b8afbe425d6ece77b8d2469954715a2ff273ab7ac89f1ed70e0a9325eaa1698b4351fd1b23734e65c0b6a86b62dd49d70b37c94606aac402cbd84353212\",\n  };\n\n  // Use window.__TURNKEY_SIGNER_ENVIRONMENT__ if available (for testing), otherwise use the webpack replacement\n  const environment =\n    (typeof window !== \"undefined\" && window.__TURNKEY_SIGNER_ENVIRONMENT__) ||\n    \"__TURNKEY_SIGNER_ENVIRONMENT__\";\n  const TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY =\n    TURNKEY_SIGNERS_ENCLAVES[environment];\n\n  if (TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY === undefined) {\n    throw new Error(\n      `Configuration error: TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY is undefined`\n    );\n  }\n\n  // todo(olivia): throw error if enclave quorum public is null once server changes are deployed\n  if (enclaveQuorumPublic) {\n    if (enclaveQuorumPublic !== TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY) {\n      throw new Error(\n        `enclave quorum public keys from client and bundle do not match. Client: ${TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY}. Bundle: ${enclaveQuorumPublic}.`\n      );\n    }\n  }\n\n  const encryptionQuorumPublicBuf = new Uint8Array(\n    uint8arrayFromHexString(TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY)\n  );\n  const quorumKey = await loadQuorumKey(encryptionQuorumPublicBuf);\n  if (!quorumKey) {\n    throw new Error(\"failed to load quorum key\");\n  }\n\n  // The ECDSA signature is ASN.1 DER encoded but WebCrypto uses raw format\n  const publicSignatureBuf = fromDerSignature(publicSignature);\n  const signedDataBuf = uint8arrayFromHexString(signedData);\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n  return await subtle.verify(\n    { name: \"ECDSA\", hash: \"SHA-256\" },\n    quorumKey,\n    publicSignatureBuf,\n    signedDataBuf\n  );\n}\n\n/**\n * Function to send a message.\n *\n * If this page is embedded as an iframe we'll send a postMessage\n * in one of two ways depending on the version of @turnkey/iframe-stamper:\n *   1. newer versions (>=v2.1.0) pass a MessageChannel MessagePort from the parent frame for postMessages.\n *   2. older versions (<v2.1.0) still use the contentWindow so we will postMessage to the window.parent for backwards compatibility.\n *\n * Otherwise we'll display it in the DOM.\n * @param type message type. Can be \"PUBLIC_KEY_CREATED\" or \"BUNDLE_INJECTED\"\n * @param value message value\n * @param requestId serves as an idempotency key to match incoming requests. Backwards compatible: if not provided, it isn't passed in.\n */\nfunction sendMessageUp(type, value, requestId) {\n  const message = {\n    type: type,\n    value: value,\n  };\n\n  // Only include requestId if it was provided\n  if (requestId) {\n    message.requestId = requestId;\n  }\n\n  if (parentFrameMessageChannelPort) {\n    parentFrameMessageChannelPort.postMessage(message);\n  } else if (window.parent !== window) {\n    window.parent.postMessage(\n      {\n        type: type,\n        value: value,\n      },\n      \"*\"\n    );\n  }\n  logMessage(`⬆️ Sent message ${type}: ${value}`);\n}\n\n/**\n * Function to log a message and persist it in the page's DOM.\n */\nfunction logMessage(content) {\n  const messageLog = document.getElementById(\"message-log\");\n  if (messageLog) {\n    const message = document.createElement(\"p\");\n    message.innerText = content;\n    messageLog.appendChild(message);\n  }\n}\n\n/**\n * Convert a JSON Web Key private key to a public key and export the public\n * key in raw format.\n * @return {Uint8array}\n */\nasync function p256JWKPrivateToPublic(jwkPrivate) {\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n  // make a copy so we don't modify the underlying object\n  const jwkPrivateCopy = { ...jwkPrivate };\n  // change jwk so it will be imported as a public key\n  delete jwkPrivateCopy.d;\n  jwkPrivateCopy.key_ops = [\"verify\"];\n\n  const publicKey = await subtle.importKey(\n    \"jwk\",\n    jwkPrivateCopy,\n    { name: \"ECDSA\", namedCurve: \"P-256\" },\n    true,\n    [\"verify\"]\n  );\n  const buffer = await subtle.exportKey(\"raw\", publicKey);\n  return new Uint8Array(buffer);\n}\n\n/**\n * Encodes a buffer into a base58-encoded string.\n * @param {Uint8Array} bytes The buffer to encode.\n * @return {string} The base58-encoded string.\n */\nfunction base58Encode(bytes) {\n  // See https://en.bitcoin.it/wiki/Base58Check_encoding\n  const alphabet = \"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\";\n  let result = \"\";\n  let digits = [0];\n  for (let i = 0; i < bytes.length; i++) {\n    let carry = bytes[i];\n    for (let j = 0; j < digits.length; ++j) {\n      carry += digits[j] << 8;\n      digits[j] = carry % 58;\n      carry = (carry / 58) | 0;\n    }\n\n    while (carry > 0) {\n      digits.push(carry % 58);\n      carry = (carry / 58) | 0;\n    }\n  }\n  // Convert digits to a base58 string\n  for (let k = 0; k < digits.length; k++) {\n    result = alphabet[digits[k]] + result;\n  }\n\n  // Add '1' for each leading 0 byte\n  for (let i = 0; bytes[i] === 0 && i < bytes.length - 1; i++) {\n    result = \"1\" + result;\n  }\n  return result;\n}\n\n/**\n * Decodes a base58-encoded string into a buffer\n * This function throws an error when the string contains invalid characters.\n * @param {string} s The base58-encoded string.\n * @return {Uint8Array} The decoded buffer.\n */\nfunction base58Decode(s) {\n  // See https://en.bitcoin.it/wiki/Base58Check_encoding\n  var alphabet = \"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\";\n  var decodedBytes = [];\n  var leadingZeros = [];\n  for (var i = 0; i < s.length; i++) {\n    if (alphabet.indexOf(s[i]) === -1) {\n      throw new Error(`cannot base58-decode: ${s[i]} isn't a valid character`);\n    }\n    var carry = alphabet.indexOf(s[i]);\n\n    // If the current base58 digit is 0, append a 0 byte.\n    // \"i == leadingZeros.length\" can only be true if we have not seen non-zero bytes so far.\n    // If we had seen a non-zero byte, carry wouldn't be 0, and i would be strictly more than `leadingZeros.length`\n    if (carry == 0 && i === leadingZeros.length) {\n      leadingZeros.push(0);\n    }\n\n    var j = 0;\n    while (j < decodedBytes.length || carry > 0) {\n      var currentByte = decodedBytes[j];\n\n      // shift the current byte 58 units and add the carry amount\n      // (or just add the carry amount if this is a new byte -- undefined case)\n      if (currentByte === undefined) {\n        currentByte = carry;\n      } else {\n        currentByte = currentByte * 58 + carry;\n      }\n\n      // find the new carry amount (1-byte shift of current byte value)\n      carry = currentByte >> 8;\n      // reset the current byte to the remainder (the carry amount will pass on the overflow)\n      decodedBytes[j] = currentByte % 256;\n      j++;\n    }\n  }\n\n  var result = leadingZeros.concat(decodedBytes.reverse());\n  return new Uint8Array(result);\n}\n\n/**\n * Decodes a base58check-encoded string and verifies the checksum.\n * Base58Check encoding includes a 4-byte checksum at the end to detect errors.\n * The checksum is the first 4 bytes of SHA256(SHA256(payload)).\n * This function throws an error if the checksum is invalid.\n * @param {string} s The base58check-encoded string.\n * @return {Promise<Uint8Array>} The decoded payload (without checksum).\n */\nasync function base58CheckDecode(s) {\n  const decoded = base58Decode(s);\n\n  if (decoded.length < 5) {\n    throw new Error(\n      `invalid base58check length: expected at least 5 bytes, got ${decoded.length}`\n    );\n  }\n\n  const payload = decoded.subarray(0, decoded.length - 4);\n  const checksum = decoded.subarray(decoded.length - 4);\n\n  const subtle = getSubtleCrypto();\n  if (!subtle) {\n    throw new Error(\"WebCrypto subtle API is unavailable\");\n  }\n\n  // Compute double SHA256 hash\n  const hash1Buf = await subtle.digest(\"SHA-256\", payload);\n  const hash1 = new Uint8Array(hash1Buf);\n  const hash2Buf = await subtle.digest(\"SHA-256\", hash1);\n  const hash2 = new Uint8Array(hash2Buf);\n  const computedChecksum = hash2.subarray(0, 4);\n\n  // Verify checksum\n  const mismatch =\n    (checksum[0] ^ computedChecksum[0]) |\n    (checksum[1] ^ computedChecksum[1]) |\n    (checksum[2] ^ computedChecksum[2]) |\n    (checksum[3] ^ computedChecksum[3]);\n  if (mismatch !== 0) {\n    throw new Error(\"invalid base58check checksum\");\n  }\n\n  return payload;\n}\n\n/**\n * Encodes a Uint8Array into a base58-check-encoded string\n * Throws an error if the input is invalid or the checksum is invalid.\n * @param {Uint8Array} payload The raw payload to encode.\n * @return {Promise<string>} The base58check-encoded string.\n */\nasync function base58CheckEncode(payload) {\n  const hash1Buf = await crypto.subtle.digest(\"SHA-256\", payload);\n  const hash1 = new Uint8Array(hash1Buf);\n\n  const hash2Buf = await crypto.subtle.digest(\"SHA-256\", hash1);\n  const hash2 = new Uint8Array(hash2Buf);\n\n  const checksum = hash2.slice(0, 4);\n\n  const full = new Uint8Array(payload.length + 4);\n  full.set(payload, 0);\n  full.set(checksum, payload.length);\n\n  return base58Encode(full);\n}\n\n/**\n * Returns private key bytes from a private key, represented in\n * the encoding and format specified by `keyFormat`. Defaults to\n * hex-encoding if `keyFormat` isn't passed.\n * @param {string} privateKey\n * @param {string} keyFormat Can be \"HEXADECIMAL\", \"SUI_BECH32\", \"BITCOIN_MAINNET_WIF\", \"BITCOIN_TESTNET_WIF\" or \"SOLANA\"\n * @return {Promise<Uint8Array>}\n */\nasync function decodeKey(privateKey, keyFormat) {\n  switch (keyFormat) {\n    case \"SOLANA\": {\n      const decodedKeyBytes = base58Decode(privateKey);\n      if (decodedKeyBytes.length !== 64) {\n        throw new Error(\n          `invalid key length. Expected 64 bytes. Got ${decodedKeyBytes.length}.`\n        );\n      }\n      return decodedKeyBytes.subarray(0, 32);\n    }\n    case \"HEXADECIMAL\":\n      if (privateKey.startsWith(\"0x\")) {\n        return uint8arrayFromHexString(privateKey.slice(2));\n      }\n      return uint8arrayFromHexString(privateKey);\n    case \"BITCOIN_MAINNET_WIF\": {\n      const payload = await base58CheckDecode(privateKey);\n\n      const version = payload[0];\n      const keyAndFlags = payload.subarray(1);\n\n      // 0x80 = mainnet\n      if (version !== 0x80) {\n        throw new Error(\n          `invalid WIF version byte: ${version}. Expected 0x80 (mainnet).`\n        );\n      }\n\n      // Check for common mistake: uncompressed keys\n      if (keyAndFlags.length === 32) {\n        throw new Error(\"uncompressed WIF keys not supported\");\n      }\n\n      // Validate compressed format\n      if (keyAndFlags.length !== 33 || keyAndFlags[32] !== 0x01) {\n        throw new Error(\"invalid WIF format: expected compressed private key\");\n      }\n\n      return keyAndFlags.subarray(0, 32);\n    }\n    case \"BITCOIN_TESTNET_WIF\": {\n      const payload = await base58CheckDecode(privateKey);\n\n      const version = payload[0];\n      const keyAndFlags = payload.subarray(1);\n\n      // 0xEF = testnet\n      if (version !== 0xef) {\n        throw new Error(\n          `invalid WIF version byte: ${version}. Expected 0xEF (testnet).`\n        );\n      }\n\n      // Check for common mistake: uncompressed keys\n      if (keyAndFlags.length === 32) {\n        throw new Error(\"uncompressed WIF keys not supported\");\n      }\n\n      // Validate compressed format\n      if (keyAndFlags.length !== 33 || keyAndFlags[32] !== 0x01) {\n        throw new Error(\"invalid WIF format: expected compressed private key\");\n      }\n\n      return keyAndFlags.subarray(0, 32);\n    }\n    case \"SUI_BECH32\": {\n      const { prefix, words } = bech32.decode(privateKey);\n\n      if (prefix !== \"suiprivkey\") {\n        throw new Error(\n          `invalid SUI private key human-readable part (HRP): expected \"suiprivkey\"`\n        );\n      }\n\n      const bytes = bech32.fromWords(words);\n      if (bytes.length !== 33) {\n        throw new Error(\n          `invalid SUI private key length: expected 33 bytes, got ${bytes.length}`\n        );\n      }\n\n      const schemeFlag = bytes[0];\n      const privkey = bytes.slice(1);\n\n      // schemeFlag = 0 is Ed25519; We currently only support Ed25519 keys for SUI.\n      if (schemeFlag !== 0) {\n        throw new Error(\n          `invalid SUI private key scheme flag: expected 0 (Ed25519). Turnkey only supports Ed25519 keys for SUI.`\n        );\n      }\n\n      return new Uint8Array(privkey);\n    }\n    default:\n      console.warn(\n        `invalid key format: ${keyFormat}. Defaulting to HEXADECIMAL.`\n      );\n      if (privateKey.startsWith(\"0x\")) {\n        return uint8arrayFromHexString(privateKey.slice(2));\n      }\n      return uint8arrayFromHexString(privateKey);\n  }\n}\n\n/**\n * Returns a private key from private key bytes, represented in\n * the encoding and format specified by `keyFormat`. Defaults to\n * hex-encoding if `keyFormat` isn't passed.\n * @param {Uint8Array} privateKeyBytes\n * @param {string} keyFormat Can be \"HEXADECIMAL\", \"SUI_BECH32\", \"BITCOIN_MAINNET_WIF\", \"BITCOIN_TESTNET_WIF\" or \"SOLANA\"\n */\nasync function encodeKey(privateKeyBytes, keyFormat, publicKeyBytes) {\n  switch (keyFormat) {\n    case \"SOLANA\": {\n      if (!publicKeyBytes) {\n        throw new Error(\"public key must be specified for SOLANA key format\");\n      }\n      if (privateKeyBytes.length !== 32) {\n        throw new Error(\n          `invalid private key length. Expected 32 bytes. Got ${privateKeyBytes.length}.`\n        );\n      }\n      if (publicKeyBytes.length !== 32) {\n        throw new Error(\n          `invalid public key length. Expected 32 bytes. Got ${publicKeyBytes.length}.`\n        );\n      }\n      const concatenatedBytes = new Uint8Array(64);\n      concatenatedBytes.set(privateKeyBytes, 0);\n      concatenatedBytes.set(publicKeyBytes, 32);\n      return base58Encode(concatenatedBytes);\n    }\n    case \"HEXADECIMAL\":\n      return \"0x\" + uint8arrayToHexString(privateKeyBytes);\n    case \"BITCOIN_MAINNET_WIF\":\n    case \"BITCOIN_TESTNET_WIF\": {\n      if (privateKeyBytes.length !== 32) {\n        throw new Error(\n          `invalid private key length. Expected 32 bytes. Got ${privateKeyBytes.length}.`\n        );\n      }\n\n      const version = keyFormat === \"BITCOIN_MAINNET_WIF\" ? 0x80 : 0xef;\n      const wifPayload = new Uint8Array(34);\n      wifPayload[0] = version;\n      wifPayload.set(privateKeyBytes, 1);\n      wifPayload[33] = 0x01; // compressed flag\n\n      return await base58CheckEncode(wifPayload);\n    }\n    case \"SUI_BECH32\": {\n      if (privateKeyBytes.length !== 32) {\n        throw new Error(\n          `invalid private key length. Expected 32 bytes. Got ${privateKeyBytes.length}.`\n        );\n      }\n\n      const schemeFlag = 0x00; // ED25519 | We only support ED25519 keys for Sui currently\n      const bech32Payload = new Uint8Array(1 + 32);\n      bech32Payload[0] = schemeFlag;\n      bech32Payload.set(privateKeyBytes, 1);\n\n      return bech32.encode(\"suiprivkey\", bech32.toWords(bech32Payload));\n    }\n    default:\n      console.warn(\n        `invalid key format: ${keyFormat}. Defaulting to HEXADECIMAL.`\n      );\n      return \"0x\" + uint8arrayToHexString(privateKeyBytes);\n  }\n}\n\n// Helper to parse a private key into a Solana base58 private key.\n// To be used if a wallet account is exported without the `SOLANA` address format.\nfunction parsePrivateKey(privateKey) {\n  if (Array.isArray(privateKey)) {\n    return new Uint8Array(privateKey);\n  }\n\n  if (typeof privateKey === \"string\") {\n    // Remove 0x prefix if present\n    if (privateKey.startsWith(\"0x\")) {\n      privateKey = privateKey.slice(2);\n    }\n\n    // Check if it's hex-formatted correctly (i.e. 64 hex chars)\n    if (privateKey.length === 64 && /^[0-9a-fA-F]+$/.test(privateKey)) {\n      return uint8arrayFromHexString(privateKey);\n    }\n\n    // Otherwise assume it's base58 format (for Solana)\n    try {\n      return base58Decode(privateKey);\n    } catch (error) {\n      throw new Error(\n        \"Invalid private key format. Use hex (64 chars) or base58 format.\"\n      );\n    }\n  }\n\n  throw new Error(\"Private key must be a string (hex/base58) or number array\");\n}\n\n/**\n * Function to validate and sanitize the styles object using the accepted map of style keys and values (as regular expressions).\n * Any invalid style throws an error. Returns an object of valid styles.\n * @param {Object} styles\n * @param {HTMLElement} element - Optional element parameter (for import frame)\n * @return {Object}\n */\nfunction validateStyles(styles, element) {\n  const validStyles = {};\n\n  const cssValidationRegex = {\n    padding: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    margin: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    borderWidth: \"^(\\\\d+(px|em|rem) ?){1,4}$\",\n    borderStyle:\n      \"^(none|solid|dashed|dotted|double|groove|ridge|inset|outset)$\",\n    borderColor:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    borderRadius: \"^(\\\\d+(px|em|%|rem) ?){1,4}$\",\n    fontSize: \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax))$\",\n    fontWeight: \"^(normal|bold|bolder|lighter|\\\\d{3})$\",\n    fontFamily: '^[^\";<>]*$', // checks for the absence of some characters that could lead to CSS/HTML injection\n    color:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    labelColor:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    backgroundColor:\n      \"^(transparent|inherit|initial|#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)|hsla?\\\\(\\\\d{1,3}, \\\\d{1,3}%, \\\\d{1,3}%(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\))$\",\n    width: \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|auto)$\",\n    height: \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|auto)$\",\n    maxWidth: \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|none)$\",\n    maxHeight:\n      \"^(\\\\d+(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|none)$\",\n    lineHeight:\n      \"^(\\\\d+(\\\\.\\\\d+)?(px|em|rem|%|vh|vw|in|cm|mm|pt|pc|ex|ch|vmin|vmax)|normal)$\",\n    boxShadow:\n      \"^(none|(\\\\d+(px|em|rem) ?){2,4} (#[0-9a-f]{3,8}|rgba?\\\\(\\\\d{1,3}, \\\\d{1,3}, \\\\d{1,3}(, \\\\d?(\\\\.\\\\d{1,2})?)?\\\\)) ?(inset)?)$\",\n    textAlign: \"^(left|right|center|justify|initial|inherit)$\",\n    overflowWrap: \"^(normal|break-word|anywhere)$\",\n    wordWrap: \"^(normal|break-word)$\",\n    resize: \"^(none|both|horizontal|vertical|block|inline)$\",\n  };\n\n  Object.entries(styles).forEach(([property, value]) => {\n    const styleProperty = property.trim();\n    if (styleProperty.length === 0) {\n      throw new Error(\"css style property cannot be empty\");\n    }\n    const styleRegexStr = cssValidationRegex[styleProperty];\n    if (!styleRegexStr) {\n      throw new Error(\n        `invalid or unsupported css style property: \"${styleProperty}\"`\n      );\n    }\n    const styleRegex = new RegExp(styleRegexStr);\n    const styleValue = value.trim();\n    if (styleValue.length == 0) {\n      throw new Error(`css style for \"${styleProperty}\" is empty`);\n    }\n    const isValidStyle = styleRegex.test(styleValue);\n    if (!isValidStyle) {\n      throw new Error(\n        `invalid css style value for property \"${styleProperty}\"`\n      );\n    }\n    validStyles[styleProperty] = styleValue;\n  });\n\n  return validStyles;\n}\n\n// Export all shared functions\nexport {\n  setCryptoProvider,\n  getSubtleCrypto,\n  isDoublyIframed,\n  loadQuorumKey,\n  loadTargetKey,\n  initEmbeddedKey,\n  generateTargetKey,\n  getEmbeddedKey,\n  setEmbeddedKey,\n  getTargetEmbeddedKey,\n  setTargetEmbeddedKey,\n  onResetEmbeddedKey,\n  resetTargetEmbeddedKey,\n  setParentFrameMessageChannelPort,\n  getSettings,\n  setSettings,\n  setItemWithExpiry,\n  getItemWithExpiry,\n  uint8arrayFromHexString,\n  uint8arrayToHexString,\n  normalizePadding,\n  additionalAssociatedData,\n  fromDerSignature,\n  verifyEnclaveSignature,\n  sendMessageUp,\n  logMessage,\n  p256JWKPrivateToPublic,\n  base58Encode,\n  base58Decode,\n  base58CheckDecode,\n  base58CheckEncode,\n  decodeKey,\n  encodeKey,\n  parsePrivateKey,\n  validateStyles,\n};\n","import \"./styles.css\";\nimport * as SharedTKHQ from \"@shared/turnkey-core.js\";\nimport * as nobleEd25519 from \"@noble/ed25519\";\nimport { sha512 } from \"@noble/hashes/sha2.js\";\n\nconst {\n  getSettings,\n  setSettings,\n  sendMessageUp,\n  uint8arrayFromHexString,\n  uint8arrayToHexString,\n  base58Decode,\n  base58Encode,\n  base58CheckEncode,\n  encodeKey,\n  setParentFrameMessageChannelPort,\n  normalizePadding,\n  fromDerSignature,\n  additionalAssociatedData,\n  verifyEnclaveSignature,\n  validateStyles,\n  p256JWKPrivateToPublic,\n  setItemWithExpiry,\n  onResetEmbeddedKey,\n  setEmbeddedKey,\n  getEmbeddedKey,\n  generateTargetKey,\n  initEmbeddedKey,\n  logMessage,\n} = SharedTKHQ;\n\n/**\n * Function to apply settings on this page. For now, the only settings that can be applied\n * are for \"styles\". Upon successful application, return the valid, sanitized settings JSON string.\n * @param {string} settings\n * @return {string}\n */\nfunction applySettings(settings) {\n  const validSettings = {};\n  if (!settings) {\n    return JSON.stringify(validSettings);\n  }\n  const settingsObj = JSON.parse(settings);\n  if (settingsObj.styles) {\n    // Valid styles will be applied the \"key-div\" div HTML element.\n    const keyDivTextarea = document.getElementById(\"key-div\");\n    if (!keyDivTextarea) {\n      throw new Error(\"no key-div HTML element found to apply settings to.\");\n    }\n\n    // Validate, sanitize, and apply the styles to the \"key-div\" div element.\n    const validStyles = validateStyles(settingsObj.styles);\n    Object.entries(validStyles).forEach(([key, value]) => {\n      keyDivTextarea.style[key] = value;\n    });\n\n    if (validStyles.backgroundColor) {\n      // Apply background color to document and body as well.\n      document.documentElement.style.backgroundColor =\n        validStyles.backgroundColor;\n      document.body.style.backgroundColor = validStyles.backgroundColor;\n    }\n\n    validSettings[\"styles\"] = validStyles;\n  }\n\n  return JSON.stringify(validSettings);\n}\n\n/**\n * Returns the public key bytes for a hex-encoded Ed25519 private key.\n * @param {string} privateKeyHex\n */\nfunction getEd25519PublicKey(privateKeyHex) {\n  nobleEd25519.etc.sha512Sync = (...m) =>\n    sha512(nobleEd25519.etc.concatBytes(...m));\n\n  return nobleEd25519.getPublicKey(privateKeyHex);\n}\n\n/**\n * Returns a UTF-8 encoded wallet mnemonic + newline optional passphrase\n * from wallet bytes.\n * @param {Uint8Array} walletBytes\n */\nfunction encodeWallet(walletBytes) {\n  const decoder = new TextDecoder(\"utf-8\");\n  const wallet = decoder.decode(walletBytes);\n  let mnemonic;\n  let passphrase = null;\n\n  if (wallet.includes(\"\\n\")) {\n    const parts = wallet.split(\"\\n\");\n    mnemonic = parts[0];\n    passphrase = parts[1];\n  } else {\n    mnemonic = wallet;\n  }\n\n  return {\n    mnemonic: mnemonic,\n    passphrase: passphrase,\n  };\n}\n\n/**\n * Get an item from localStorage. Returns `null` and\n * removes the item from localStorage if expired or\n * expiry time is missing.\n * @param {string} key\n */\nfunction getItemWithExpiry(key) {\n  const itemStr = window.localStorage.getItem(key);\n  if (!itemStr) {\n    return null;\n  }\n  const item = JSON.parse(itemStr);\n  if (!Object.hasOwn(item, \"expiry\") || !Object.hasOwn(item, \"value\")) {\n    window.localStorage.removeItem(key);\n    return null;\n  }\n  const now = new Date();\n  if (now.getTime() > item.expiry) {\n    window.localStorage.removeItem(key);\n    return null;\n  }\n  return item.value;\n}\n\nexport {\n  initEmbeddedKey,\n  generateTargetKey,\n  setItemWithExpiry,\n  getEmbeddedKey,\n  setEmbeddedKey,\n  onResetEmbeddedKey,\n  p256JWKPrivateToPublic,\n  base58Encode,\n  base58Decode,\n  base58CheckEncode,\n  encodeKey,\n  sendMessageUp,\n  uint8arrayFromHexString,\n  uint8arrayToHexString,\n  setParentFrameMessageChannelPort,\n  normalizePadding,\n  fromDerSignature,\n  additionalAssociatedData,\n  verifyEnclaveSignature,\n  validateStyles,\n  getSettings,\n  setSettings,\n  logMessage,\n  getItemWithExpiry,\n  getEd25519PublicKey,\n  applySettings,\n  encodeWallet,\n};\n","/**\n * Crypto Utilities - Shared\n * Contains HPKE encryption and decryption functions\n */\n\nimport {\n  p256JWKPrivateToPublic,\n  additionalAssociatedData,\n  uint8arrayToHexString,\n} from \"./turnkey-core.js\";\nimport {\n  CipherSuite,\n  DhkemP256HkdfSha256,\n  HkdfSha256,\n  Aes256Gcm,\n} from \"@hpke/core\";\n\n// Pre-compute const (for perf)\nconst TURNKEY_HPKE_INFO = new TextEncoder().encode(\"turnkey_hpke\");\n\n/**\n * Decrypt the ciphertext (ArrayBuffer) given an encapsulation key (ArrayBuffer)\n * and the receivers private key (JSON Web Key).\n */\nexport async function HpkeDecrypt({\n  ciphertextBuf,\n  encappedKeyBuf,\n  receiverPrivJwk,\n}) {\n  const kemContext = new DhkemP256HkdfSha256();\n  var receiverPriv = await kemContext.importKey(\n    \"jwk\",\n    { ...receiverPrivJwk },\n    false\n  );\n\n  var suite = new CipherSuite({\n    kem: kemContext,\n    kdf: new HkdfSha256(),\n    aead: new Aes256Gcm(),\n  });\n\n  var recipientCtx = await suite.createRecipientContext({\n    recipientKey: receiverPriv,\n    enc: encappedKeyBuf,\n    info: TURNKEY_HPKE_INFO,\n  });\n\n  var receiverPubBuf = await p256JWKPrivateToPublic(receiverPrivJwk);\n  var aad = additionalAssociatedData(encappedKeyBuf, receiverPubBuf);\n  var res;\n  try {\n    res = await recipientCtx.open(ciphertextBuf, aad);\n  } catch (e) {\n    throw new Error(\n      \"unable to decrypt bundle using embedded key. the bundle may be incorrect. failed with error: \" +\n        e.toString()\n    );\n  }\n  return res;\n}\n\n/**\n * Encrypt plaintext using HPKE with the receiver's public key.\n * @param {Object} params\n * @param {Uint8Array} params.plaintextBuf - Plaintext to encrypt\n * @param {JsonWebKey} params.receiverPubJwk - Receiver's public key in JWK format\n * @returns {Promise<string>} JSON stringified encrypted bundle with encappedPublic and ciphertext\n */\nexport async function HpkeEncrypt({ plaintextBuf, receiverPubJwk }) {\n  const kemContext = new DhkemP256HkdfSha256();\n  const receiverPub = await kemContext.importKey(\n    \"jwk\",\n    { ...receiverPubJwk },\n    true\n  );\n\n  const suite = new CipherSuite({\n    kem: kemContext,\n    kdf: new HkdfSha256(),\n    aead: new Aes256Gcm(),\n  });\n\n  const senderCtx = await suite.createSenderContext({\n    recipientPublicKey: receiverPub,\n    info: TURNKEY_HPKE_INFO,\n  });\n\n  // Need to import the key again as a JWK to export as a raw key, the format needed to\n  // create the aad with the newly generated raw encapped key.\n  const receiverPubCryptoKey = await crypto.subtle.importKey(\n    \"jwk\",\n    receiverPubJwk,\n    {\n      name: \"ECDSA\",\n      namedCurve: \"P-256\",\n    },\n    true,\n    []\n  );\n  const receiverPubRaw = await crypto.subtle.exportKey(\n    \"raw\",\n    receiverPubCryptoKey\n  );\n  const receiverPubBuf = new Uint8Array(receiverPubRaw);\n\n  const encappedKeyBuf = new Uint8Array(senderCtx.enc);\n\n  const aad = additionalAssociatedData(encappedKeyBuf, receiverPubBuf);\n\n  var ciphertextBuf;\n  try {\n    ciphertextBuf = await senderCtx.seal(plaintextBuf, aad);\n  } catch (e) {\n    throw new Error(\"failed to encrypt import bundle: \" + e.toString());\n  }\n\n  const ciphertextHex = uint8arrayToHexString(new Uint8Array(ciphertextBuf));\n  const encappedKeyBufHex = uint8arrayToHexString(encappedKeyBuf);\n  const encryptedBundle = JSON.stringify({\n    encappedPublic: encappedKeyBufHex,\n    ciphertext: ciphertextHex,\n  });\n  return encryptedBundle;\n}\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_OverloadYield","k","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","toString","slice","constructor","name","test","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","TURNKEY_EMBEDDED_KEY","TURNKEY_SETTINGS","TURNKEY_EMBEDDED_KEY_TTL_IN_MILLIS","TURNKEY_EMBEDDED_KEY_ORIGIN","parentFrameMessageChannelPort","getSubtleCrypto","globalThis","crypto","subtle","window","global","isDoublyIframed","undefined","location","ancestorOrigins","parent","top","loadQuorumKey","_x","_loadQuorumKey","_regeneratorRuntime","mark","_callee","quorumPublic","wrap","_context","prev","next","Error","importKey","namedCurve","abrupt","sent","stop","initEmbeddedKey","_initEmbeddedKey","_callee3","_context3","getEmbeddedKey","generateTargetKey","setEmbeddedKey","_generateTargetKey","_callee4","p256key","_context4","generateKey","exportKey","privateKey","jwtKey","key","itemStr","localStorage","getItem","item","JSON","parse","hasOwnProperty","Date","getTime","expiry","removeItem","getItemWithExpiry","targetKey","setItemWithExpiry","stringify","onResetEmbeddedKey","setParentFrameMessageChannelPort","port","getSettings","settings","setSettings","setItem","ttl","uint8arrayFromHexString","hexString","hexWithoutPrefix","startsWith","Uint8Array","match","map","h","parseInt","uint8arrayToHexString","buffer","x","padStart","join","normalizePadding","byteArray","targetLength","paddingLength","padding","fill","concat","expectedZeroCount","zeroCount","additionalAssociatedData","senderPubBuf","receiverPubBuf","s","fromDerSignature","derSignature","derSignatureBuf","index","rLength","sLength","rPadded","sPadded","verifyEnclaveSignature","_x3","_x4","_x5","_verifyEnclaveSignature","_callee5","enclaveQuorumPublic","publicSignature","signedData","TURNKEY_SIGNERS_ENCLAVES","environment","TURNKEY_SIGNER_ENCLAVE_QUORUM_PUBLIC_KEY","encryptionQuorumPublicBuf","quorumKey","publicSignatureBuf","signedDataBuf","_context5","prod","preprod","__TURNKEY_SIGNER_ENVIRONMENT__","verify","hash","sendMessageUp","type","requestId","message","postMessage","logMessage","content","messageLog","document","getElementById","createElement","innerText","appendChild","p256JWKPrivateToPublic","_x6","_p256JWKPrivateToPublic","_callee6","jwkPrivate","jwkPrivateCopy","publicKey","_context6","_objectSpread","key_ops","base58Encode","bytes","result","digits","carry","j","push","base58Decode","alphabet","decodedBytes","leadingZeros","indexOf","currentByte","reverse","base58CheckEncode","_x8","_base58CheckEncode","_callee8","payload","hash1Buf","hash1","hash2Buf","hash2","checksum","full","_context8","digest","set","encodeKey","_x11","_x12","_x13","_encodeKey","_callee10","privateKeyBytes","keyFormat","publicKeyBytes","concatenatedBytes","version","wifPayload","bech32Payload","_context10","t0","bech32","encode","toWords","console","warn","validateStyles","styles","element","validStyles","cssValidationRegex","margin","borderWidth","borderStyle","borderColor","borderRadius","fontSize","fontWeight","fontFamily","color","labelColor","backgroundColor","width","height","maxWidth","maxHeight","lineHeight","boxShadow","textAlign","overflowWrap","wordWrap","resize","entries","forEach","_ref","_ref2","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","property","styleProperty","trim","styleRegexStr","styleRegex","RegExp","styleValue","SharedTKHQ","applySettings","validSettings","settingsObj","keyDivTextarea","style","documentElement","body","getEd25519PublicKey","privateKeyHex","nobleEd25519","sha512Sync","_nobleEd25519$etc","sha512","concatBytes","encodeWallet","walletBytes","mnemonic","wallet","TextDecoder","decode","passphrase","includes","parts","split","hasOwn","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_defineProperty","getOwnPropertyDescriptors","defineProperties","_typeof","toPrimitive","String","_toPrimitive","_toPropertyKey","TURNKEY_HPKE_INFO","TextEncoder","HpkeDecrypt","_HpkeDecrypt","ciphertextBuf","encappedKeyBuf","receiverPrivJwk","kemContext","receiverPriv","suite","recipientCtx","aad","res","DhkemP256HkdfSha256","CipherSuite","kem","kdf","HkdfSha256","aead","Aes256Gcm","createRecipientContext","recipientKey","enc","info","open"],"sourceRoot":""}