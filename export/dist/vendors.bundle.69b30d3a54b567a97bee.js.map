{"version":3,"file":"vendors.bundle.69b30d3a54b567a97bee.js","mappings":";yJAIO,MAAMA,UAAkBC,MAC3B,WAAAC,CAAYC,GACR,IAAIC,EAEAA,EADAD,aAAaF,MACHE,EAAEC,QAEM,iBAAND,EACFA,EAGA,GAEdE,MAAMD,GACNE,KAAKC,KAAOD,KAAKJ,YAAYK,IACjC,EAMG,MAAM,UAA0BP,GAYhC,MAAM,UAAuBA,GAM7B,MAAM,UAAyBA,GAM/B,MAAMQ,UAAmBR,GAMzB,MAAMS,UAAmBT,GAMzB,MAAMU,UAAoBV,GAM1B,MAAMW,UAAkBX,GAMxB,MAAMY,UAAkBZ,GAMxB,MAAMa,UAAiCb,GAMvC,MAAMc,UAA2Bd,GAMjC,MAAM,UAA0BA,GC1FvC,MACae,GACaC,EADoBC,WACXC,EAFhB,CAAC,EAGT,IAAIC,MAAMH,EAAS,CACtBI,IAAG,CAACC,EAASC,EAAMC,IACXD,KAAQJ,EACDA,EAAOI,GAGPN,EAAQM,GAGvBE,IAAG,CAACH,EAASC,EAAMG,KACXH,KAAQJ,UACDA,EAAOI,GAElBN,EAAQM,GAAQG,GACT,GAEX,cAAAC,CAAeL,EAASC,GACpB,IAAIK,GAAU,EASd,OARIL,KAAQJ,WACDA,EAAOI,GACdK,GAAU,GAEVL,KAAQN,WACDA,EAAQM,GACfK,GAAU,GAEPA,CACX,EACA,OAAAC,CAAQP,GACJ,MAAMQ,EAAWC,QAAQF,QAAQZ,GAC3Be,EAAUD,QAAQF,QAAQV,GAC1Bc,EAAa,IAAIC,IAAIF,GAC3B,MAAO,IAAIF,EAASK,OAAQC,IAAOH,EAAWI,IAAID,OAAQJ,EAC9D,EACAM,eAAc,CAAChB,EAASC,EAAMgB,KACtBhB,KAAQJ,UACDA,EAAOI,GAElBQ,QAAQO,eAAerB,EAASM,EAAMgB,IAC/B,GAEXC,yBAAwB,CAAClB,EAASC,IAC1BA,KAAQJ,EACDY,QAAQS,yBAAyBrB,EAAQI,GAGzCQ,QAAQS,yBAAyBvB,EAASM,GAGzDc,IAAG,CAACf,EAASC,IACFA,KAAQJ,GAAUI,KAAQN,KAnD7C,IAA0BA,EAASE,ECe5B,MAAMsB,EACT,WAAAtC,GACIuC,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAOoB,GAEf,CACA,YAAMC,QACgBD,IAAdvC,KAAKyC,OAGTzC,KAAKyC,WA5BbC,iBACI,QAA8BH,IAA1B,QAA6DA,IAAtB5B,WAAWgC,OAElD,OAAOhC,WAAWgC,OAAOC,OAG7B,IAEI,MAAM,UAAEC,SAAoB,kCAC5B,OAAOA,EAAUD,MACrB,CACA,MAAO/C,GACH,MAAM,IAAI,EAAkBA,EAChC,CACJ,CAc0BiD,GACtB,EC5BG,MCFMC,EAAqB,KAKrB,EAAQ,IAAIC,WAAW,GCLvB,EAAsB,IAAIA,WAAW,CAC9C,GACA,GACA,GACA,EACA,ICcS,EAAmBC,GAAmB,iBAANA,GACnC,OAANA,GACwB,iBAAjBA,EAAEC,YACc,iBAAhBD,EAAEE,UAIN,SAAS,EAAMC,EAAGC,GACrB,GAAIA,GAAK,EACL,MAAM,IAAI1D,MAAM,yBAEpB,GAAIyD,GAAK,KAAOC,EACZ,MAAM,IAAI1D,MAAM,4BAEpB,MAAM2D,EAAM,IAAIN,WAAWK,GAC3B,IAAK,IAAIE,EAAI,EAAGA,EAAIF,GAAKD,EAAGG,IACxBD,EAAID,GAAKE,EAAI,IAAMH,EAAI,IACvBA,IAAS,EAEb,OAAOE,CACX,CAOO,SAAS,EAAOE,EAAGC,GACtB,MAAMH,EAAM,IAAIN,WAAWQ,EAAEE,OAASD,EAAEC,QAGxC,OAFAJ,EAAIpC,IAAIsC,EAAG,GACXF,EAAIpC,IAAIuC,EAAGD,EAAEE,QACNJ,CACX,CC/CA,MAAMK,EAAgB,IAAIX,WAAW,CAAC,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,MAG5DY,EAAsB,IAAIZ,WAAW,CACvC,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAC3C,IAAK,IAAK,MASP,MAAMa,EACT,WAAAjE,CAAYkE,EAAIC,EAAMC,GAClB7B,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,aAAc,CACtCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,gBAAiB,CACzCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,iBAAkB,CAC1CoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,QAAS,CACjCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBnB,KAAK8D,GAAKA,EACV9D,KAAKiE,MAAQF,EACb/D,KAAKkE,KAAOF,EACZ,MAAMG,EAAU,IAAInB,WAAW,GAC/BmB,EAAQjD,IAAI,EAAMlB,KAAK8D,GAAI,GAAI,GAC/B9D,KAAKkE,KAAKE,KAAKD,EACnB,CACA,wBAAME,CAAmBC,GACrB,aAAatE,KAAKiE,MAAMI,mBAAmBC,EAC/C,CACA,0BAAMC,CAAqBD,GACvB,aAAatE,KAAKiE,MAAMM,qBAAqBD,EACjD,CACA,yBAAME,CAAoBF,GACtB,aAAatE,KAAKiE,MAAMO,oBAAoBF,EAChD,CACA,2BAAMG,CAAsBH,GACxB,aAAatE,KAAKiE,MAAMQ,sBAAsBH,EAClD,CACA,eAAMI,CAAUC,EAAQL,EAAKM,GAAW,GACpC,aAAa5E,KAAKiE,MAAMS,UAAUC,EAAQL,EAAKM,EACnD,CACA,qBAAMC,GACF,aAAa7E,KAAKiE,MAAMY,iBAC5B,CACA,mBAAMC,CAAcC,GAChB,GAAIA,EAAIC,WAAajC,EACjB,MAAM,IAAI,EAAkB,gBAEhC,aAAa/C,KAAKiE,MAAMa,cAAcC,EAC1C,CACA,WAAME,CAAMC,GACR,IAAIC,EAEAA,OADe5C,IAAf2C,EAAOE,UACIpF,KAAK6E,kBAEX,EAAgBK,EAAOE,KAEvBF,EAAOE,UAIDpF,KAAK8E,cAAcI,EAAOE,KAEzC,MAAMC,QAAYrF,KAAKiE,MAAMI,mBAAmBc,EAAGhC,WAC7CmC,QAAatF,KAAKiE,MAAMI,mBAAmBa,EAAOK,oBACxD,IACI,IAAIC,EAYAC,EAXJ,QAAyBlD,IAArB2C,EAAOQ,UACPF,EAAK,IAAIxC,iBAAiBhD,KAAKiE,MAAMuB,GAAGL,EAAGjC,WAAYgC,EAAOK,yBAE7D,CACD,MAAMI,EAAM,EAAgBT,EAAOQ,WAC7BR,EAAOQ,UAAUxC,WACjBgC,EAAOQ,UAGbF,EAAK,EAFO,IAAIxC,iBAAiBhD,KAAKiE,MAAMuB,GAAGL,EAAGjC,WAAYgC,EAAOK,qBACzD,IAAIvC,iBAAiBhD,KAAKiE,MAAMuB,GAAGG,EAAKT,EAAOK,qBAE/D,CAEA,QAAyBhD,IAArB2C,EAAOQ,UACPD,EAAa,EAAO,IAAIzC,WAAWqC,GAAM,IAAIrC,WAAWsC,QAEvD,CACD,MAAMM,EAAM,EAAgBV,EAAOQ,WAC7BR,EAAOQ,UAAUvC,gBACXnD,KAAKiE,MAAM4B,gBAAgBX,EAAOQ,WACxCI,QAAa9F,KAAKiE,MAAMI,mBAAmBuB,GACjDH,EAvHhB,SAAiBjC,EAAGC,EAAGsC,GACnB,MAAMzC,EAAM,IAAIN,WAAWQ,EAAEE,OAASD,EAAEC,OAASqC,EAAErC,QAInD,OAHAJ,EAAIpC,IAAIsC,EAAG,GACXF,EAAIpC,IAAIuC,EAAGD,EAAEE,QACbJ,EAAIpC,IAAI6E,EAAGvC,EAAEE,OAASD,EAAEC,QACjBJ,CACX,CAiH6B0C,CAAQ,IAAIhD,WAAWqC,GAAM,IAAIrC,WAAWsC,GAAO,IAAItC,WAAW8C,GACnF,CAEA,MAAO,CACHT,IAAKA,EACLY,mBAHuBjG,KAAKkG,sBAAsBV,EAAIC,GAK9D,CACA,MAAO5F,GACH,MAAM,IAAIK,EAAWL,EACzB,CACJ,CACA,WAAMsG,CAAMjB,GACR,MAAMkB,QAAYpG,KAAKiE,MAAMM,qBAAqBW,EAAOG,KACnDgB,EAAM,EAAgBnB,EAAOoB,cAC7BpB,EAAOoB,aAAapD,WACpBgC,EAAOoB,aACPC,EAAM,EAAgBrB,EAAOoB,cAC7BpB,EAAOoB,aAAanD,gBACdnD,KAAKiE,MAAM4B,gBAAgBX,EAAOoB,cACxChB,QAAatF,KAAKiE,MAAMI,mBAAmBkC,GACjD,IACI,IAAIf,EASAC,EARJ,QAA+BlD,IAA3B2C,EAAOsB,gBACPhB,EAAK,IAAIxC,iBAAiBhD,KAAKiE,MAAMuB,GAAGa,EAAKD,QAE5C,CAGDZ,EAAK,EAFO,IAAIxC,iBAAiBhD,KAAKiE,MAAMuB,GAAGa,EAAKD,IACxC,IAAIpD,iBAAiBhD,KAAKiE,MAAMuB,GAAGa,EAAKnB,EAAOsB,kBAE/D,CAEA,QAA+BjE,IAA3B2C,EAAOsB,gBACPf,EAAa,EAAO,IAAIzC,WAAWkC,EAAOG,KAAM,IAAIrC,WAAWsC,QAE9D,CACD,MAAMQ,QAAa9F,KAAKiE,MAAMI,mBAAmBa,EAAOsB,iBACxDf,EAAa,IAAIzC,WAAWkC,EAAOG,IAAIL,WAAaM,EAAKN,WAAac,EAAKd,YAC3ES,EAAWvE,IAAI,IAAI8B,WAAWkC,EAAOG,KAAM,GAC3CI,EAAWvE,IAAI,IAAI8B,WAAWsC,GAAOJ,EAAOG,IAAIL,YAChDS,EAAWvE,IAAI,IAAI8B,WAAW8C,GAAOZ,EAAOG,IAAIL,WAAaM,EAAKN,WACtE,CACA,aAAahF,KAAKkG,sBAAsBV,EAAIC,EAChD,CACA,MAAO5F,GACH,MAAM,IAAIM,EAAWN,EACzB,CACJ,CACA,2BAAMqG,CAAsBV,EAAIC,GAC5B,MAAMgB,EAAazG,KAAKkE,KAAKwC,gBAAgB/C,EAAe6B,GACtDmB,EAAc3G,KAAKkE,KAAK0C,iBAAiBhD,EAAqB6B,EAAYzF,KAAK6G,YACrF,aAAa7G,KAAKkE,KAAK4C,iBAAiB,EAAMC,OAAQN,EAAWM,OAAQJ,EAAYI,OAAQ/G,KAAK6G,WACtG,ECtLG,MAAMG,EAAa,CAAC,cAEd,EAAgB,IAAIhE,WAAW,CACxC,IACA,IACA,IACA,GACA,IACA,IACA,MAGoB,IAAIA,WAAW,CAAC,IAAK,MCVtC,MAAMiE,EACT,WAAArH,CAAYsH,GACR/E,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBnB,KAAKmH,KAAO,IAAInE,WAAWkE,EAC/B,CACA,GAAAE,GACI,OAAOpH,KAAKmH,IAChB,CACA,KAAAE,GACIrH,KAAKmH,KAAKG,KAAK,EACnB,CACA,GAAApG,CAAIqG,GACA,GAAIA,EAAI7D,SAAW1D,KAAKmH,KAAKzD,OACzB,MAAM,IAAI/D,MAAM,gCAEpBK,KAAKmH,KAAKjG,IAAIqG,EAClB,CACA,MAAAC,GACI,IAAK,IAAIjE,EAAI,EAAGA,EAAIvD,KAAKmH,KAAKzD,OAAQH,IAClC,GAAqB,IAAjBvD,KAAKmH,KAAK5D,GACV,OAAO,EAGf,OAAO,CACX,CACA,QAAAkE,CAASC,GACL,GAAIA,EAAEhE,SAAW1D,KAAKmH,KAAKzD,OACvB,MAAM,IAAI/D,MAAM,qCAEpB,IAAK,IAAI4D,EAAI,EAAGA,EAAIvD,KAAKmH,KAAKzD,OAAQH,IAAK,CACvC,GAAIvD,KAAKmH,KAAK5D,GAAKmE,EAAEnE,GACjB,OAAO,EAEX,GAAIvD,KAAKmH,KAAK5D,GAAKmE,EAAEnE,GACjB,OAAO,CAEf,CACA,OAAO,CACX,ECrCJ,MAAMoE,EAAkB,IAAI3E,WAAW,CACnC,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,MAInC4E,EAAc,IAAI5E,WAAW,CAC/B,IAAM,IAAM,IAAM,IAAM,EAAM,EAAM,EAAM,EAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,KAGxC6E,EAAc,IAAI7E,WAAW,CAC/B,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAC1C,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,MAGxC8E,EAAc,IAAI9E,WAAW,CAC/B,EAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAC1C,IAAM,IAAM,IAAM,IAAM,EAAM,GAAM,IAAM,EAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAC1C,IAAM,IAGJ+E,EAAqB,IAAI/E,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GACjC,EAAG,EAAG,EAAG,EAAG,KAGVgF,EAAqB,IAAIhF,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,EAAG,EAC/B,EAAG,KAGDiF,EAAqB,IAAIjF,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,EAAG,EAC/B,EAAG,KAEA,MAAMkF,UAAWhG,EACpB,WAAAtC,CAAYuI,EAAKC,GAoDb,OAnDArI,QACAoC,OAAOJ,eAAe/B,KAAM,QAAS,CACjCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGhBgB,OAAOJ,eAAe/B,KAAM,SAAU,CAClCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,WAAY,CACpCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,cAAe,CACvCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBnB,KAAKqI,MAAQD,EACLD,GACJ,KPtGa,GOuGTnI,KAAKsI,KAAO,CAAErI,KAAM,OAAQsI,WAAY,SACxCvI,KAAKwI,KAAO,GACZxI,KAAKyI,KAAO,GACZzI,KAAK0I,KAAO,GACZ1I,KAAK2I,OAASf,EACd5H,KAAK4I,SAAW,IAChB5I,KAAK6I,YAAcd,EACnB,MACJ,KP9Ga,GO+GT/H,KAAKsI,KAAO,CAAErI,KAAM,OAAQsI,WAAY,SACxCvI,KAAKwI,KAAO,GACZxI,KAAKyI,KAAO,GACZzI,KAAK0I,KAAO,GACZ1I,KAAK2I,OAASd,EACd7H,KAAK4I,SAAW,IAChB5I,KAAK6I,YAAcb,EACnB,MACJ,QAEIhI,KAAKsI,KAAO,CAAErI,KAAM,OAAQsI,WAAY,SACxCvI,KAAKwI,KAAO,IACZxI,KAAKyI,KAAO,GACZzI,KAAK0I,KAAO,GACZ1I,KAAK2I,OAASb,EACd9H,KAAK4I,SAAW,EAChB5I,KAAK6I,YAAcZ,EAG/B,CACA,wBAAM5D,CAAmBC,SACftE,KAAKwC,SACX,IACI,aAAaxC,KAAKyC,KAAKqG,UAAU,MAAOxE,EAC5C,CACA,MAAOzE,GACH,MAAM,IAAI,EAAeA,EAC7B,CACJ,CACA,0BAAM0E,CAAqBD,SACjBtE,KAAKwC,SACX,IACI,aAAaxC,KAAK+I,cAAczE,GAAK,EACzC,CACA,MAAOzE,GACH,MAAM,IAAI,EAAiBA,EAC/B,CACJ,CACA,yBAAM2E,CAAoBF,SAChBtE,KAAKwC,SACX,IACI,MAAMwG,QAAYhJ,KAAKyC,KAAKqG,UAAU,MAAOxE,GAC7C,KAAM,MAAO0E,GACT,MAAM,IAAIrJ,MAAM,mBAEpB,OJjHL,SAA0B+H,GAC7B,MAAMuB,EAASvB,EAAEwB,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAC5CC,EAAaC,KAAKH,GAClB3F,EAAM,IAAIN,WAAWmG,EAAWzF,QACtC,IAAK,IAAIH,EAAI,EAAGA,EAAI4F,EAAWzF,OAAQH,IACnCD,EAAIC,GAAK4F,EAAWE,WAAW9F,GAEnC,OAAOD,CACX,CIyGmBgG,CAAiBN,EAAO,GAAGjC,MACtC,CACA,MAAOlH,GACH,MAAM,IAAI,EAAeA,EAC7B,CACJ,CACA,2BAAM4E,CAAsBH,SAClBtE,KAAKwC,SACX,IACI,aAAaxC,KAAK+I,cAAczE,GAAK,EACzC,CACA,MAAOzE,GACH,MAAM,IAAI,EAAiBA,EAC/B,CACJ,CACA,eAAM6E,CAAUC,EAAQL,EAAKM,SACnB5E,KAAKwC,SACX,IACI,GAAe,QAAXmC,EACA,aAAa3E,KAAK+I,cAAczE,EAAKM,GAGzC,GAAIN,aAAeiF,YACf,MAAM,IAAI5J,MAAM,0BAEpB,aAAaK,KAAKwJ,WAAWlF,EAAKM,EACtC,CACA,MAAO/E,GACH,MAAM,IAAI,EAAiBA,EAC/B,CACJ,CACA,qBAAMgF,SACI7E,KAAKwC,SACX,IACI,aAAaxC,KAAKyC,KAAKgH,YAAYzJ,KAAKsI,MAAM,EAAMtB,EACxD,CACA,MAAOnH,GACH,MAAM,IAAI,EAAkBA,EAChC,CACJ,CACA,mBAAMiF,CAAcC,SACV/E,KAAKwC,SACX,IACI,MAAMkH,QAAe1J,KAAKqI,MAAMsB,eAAe,EAAM5C,OAAQ,EAAe,IAAI/D,WAAW+B,IACrF6E,EAAK,IAAI3C,EAAOjH,KAAKyI,MAC3B,IAAK,IAAIoB,EAAU,EAAGD,EAAGpC,WAAaoC,EAAGnC,SAASzH,KAAK2I,QAASkB,IAAW,CACvE,GAAIA,EAAU,IACV,MAAM,IAAIlK,MAAM,8BAEpB,MAAMmK,EAAQ,IAAI9G,iBAAiBhD,KAAKqI,MAAM0B,cAAcL,EAAQ/B,EAAiB,EAAMkC,EAAS,GAAI7J,KAAKyI,OAC7GqB,EAAM,GAAKA,EAAM,GAAK9J,KAAK4I,SAC3BgB,EAAG1I,IAAI4I,EACX,CACA,MAAME,QAAWhK,KAAKiK,qBAAqBL,EAAGxC,OAE9C,OADAwC,EAAGvC,QACI,CACHnE,WAAY8G,EACZ7G,gBAAiBnD,KAAK6F,gBAAgBmE,GAE9C,CACA,MAAOnK,GACH,MAAM,IAAIW,EAAmBX,EACjC,CACJ,CACA,qBAAMgG,CAAgBvB,SACZtE,KAAKwC,SACX,IACI,MAAMwG,QAAYhJ,KAAKyC,KAAKqG,UAAU,MAAOxE,GAG7C,cAFO0E,EAAO,SACPA,EAAa,cACPhJ,KAAKyC,KAAKiC,UAAU,MAAOsE,EAAKhJ,KAAKsI,MAAM,EAAM,GAClE,CACA,MAAOzI,GACH,MAAM,IAAI,EAAiBA,EAC/B,CACJ,CACA,QAAM2F,CAAGwE,EAAIE,GACT,IAMI,aALMlK,KAAKwC,eACQxC,KAAKyC,KAAK0H,WAAW,CACpClK,KAAM,OACNmK,OAAQF,GACTF,EAAgB,EAAZhK,KAAK0I,KAEhB,CACA,MAAO7I,GACH,MAAM,IAAI,EAAeA,EAC7B,CACJ,CACA,mBAAMkJ,CAAczE,EAAKM,GACrB,GAAIA,GAAYN,EAAIU,aAAehF,KAAKwI,KACpC,MAAM,IAAI7I,MAAM,0CAEpB,IAAKiF,GAAYN,EAAIU,aAAehF,KAAKyI,KACrC,MAAM,IAAI9I,MAAM,2CAEpB,OAAIiF,QACa5E,KAAKyC,KAAKiC,UAAU,MAAOJ,EAAKtE,KAAKsI,MAAM,EAAM,UAErDtI,KAAKiK,qBAAqB,IAAIjH,WAAWsB,GAC1D,CACA,gBAAMkF,CAAWlF,EAAKM,GAClB,QAAuB,IAAZN,EAAI+F,KAAuB/F,EAAI+F,MAAQrK,KAAKsI,KAAKC,WACxD,MAAM,IAAI5I,MAAM,gBAAgB2E,EAAI+F,OAExC,GAAIzF,EAAU,CACV,QAAqB,IAAVN,EAAIgG,EACX,MAAM,IAAI3K,MAAM,sCAEpB,aAAaK,KAAKyC,KAAKiC,UAAU,MAAOJ,EAAKtE,KAAKsI,MAAM,EAAM,GAClE,CACA,QAAqB,IAAVhE,EAAIgG,EACX,MAAM,IAAI3K,MAAM,8BAEpB,aAAaK,KAAKyC,KAAKiC,UAAU,MAAOJ,EAAKtE,KAAKsI,MAAM,EAAMtB,EAClE,CACA,0BAAMiD,CAAqBpI,GACvB,MAAM0I,EAAW,IAAIvH,WAAWhD,KAAK6I,YAAYnF,OAAS7B,EAAE6B,QAG5D,OAFA6G,EAASrJ,IAAIlB,KAAK6I,YAAa,GAC/B0B,EAASrJ,IAAIW,EAAG7B,KAAK6I,YAAYnF,cACpB1D,KAAKyC,KAAKiC,UAAU,QAAS6F,EAAUvK,KAAKsI,MAAM,EAAMtB,EACzE,EC/RJ,MAAMwD,EAAe,IAAIxH,WAAW,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,KACvD,MAAMyH,UAAmBvI,EAC5B,WAAAtC,GACIG,QACAoC,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MRiBI,IQfRgB,OAAOJ,eAAe/B,KAAM,WAAY,CACpCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,WAAY,CACpCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,CACHlB,KAAM,OACNyK,KAAM,UACNhH,OAAQ,MAGpB,CACA,IAAAU,CAAKD,GACDnE,KAAK2K,SAAWxG,CACpB,CACA,eAAAuC,CAAgBkE,EAAO7F,GACnB/E,KAAK6K,aACL,MAAMvH,EAAM,IAAIN,WAAW,EAAIhD,KAAK2K,SAAS3F,WAAa4F,EAAM5F,WAAaD,EAAIC,YAKjF,OAJA1B,EAAIpC,IAAIsJ,EAAc,GACtBlH,EAAIpC,IAAIlB,KAAK2K,SAAU,GACvBrH,EAAIpC,IAAI0J,EAAO,EAAI5K,KAAK2K,SAAS3F,YACjC1B,EAAIpC,IAAI6D,EAAK,EAAI/E,KAAK2K,SAAS3F,WAAa4F,EAAM5F,YAC3C1B,CACX,CACA,gBAAAsD,CAAiBgE,EAAOE,EAAMC,GAC1B/K,KAAK6K,aACL,MAAMvH,EAAM,IAAIN,WAAW,EAAIhD,KAAK2K,SAAS3F,WAAa4F,EAAM5F,WAAa8F,EAAK9F,YAMlF,OALA1B,EAAIpC,IAAI,IAAI8B,WAAW,CAAC,EAAG+H,IAAO,GAClCzH,EAAIpC,IAAIsJ,EAAc,GACtBlH,EAAIpC,IAAIlB,KAAK2K,SAAU,GACvBrH,EAAIpC,IAAI0J,EAAO,EAAI5K,KAAK2K,SAAS3F,YACjC1B,EAAIpC,IAAI4J,EAAM,EAAI9K,KAAK2K,SAAS3F,WAAa4F,EAAM5F,YAC5C1B,CACX,CACA,aAAM0H,CAAQC,EAAMlG,GAKhB,SAJM/E,KAAKwC,SACa,IAApByI,EAAKjG,aACLiG,EAAO,IAAI1B,YAAYvJ,KAAKkL,WAE5BD,EAAKjG,aAAehF,KAAKkL,SACzB,MAAM,IAAI,EAAkB,oDAEhC,MAAM5G,QAAYtE,KAAKyC,KAAKiC,UAAU,MAAOuG,EAAMjL,KAAKmL,SAAS,EAAO,CACpE,SAEJ,aAAanL,KAAKyC,KAAK2I,KAAK,OAAQ9G,EAAKS,EAC7C,CACA,YAAMsG,CAAOC,EAAKR,EAAMC,SACd/K,KAAKwC,SACX,MAAM8B,QAAYtE,KAAKyC,KAAKiC,UAAU,MAAO4G,EAAKtL,KAAKmL,SAAS,EAAO,CACnE,SAEEI,EAAM,IAAIhC,YAAYwB,GACtBS,EAAI,IAAIxI,WAAWuI,GACzB,IAAIE,EAAO,EACX,MAAMC,EAAM,IAAI1I,WAAW8H,GACrBa,EAAO,IAAI3I,WAAW,GAC5B,GAAI+H,EAAM,IAAM/K,KAAKkL,SACjB,MAAM,IAAIvL,MAAM,yBAEpB,MAAMiM,EAAM,IAAI5I,WAAWhD,KAAKkL,SAAWQ,EAAIhI,OAAS,GACxD,IAAK,IAAIH,EAAI,EAAGsI,EAAM,EAAGA,EAAML,EAAE9H,OAAQH,IACrCoI,EAAK,GAAKpI,EACVqI,EAAI1K,IAAIuK,EAAM,GACdG,EAAI1K,IAAIwK,EAAKD,EAAK/H,QAClBkI,EAAI1K,IAAIyK,EAAMF,EAAK/H,OAASgI,EAAIhI,QAChC+H,EAAO,IAAIzI,iBAAiBhD,KAAKyC,KAAK2I,KAAK,OAAQ9G,EAAKsH,EAAIE,MAAM,EAAGL,EAAK/H,OAASgI,EAAIhI,OAAS,KAC5F8H,EAAE9H,OAASmI,GAAOJ,EAAK/H,QACvB8H,EAAEtK,IAAIuK,EAAMI,GACZA,GAAOJ,EAAK/H,SAGZ8H,EAAEtK,IAAIuK,EAAKK,MAAM,EAAGN,EAAE9H,OAASmI,GAAMA,GACrCA,GAAOL,EAAE9H,OAASmI,GAG1B,OAAON,CACX,CACA,sBAAMzE,CAAiBmE,EAAMlG,EAAK+F,EAAMC,SAC9B/K,KAAKwC,SACX,MAAMuJ,QAAgB/L,KAAKyC,KAAKiC,UAAU,MAAOK,EAAK,QAAQ,EAAO,CAAC,eACtE,aAAa/E,KAAKyC,KAAK0H,WAAW,CAC9BlK,KAAM,OACNyK,KAAM1K,KAAKmL,QAAQT,KACnBO,KAAMA,EACNH,KAAMA,GACPiB,EAAe,EAANhB,EAChB,CACA,oBAAMpB,CAAesB,EAAML,EAAO7F,GAC9B,aAAa/E,KAAKgL,QAAQC,EAAMjL,KAAK0G,gBAAgBkE,EAAO7F,GAAKgC,OACrE,CACA,mBAAMgD,CAAcuB,EAAKV,EAAOE,EAAMC,GAClC,aAAa/K,KAAKqL,OAAOC,EAAKtL,KAAK4G,iBAAiBgE,EAAOE,EAAMC,GAAKhE,OAAQgE,EAClF,CACA,UAAAF,GACI,GAAI7K,KAAK2K,WAAa,EAClB,MAAM,IAAIhL,MAAM,+BAExB,EAEG,MAAMqM,UAAyBvB,EAClC,WAAA7K,GACIG,SAASkM,WAET9J,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MRxGI,IQ2GRgB,OAAOJ,eAAe/B,KAAM,WAAY,CACpCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAGXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,CACHlB,KAAM,OACNyK,KAAM,UACNhH,OAAQ,MAGpB,ECzJG,MAAMwI,EAAc,CAAC,UAAW,WCiB3BC,OAAO,GACPA,OAAO,GACPA,OAAO,GCnBZ,MAAMC,UAAsBlK,EAC/B,WAAAtC,CAAY0E,GACRvE,QACAoC,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAOoB,IAEXvC,KAAKqM,QAAU/H,CACnB,CACA,UAAMgI,CAAKC,EAAIC,EAAMC,SACXzM,KAAK0M,YACX,MAAMC,EAAM,CACR1M,KAAM,UACNsM,GAAIA,EACJK,eAAgBH,GAGpB,aADiBzM,KAAKyC,KAAKoK,QAAQF,EAAK3M,KAAK8M,KAAMN,EAEvD,CACA,UAAMO,CAAKR,EAAIC,EAAMC,SACXzM,KAAK0M,YACX,MAAMC,EAAM,CACR1M,KAAM,UACNsM,GAAIA,EACJK,eAAgBH,GAGpB,aADiBzM,KAAKyC,KAAKuK,QAAQL,EAAK3M,KAAK8M,KAAMN,EAEvD,CACA,eAAME,GACF,QAAkBnK,IAAdvC,KAAK8M,KACL,aAEE9M,KAAKwC,SACX,MAAM8B,QAAYtE,KAAKiN,WAAWjN,KAAKqM,SACvC,IAAKrJ,WAAWhD,KAAKqM,SAAU/E,KAAK,GACpCtH,KAAK8M,KAAOxI,CAEhB,CACA,gBAAM2I,CAAW3I,GACb,aAAatE,KAAKyC,KAAKiC,UAAU,MAAOJ,EAAK,CAAErE,KAAM,YAAa,EAAMiM,EAC5E,EAyBG,MAAMgB,EACT,WAAAtN,GAEIuC,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MX5CG,IW+CPgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAGXgB,OAAOJ,eAAe/B,KAAM,YAAa,CACrCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAGXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEf,CACA,uBAAAgM,CAAwB7I,GACpB,OAAO,IAAI8H,EAAc9H,EAC7B,EA0BG,MAAM8I,UAAkBF,EAC3B,WAAAtN,GACIG,SAASkM,WAET9J,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MXvGG,IW0GPgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAGXgB,OAAOJ,eAAe/B,KAAM,YAAa,CACrCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAGXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEf,ECpKG,SAASkM,IACZ,OAAO,IAAIC,QAAQ,CAACC,EAAUC,KAC1BA,EAAO,IAAI,EAAkB,mBAErC,CCFA,MAAMC,EAAY,IAAIzK,WAAW,CAAC,IAAK,IAAK,KACrC,MAAM0K,EACT,WAAA9N,CAAY+N,EAAK3J,EAAK4J,GAClBzL,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,iBAAkB,CAC1CoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBnB,KAAKyC,KAAOkL,EACZ3N,KAAKkE,KAAOF,EACZhE,KAAK4N,eAAiBA,CAC1B,CACA,UAAMtB,CAAKuB,EAAOC,GACd,aAAaT,GACjB,CACA,UAAMN,CAAKc,EAAOC,GACd,aAAaT,GACjB,CACA,YAAM,CAAOU,EAAiBhD,GAC1B,GAAIgD,EAAgB/I,WAAajC,EAC7B,MAAM,IAAI,EAAkB,6BAEhC,IACI,aAAa/C,KAAKkE,KAAK6F,cAAc/J,KAAK4N,eAAgBH,EAAW,IAAIzK,WAAW+K,GAAkBhD,EAC1G,CACA,MAAOlL,GACH,MAAM,IAAIO,EAAYP,EAC1B,CACJ,EAEG,MAAMmO,UAAqCN,GAE3C,MAAMO,UAAkCP,EAC3C,WAAA9N,CAAY+N,EAAK3J,EAAK4J,EAAgBvI,GAClCtF,MAAM4N,EAAK3J,EAAK4J,GAChBzL,OAAOJ,eAAe/B,KAAM,MAAO,CAC/BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBnB,KAAKqF,IAAMA,CAEf,ECzDG,MAAM6I,UAA8BR,EACvC,WAAA9N,CAAY+N,EAAK3J,EAAKkB,GAqClB,GApCAnF,MAAM4N,EAAK3J,EAAKkB,EAAO0I,gBAEvBzL,OAAOJ,eAAe/B,KAAM,QAAS,CACjCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGhBgB,OAAOJ,eAAe/B,KAAM,MAAO,CAC/BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGhBgB,OAAOJ,eAAe/B,KAAM,MAAO,CAC/BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGhBgB,OAAOJ,eAAe/B,KAAM,MAAO,CAC/BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,SAEGoB,IAAf2C,EAAOZ,UAA0C/B,IAArB2C,EAAOiJ,gBACpB5L,IAAf2C,EAAOkJ,IACP,MAAM,IAAIzO,MAAM,mCAEpBK,KAAKqO,MAAQnJ,EAAOoJ,KACpBtO,KAAKuO,IAAMvO,KAAKqO,MAAMG,QACtBxO,KAAKyO,IAAMzO,KAAKqO,MAAMK,UACtB1O,KAAK2O,IAAM3O,KAAKqO,MAAMO,QACtB,MAAMtK,EAAMtE,KAAKqO,MAAMlB,wBAAwBjI,EAAOZ,KACtDtE,KAAK6O,KAAO,CACRvK,IAAKA,EACL6J,UAAWjJ,EAAOiJ,UAClBC,IAAKlJ,EAAOkJ,IAEpB,CACA,YAAAU,CAAajN,GACT,MAAMkN,EAAW,EAAMlN,EAAEuM,IAAKvM,EAAEsM,UAAUnJ,YAC1C,OX6GD,SAAaxB,EAAGC,GACnB,GAAID,EAAEwB,aAAevB,EAAEuB,WACnB,MAAM,IAAIrF,MAAM,gCAEpB,MAAMqP,EAAM,IAAIhM,WAAWQ,EAAEwB,YAC7B,IAAK,IAAIzB,EAAI,EAAGA,EAAIC,EAAEwB,WAAYzB,IAC9ByL,EAAIzL,GAAKC,EAAED,GAAKE,EAAEF,GAEtB,OAAOyL,CACX,CWtHeC,CAAIpN,EAAEsM,UAAWY,GAAUhI,MACtC,CACA,YAAAmI,CAAarN,GAET,GAAIA,EAAEuM,IAAMe,OAAOC,iBACf,MAAM,IAAI7O,EAAyB,yBAEvCsB,EAAEuM,KAAO,CAEb,EClEJ,IAWIiB,EACG,MAAMC,EACT,WAAA1P,GACIyP,EAAcnO,IAAIlB,KAAMsN,QAAQiC,UACpC,CACA,UAAMC,GACF,IAAIC,EACJ,MAAMC,EAAW,IAAIpC,QAASiC,IAC1BE,EAAcF,IAEZI,EArBwD,SAAUC,EAAUC,EAAOC,EAAMC,GACnG,GAAa,MAATD,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,4EACvG,MAAgB,MAATF,EAAeC,EAAa,MAATD,EAAeC,EAAEE,KAAKL,GAAYG,EAAIA,EAAE5O,MAAQ0O,EAAM/O,IAAI8O,EACxF,CAiB6BM,CAAuBlQ,KAAMqP,EAAe,KAGjE,OAnB8D,SAAUO,EAAUC,EAAO1O,EAAO2O,EAAMC,GAC1G,GAAa,MAATD,EAAc,MAAM,IAAIE,UAAU,kCACtC,GAAa,MAATF,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,2EACtF,MAATF,EAAeC,EAAEE,KAAKL,EAAUzO,GAAS4O,EAAIA,EAAE5O,MAAQA,EAAQ0O,EAAM3O,IAAI0O,EAAUzO,EAC/F,CAYQgP,CAAuBnQ,KAAMqP,EAAeK,EAAU,WAChDC,EACCF,CACX,EAEJJ,EAAgB,IAAIe,QC3BpB,IAWIC,GAXA,GAAkE,SAAUT,EAAUC,EAAOC,EAAMC,GACnG,GAAa,MAATD,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,4EACvG,MAAgB,MAATF,EAAeC,EAAa,MAATD,EAAeC,EAAEE,KAAKL,GAAYG,EAAIA,EAAE5O,MAAQ0O,EAAM/O,IAAI8O,EACxF,EAWO,MAAMU,WAA6BpC,EACtC,WAAAtO,GACIG,SAASkM,WACToE,GAA4BnP,IAAIlB,UAAW,EAC/C,CACA,UAAM+M,CAAKP,EAAMC,EAAM,EAAM1F,SAfqC,SAAU6I,EAAUC,EAAO1O,EAAO2O,EAAMC,GAC1G,GAAa,MAATD,EAAc,MAAM,IAAIE,UAAU,kCACtC,GAAa,MAATF,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,2EACtF,MAATF,EAAeC,EAAEE,KAAKL,EAAUzO,GAAS4O,EAAIA,EAAE5O,MAAQA,EAAQ0O,EAAM3O,IAAI0O,EAAUzO,EAC/F,CAWQ,CAAuBnB,KAAMqQ,GAA6B,GAAuBrQ,KAAMqQ,GAA6B,MAAQ,IAAIf,EAAS,KACzI,MAAMiB,QAAgB,GAAuBvQ,KAAMqQ,GAA6B,KAAKb,OACrF,IAAIgB,EACJ,IACIA,QAAWxQ,KAAK6O,KAAKvK,IAAIyI,KAAK/M,KAAK8O,aAAa9O,KAAK6O,MAAOrC,EAAMC,EACtE,CACA,MAAO5M,GACH,MAAM,IAAIS,EAAUT,EACxB,CACA,QACI0Q,GACJ,CAEA,OADAvQ,KAAKkP,aAAalP,KAAK6O,MAChB2B,CACX,EAEJH,GAA8B,IAAID,QCrClC,IAWIK,GAXA,GAAkE,SAAUb,EAAUC,EAAOC,EAAMC,GACnG,GAAa,MAATD,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,4EACvG,MAAgB,MAATF,EAAeC,EAAa,MAATD,EAAeC,EAAEE,KAAKL,GAAYG,EAAIA,EAAE5O,MAAQ0O,EAAM/O,IAAI8O,EACxF,EAWO,MAAMc,WAA0BxC,EACnC,WAAAtO,CAAY+N,EAAK3J,EAAKkB,EAAQG,GAC1BtF,MAAM4N,EAAK3J,EAAKkB,GAChB/C,OAAOJ,eAAe/B,KAAM,MAAO,CAC/BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBsP,GAAyBvP,IAAIlB,UAAW,GACxCA,KAAKqF,IAAMA,CACf,CACA,UAAMiH,CAAKE,EAAMC,EAAM,EAAM1F,SAtBqC,SAAU6I,EAAUC,EAAO1O,EAAO2O,EAAMC,GAC1G,GAAa,MAATD,EAAc,MAAM,IAAIE,UAAU,kCACtC,GAAa,MAATF,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVH,EAAuBD,IAAaC,IAAUE,GAAKF,EAAM/N,IAAI8N,GAAW,MAAM,IAAII,UAAU,2EACtF,MAATF,EAAeC,EAAEE,KAAKL,EAAUzO,GAAS4O,EAAIA,EAAE5O,MAAQA,EAAQ0O,EAAM3O,IAAI0O,EAAUzO,EAC/F,CAkBQ,CAAuBnB,KAAMyQ,GAA0B,GAAuBzQ,KAAMyQ,GAA0B,MAAQ,IAAInB,EAAS,KACnI,MAAMiB,QAAgB,GAAuBvQ,KAAMyQ,GAA0B,KAAKjB,OAClF,IAAImB,EACJ,IACIA,QAAW3Q,KAAK6O,KAAKvK,IAAIgI,KAAKtM,KAAK8O,aAAa9O,KAAK6O,MAAOrC,EAAMC,EACtE,CACA,MAAO5M,GACH,MAAM,IAAIQ,EAAUR,EACxB,CACA,QACI0Q,GACJ,CAEA,OADAvQ,KAAKkP,aAAalP,KAAK6O,MAChB8B,CACX,EAEJF,GAA2B,IAAIL,QCtC/B,MAAMQ,GAAmB,IAAI5N,WAAW,CACpC,GAAI,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,MAGvC6N,GAAY,IAAI7N,WAAW,CAAC,IAAK,IAAK,MAGtC8N,GAAkB,IAAI9N,WAAW,CACnC,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,MAGpC+N,GAAY,IAAI/N,WAAW,CAAC,IAAK,IAAK,MAGtCgO,GAAoB,IAAIhO,WAAW,CACrC,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,MAG7CiO,GAAe,IAAIjO,WAAW,CAAC,IAAK,IAAK,GAAI,IAAK,IAAK,MAGvDkO,GAAuB,IAAIlO,WAAW,CACxC,GAAI,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,IAkE5B,MAAMmO,WAA0BjP,EAQnC,WAAAtC,CAAYsF,GA2BR,GA1BAnF,QACAoC,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,OAAQ,CAChCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,QAAS,CACjCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAEhBgB,OAAOJ,eAAe/B,KAAM,WAAY,CACpCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,WAAY,IAGU,iBAAf+D,EAAOiD,IACd,MAAM,IAAI,EAAkB,wBAIhC,GAFAnI,KAAKoR,KAAOlM,EAAOiD,IAEO,iBAAfjD,EAAOlB,IACd,MAAM,IAAI,EAAkB,wBAIhC,GAFAhE,KAAKkE,KAAOgB,EAAOlB,IAEQ,iBAAhBkB,EAAOoJ,KACd,MAAM,IAAI,EAAkB,yBAEhCtO,KAAKqO,MAAQnJ,EAAOoJ,KACpBtO,KAAK2K,SAAW,IAAI3H,WAAWkO,IAC/BlR,KAAK2K,SAASzJ,IAAI,EAAMlB,KAAKoR,KAAKtN,GAAI,GAAI,GAC1C9D,KAAK2K,SAASzJ,IAAI,EAAMlB,KAAKkE,KAAKJ,GAAI,GAAI,GAC1C9D,KAAK2K,SAASzJ,IAAI,EAAMlB,KAAKqO,MAAMvK,GAAI,GAAI,GAC3C9D,KAAKkE,KAAKE,KAAKpE,KAAK2K,SACxB,CAIA,OAAIxC,GACA,OAAOnI,KAAKoR,IAChB,CAIA,OAAIpN,GACA,OAAOhE,KAAKkE,IAChB,CAIA,QAAIoK,GACA,OAAOtO,KAAKqO,KAChB,CAUA,yBAAMgD,CAAoBnM,GACtBlF,KAAKsR,qBAAqBpM,SACpBlF,KAAKwC,SACX,MAAMgD,QAAWxF,KAAKoR,KAAKnM,MAAMC,GACjC,IAAIqM,EAOJ,OALIA,OADehP,IAAf2C,EAAOsM,SACqBjP,IAArB2C,EAAOQ,UlB/Kb,EAFJ,OkBoL+BnD,IAArB2C,EAAOQ,UlBnLhB,EAFA,QkBuLW1F,KAAKyR,cAAcF,EAAM/L,EAAGS,aAAcT,EAAGH,IAAKH,EACnE,CAWA,4BAAMwM,CAAuBxM,GACzBlF,KAAKsR,qBAAqBpM,SACpBlF,KAAKwC,SACX,MAAMyD,QAAqBjG,KAAKoR,KAAKjL,MAAMjB,GAC3C,IAAIqM,EAOJ,OALIA,OADehP,IAAf2C,EAAOsM,SAC2BjP,IAA3B2C,EAAOsB,gBlBtMb,EAFJ,OkB2MqCjE,IAA3B2C,EAAOsB,gBlB1MhB,EAFA,QkB8MWxG,KAAK2R,cAAcJ,EAAMtL,EAAcf,EACxD,CAYA,UAAMoH,CAAKpH,EAAQsL,EAAI/D,EAAM,EAAM1F,QAC/B,MAAM6K,QAAY5R,KAAKqR,oBAAoBnM,GAC3C,MAAO,CACHyL,SAAUiB,EAAItF,KAAKkE,EAAI/D,GACvBpH,IAAKuM,EAAIvM,IAEjB,CAYA,UAAM0H,CAAK7H,EAAQyL,EAAIlE,EAAM,EAAM1F,QAC/B,MAAM6K,QAAY5R,KAAK0R,uBAAuBxM,GAC9C,aAAa0M,EAAI7E,KAAK4D,EAAIlE,EAC9B,CAeA,kBAAMoF,CAAaN,EAAMtL,EAAcf,GAKnC,MAAM4M,OAAuBvP,IAAf2C,EAAOsM,IACf,EACA,IAAIxO,WAAWkC,EAAOsM,IAAI1N,IAC1BiO,QAAkB/R,KAAKkE,KAAKyF,eAAe,EAAM5C,OAAQiK,GAAmBc,GAC5EhH,OAAuBvI,IAAhB2C,EAAO4F,KACd,EACA,IAAI9H,WAAWkC,EAAO4F,MACtBkH,QAAiBhS,KAAKkE,KAAKyF,eAAe,EAAM5C,OAAQ+J,GAAiBhG,GACzEmH,EAAqB,IAAIjP,WAAW,EAAI+O,EAAU/M,WAAagN,EAAShN,YAC9EiN,EAAmB/Q,IAAI,IAAI8B,WAAW,CAACuO,IAAQ,GAC/CU,EAAmB/Q,IAAI,IAAI8B,WAAW+O,GAAY,GAClDE,EAAmB/Q,IAAI,IAAI8B,WAAWgP,GAAW,EAAID,EAAU/M,YAC/D,MAAMwM,OAAqBjP,IAAf2C,EAAOsM,IACb,EACA,IAAIxO,WAAWkC,EAAOsM,IAAIlN,KAC1BS,EAAM/E,KAAKkE,KAAKwC,gBAAgBuK,GAAcO,GAC/CzK,OACCmL,EAAqBlS,KAAKkE,KAAK0C,iBAAiBiK,GAAWoB,EAAoBjS,KAAKkE,KAAKgH,UAAUnE,OACnG6G,QAAuB5N,KAAKkE,KAAK4C,iBAAiBb,EAAclB,EAAKmN,EAAoBlS,KAAKkE,KAAKgH,UACzG,GlBlPQ,QkBkPJlL,KAAKqO,MAAMvK,GACX,MAAO,CAAEwK,KAAMtO,KAAKqO,MAAOT,eAAgBA,GAE/C,MAAMuE,EAAUnS,KAAKkE,KAAK0C,iBAAiBmK,GAAWkB,EAAoBjS,KAAKqO,MAAMG,SAASzH,OACxFzC,QAAYtE,KAAKkE,KAAK4C,iBAAiBb,EAAclB,EAAKoN,EAASnS,KAAKqO,MAAMG,SAC9E4D,EAAgBpS,KAAKkE,KAAK0C,iBAAiBgK,GAAkBqB,EAAoBjS,KAAKqO,MAAMK,WAAW3H,OACvGoH,QAAkBnO,KAAKkE,KAAK4C,iBAAiBb,EAAclB,EAAKqN,EAAepS,KAAKqO,MAAMK,WAChG,MAAO,CACHJ,KAAMtO,KAAKqO,MACXT,eAAgBA,EAChBtJ,IAAKA,EACL6J,UAAW,IAAInL,WAAWmL,GAC1BC,IAAK,EAEb,CACA,mBAAMqD,CAAcF,EAAMtL,EAAcZ,EAAKH,GACzC,MAAMmN,QAAYrS,KAAK6R,aAAaN,EAAMtL,EAAcf,GACxD,YAAgB3C,IAAZ8P,EAAI/N,IACG,IAAI2J,EAA0BjO,KAAKyC,KAAMzC,KAAKkE,KAAMmO,EAAIzE,eAAgBvI,GAE5E,IAAIqL,GAAkB1Q,KAAKyC,KAAMzC,KAAKkE,KAAMmO,EAAKhN,EAC5D,CACA,mBAAMsM,CAAcJ,EAAMtL,EAAcf,GACpC,MAAMmN,QAAYrS,KAAK6R,aAAaN,EAAMtL,EAAcf,GACxD,YAAgB3C,IAAZ8P,EAAI/N,IACG,IAAI0J,EAA6BhO,KAAKyC,KAAMzC,KAAKkE,KAAMmO,EAAIzE,gBAE/D,IAAI0C,GAAqBtQ,KAAKyC,KAAMzC,KAAKkE,KAAMmO,EAC1D,CACA,oBAAAf,CAAqBpM,GACjB,QAAoB3C,IAAhB2C,EAAO4F,MACP5F,EAAO4F,KAAK9F,WjBxTS,MiByTrB,MAAM,IAAI,EAAkB,iBAEhC,QAAmBzC,IAAf2C,EAAOsM,IAAmB,CAC1B,GAAItM,EAAOsM,IAAIlN,IAAIU,WjB1TG,GiB2TlB,MAAM,IAAI,EAAkB,mCAEhC,GAAIE,EAAOsM,IAAIlN,IAAIU,WAAajC,EAC5B,MAAM,IAAI,EAAkB,oBAEhC,GAAImC,EAAOsM,IAAI1N,GAAGkB,WAAajC,EAC3B,MAAM,IAAI,EAAkB,kBAEpC,CAEJ,ECxUG,MAAMuP,WAAkCzO,EAC3C,WAAAjE,GACI,MAAMoE,EAAM,IAAIgI,EAEhBjM,MnBSiB,GmBVJ,IAAImI,EnBUA,GmBV8BlE,GACRA,GACvC7B,OAAOJ,eAAe/B,KAAM,KAAM,CAC9BoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MnBIa,KmBFjBgB,OAAOJ,eAAe/B,KAAM,aAAc,CACtCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAEXgB,OAAOJ,eAAe/B,KAAM,UAAW,CACnCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAEXgB,OAAOJ,eAAe/B,KAAM,gBAAiB,CACzCoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,KAEXgB,OAAOJ,eAAe/B,KAAM,iBAAkB,CAC1CoC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVnB,MAAO,IAEf,EC6BG,MAAMoR,WAAoBpB,IA0B1B,MAAMqB,WAA4BF,IAiFlC,MAAMG,WAAmBzG,GCzKJ,IAAIhJ,WAAW,CACvC,GAAM,GAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAC1C,EAAM,GAAM,IAAM,IAAM,EAAM,GAAM,EAAM,KCFpB,IAAIA,WAAW,CACrC,GAAM,GAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAC1C,EAAM,GAAM,IAAM,IAAM,EAAM,GAAM,EAAM,I,cCH5B0P,EAAQ,OAAc,EACxC,MAAMC,EAAW,mCACXC,EAAe,CAAC,EACtB,IAAK,IAAIC,EAAI,EAAGA,EAAIF,GAAiBE,IAAK,CACtC,MAAM5P,EAAI0P,EAASG,OAAOD,GAC1BD,EAAa3P,GAAK4P,CACtB,CACA,SAASE,EAAYC,GACjB,MAAMvP,EAAIuP,GAAO,GACjB,OAAgB,SAANA,IAAoB,EACP,YAAL,EAAVvP,GACe,YAAfA,GAAK,EAAK,GACK,YAAfA,GAAK,EAAK,GACK,aAAfA,GAAK,EAAK,GACK,YAAfA,GAAK,EAAK,EACtB,CACA,SAASwP,EAAUC,GACf,IAAIC,EAAM,EACV,IAAK,IAAI5P,EAAI,EAAGA,EAAI2P,EAAOxP,SAAUH,EAAG,CACpC,MAAMwC,EAAImN,EAAO7J,WAAW9F,GAC5B,GAAIwC,EAAI,IAAMA,EAAI,IACd,MAAO,mBAAqBmN,EAAS,IACzCC,EAAMJ,EAAYI,GAAQpN,GAAK,CACnC,CACAoN,EAAMJ,EAAYI,GAClB,IAAK,IAAI5P,EAAI,EAAGA,EAAI2P,EAAOxP,SAAUH,EAAG,CACpC,MAAMmE,EAAIwL,EAAO7J,WAAW9F,GAC5B4P,EAAMJ,EAAYI,GAAY,GAAJzL,CAC9B,CACA,OAAOyL,CACX,CACA,SAASC,EAAQ5G,EAAM6G,EAAQC,EAASC,GACpC,IAAIpS,EAAQ,EACRqS,EAAO,EACX,MAAMC,GAAQ,GAAKH,GAAW,EACxBI,EAAS,GACf,IAAK,IAAInQ,EAAI,EAAGA,EAAIiJ,EAAK9I,SAAUH,EAG/B,IAFApC,EAASA,GAASkS,EAAU7G,EAAKjJ,GACjCiQ,GAAQH,EACDG,GAAQF,GACXE,GAAQF,EACRI,EAAOC,KAAMxS,GAASqS,EAAQC,GAGtC,GAAIF,EACIC,EAAO,GACPE,EAAOC,KAAMxS,GAAUmS,EAAUE,EAASC,OAG7C,CACD,GAAID,GAAQH,EACR,MAAO,iBACX,GAAKlS,GAAUmS,EAAUE,EAASC,EAC9B,MAAO,kBACf,CACA,OAAOC,CACX,CACA,SAASE,EAAQ9J,GACb,OAAOsJ,EAAQtJ,EAAO,EAAG,GAAG,EAChC,CACA,SAAS+J,EAAgBC,GACrB,MAAMzB,EAAMe,EAAQU,EAAO,EAAG,GAAG,GACjC,GAAIC,MAAMC,QAAQ3B,GACd,OAAOA,CACf,CACA,SAAS4B,EAAUH,GACf,MAAMzB,EAAMe,EAAQU,EAAO,EAAG,GAAG,GACjC,GAAIC,MAAMC,QAAQ3B,GACd,OAAOA,EACX,MAAM,IAAI1S,MAAM0S,EACpB,CACA,SAAS6B,EAAuBC,GAC5B,IAAIC,EAkCJ,SAASC,EAASC,EAAKC,GAEnB,GADAA,EAAQA,GAAS,GACbD,EAAI5Q,OAAS,EACb,OAAO4Q,EAAM,aACjB,GAAIA,EAAI5Q,OAAS6Q,EACb,MAAO,uBAEX,MAAMC,EAAUF,EAAIG,cACdC,EAAUJ,EAAIK,cACpB,GAAIL,IAAQE,GAAWF,IAAQI,EAC3B,MAAO,qBAAuBJ,EAElC,MAAMM,GADNN,EAAME,GACYK,YAAY,KAC9B,IAAe,IAAXD,EACA,MAAO,8BAAgCN,EAC3C,GAAc,IAAVM,EACA,MAAO,sBAAwBN,EACnC,MAAMpB,EAASoB,EAAIxI,MAAM,EAAG8I,GACtBE,EAAYR,EAAIxI,MAAM8I,EAAQ,GACpC,GAAIE,EAAUpR,OAAS,EACnB,MAAO,iBACX,IAAIyP,EAAMF,EAAUC,GACpB,GAAmB,iBAARC,EACP,OAAOA,EACX,MAAMW,EAAQ,GACd,IAAK,IAAIvQ,EAAI,EAAGA,EAAIuR,EAAUpR,SAAUH,EAAG,CACvC,MAAMwC,EAAI+O,EAAUhC,OAAOvP,GACrBmE,EAAIkL,EAAa7M,GACvB,QAAUxD,IAANmF,EACA,MAAO,qBAAuB3B,EAClCoN,EAAMJ,EAAYI,GAAOzL,EAErBnE,EAAI,GAAKuR,EAAUpR,QAEvBoQ,EAAMH,KAAKjM,EACf,CACA,OAAIyL,IAAQiB,EACD,wBAA0BE,EAC9B,CAAEpB,SAAQY,QACrB,CAYA,OAnFIM,EADa,WAAbD,EACiB,EAGA,UAgFd,CACHY,aAZJ,SAAsBT,EAAKC,GACvB,MAAMlC,EAAMgC,EAASC,EAAKC,GAC1B,GAAmB,iBAARlC,EACP,OAAOA,CACf,EASI2C,OARJ,SAAgBV,EAAKC,GACjB,MAAMlC,EAAMgC,EAASC,EAAKC,GAC1B,GAAmB,iBAARlC,EACP,OAAOA,EACX,MAAM,IAAI1S,MAAM0S,EACpB,EAII4C,OAjFJ,SAAgB/B,EAAQY,EAAOS,GAE3B,GADAA,EAAQA,GAAS,GACbrB,EAAOxP,OAAS,EAAIoQ,EAAMpQ,OAAS6Q,EACnC,MAAM,IAAIvE,UAAU,wBAGxB,IAAImD,EAAMF,EAFVC,EAASA,EAAOuB,eAGhB,GAAmB,iBAARtB,EACP,MAAM,IAAIxT,MAAMwT,GACpB,IAAIO,EAASR,EAAS,IACtB,IAAK,IAAI3P,EAAI,EAAGA,EAAIuQ,EAAMpQ,SAAUH,EAAG,CACnC,MAAMN,EAAI6Q,EAAMvQ,GAChB,GAAIN,GAAK,EACL,MAAM,IAAItD,MAAM,kBACpBwT,EAAMJ,EAAYI,GAAOlQ,EACzByQ,GAAUf,EAASG,OAAO7P,EAC9B,CACA,IAAK,IAAIM,EAAI,EAAGA,EAAI,IAAKA,EACrB4P,EAAMJ,EAAYI,GAEtBA,GAAOiB,EACP,IAAK,IAAI7Q,EAAI,EAAGA,EAAI,IAAKA,EAErBmQ,GAAUf,EAASG,OADRK,GAAkB,GAAT,EAAI5P,GAAW,IAGvC,OAAOmQ,CACX,EAwDIE,UACAC,kBACAI,YAER,CACAvB,EAAQ,EAASwB,EAAuB,UACtBA,EAAuB,U,gBCxJlC,SAASgB,EAAO/T,EAAOuC,EAAQyR,EAAQ,IAC1C,MAAMrL,GAZctG,EAYErC,aAXF6B,YAAeuG,YAAY6L,OAAO5R,IAA6B,eAAvBA,EAAE5D,YAAYK,KADvE,IAAiBuD,EAapB,MAAMuH,EAAM5J,GAAOuC,OACb2R,OAAsB9S,IAAXmB,EACjB,IAAKoG,GAAUuL,GAAYtK,IAAQrH,EAI/B,MAAM,IAAI/D,OAHKwV,GAAS,IAAIA,OAGH,uBAFXE,EAAW,cAAc3R,IAAW,IAEO,UAD7CoG,EAAQ,UAAUiB,IAAQ,eAAe5J,IAGzD,OAAOA,CACX,CASO,SAASmU,EAAQC,EAAUC,GAAgB,GAC9C,GAAID,EAASE,UACT,MAAM,IAAI9V,MAAM,oCACpB,GAAI6V,GAAiBD,EAASG,SAC1B,MAAM,IAAI/V,MAAM,wCACxB,CAkBO,SAASgW,KAASC,GACrB,IAAK,IAAIrS,EAAI,EAAGA,EAAIqS,EAAOlS,OAAQH,IAC/BqS,EAAOrS,GAAG+D,KAAK,EAEvB,CAEO,SAASuO,EAAWC,GACvB,OAAO,IAAIC,SAASD,EAAI/O,OAAQ+O,EAAIE,WAAYF,EAAI9Q,WACxD,CAyJO,SAAS,EAAaiR,EAAUnL,EAAO,CAAC,GAC3C,MAAMoL,EAAQ,CAACC,EAAKC,IAASH,EAASG,GAAMC,OAAOF,GAAKG,SAClD1K,EAAMqK,OAAS1T,GAKrB,OAJA2T,EAAMK,UAAY3K,EAAI2K,UACtBL,EAAMM,SAAW5K,EAAI4K,SACrBN,EAAMO,OAAUL,GAASH,EAASG,GAClCjU,OAAOuU,OAAOR,EAAOpL,GACd3I,OAAOwU,OAAOT,EACzB,C,kBASO,MAAM,EAAWU,IAAW,CAC/BC,IAAK7T,WAAW8T,KAAK,CAAC,EAAM,EAAM,GAAM,IAAM,GAAM,EAAM,IAAM,EAAM,EAAM,EAAMF,MC9N/E,MAAMG,EACTP,SACAD,UACAS,UACAC,KAEAlQ,OACAmQ,KACAxB,UAAW,EACXhS,OAAS,EACTyT,IAAM,EACN1B,WAAY,EACZ,WAAA7V,CAAY4W,EAAUD,EAAWS,EAAWC,GACxCjX,KAAKwW,SAAWA,EAChBxW,KAAKuW,UAAYA,EACjBvW,KAAKgX,UAAYA,EACjBhX,KAAKiX,KAAOA,EACZjX,KAAK+G,OAAS,IAAI/D,WAAWwT,GAC7BxW,KAAKkX,KAAOrB,EAAW7V,KAAK+G,OAChC,CACA,MAAAsP,CAAO7J,GACH8I,EAAQtV,MACRkV,EAAO1I,GACP,MAAM,KAAE0K,EAAI,OAAEnQ,EAAM,SAAEyP,GAAaxW,KAC7B+K,EAAMyB,EAAK9I,OACjB,IAAK,IAAIyT,EAAM,EAAGA,EAAMpM,GAAM,CAC1B,MAAMqM,EAAOC,KAAKC,IAAId,EAAWxW,KAAKmX,IAAKpM,EAAMoM,GAEjD,GAAIC,IAASZ,EAAU,CACnB,MAAMe,EAAW1B,EAAWrJ,GAC5B,KAAOgK,GAAYzL,EAAMoM,EAAKA,GAAOX,EACjCxW,KAAKwX,QAAQD,EAAUJ,GAC3B,QACJ,CACApQ,EAAO7F,IAAIsL,EAAKiL,SAASN,EAAKA,EAAMC,GAAOpX,KAAKmX,KAChDnX,KAAKmX,KAAOC,EACZD,GAAOC,EACHpX,KAAKmX,MAAQX,IACbxW,KAAKwX,QAAQN,EAAM,GACnBlX,KAAKmX,IAAM,EAEnB,CAGA,OAFAnX,KAAK0D,QAAU8I,EAAK9I,OACpB1D,KAAK0X,aACE1X,IACX,CACA,UAAA2X,CAAWC,GACPtC,EAAQtV,MDpBT,SAAiB4X,EAAKrC,GACzBL,EAAO0C,OAAKrV,EAAW,uBACvB,MAAM+U,EAAM/B,EAASgB,UACrB,GAAIqB,EAAIlU,OAAS4T,EACb,MAAM,IAAI3X,MAAM,oDAAsD2X,EAE9E,CCeQO,CAAQD,EAAK5X,MACbA,KAAK0V,UAAW,EAIhB,MAAM,OAAE3O,EAAM,KAAEmQ,EAAI,SAAEV,EAAQ,KAAES,GAASjX,KACzC,IAAI,IAAEmX,GAAQnX,KAEd+G,EAAOoQ,KAAS,IAChBxB,EAAM3V,KAAK+G,OAAO0Q,SAASN,IAGvBnX,KAAKgX,UAAYR,EAAWW,IAC5BnX,KAAKwX,QAAQN,EAAM,GACnBC,EAAM,GAGV,IAAK,IAAI5T,EAAI4T,EAAK5T,EAAIiT,EAAUjT,IAC5BwD,EAAOxD,GAAK,EAIhB2T,EAAKY,aAAatB,EAAW,EAAGrK,OAAqB,EAAdnM,KAAK0D,QAAauT,GACzDjX,KAAKwX,QAAQN,EAAM,GACnB,MAAMa,EAAQlC,EAAW+B,GACnB7M,EAAM/K,KAAKuW,UAEjB,GAAIxL,EAAM,EACN,MAAM,IAAIpL,MAAM,6CACpB,MAAMqY,EAASjN,EAAM,EACf8E,EAAQ7P,KAAKc,MACnB,GAAIkX,EAASnI,EAAMnM,OACf,MAAM,IAAI/D,MAAM,sCACpB,IAAK,IAAI4D,EAAI,EAAGA,EAAIyU,EAAQzU,IACxBwU,EAAME,UAAU,EAAI1U,EAAGsM,EAAMtM,GAAI0T,EACzC,CACA,MAAAX,GACI,MAAM,OAAEvP,EAAM,UAAEwP,GAAcvW,KAC9BA,KAAK2X,WAAW5Q,GAChB,MAAMsL,EAAMtL,EAAO+E,MAAM,EAAGyK,GAE5B,OADAvW,KAAKkY,UACE7F,CACX,CACA,UAAA8F,CAAWC,GACPA,IAAO,IAAIpY,KAAKJ,YAChBwY,EAAGlX,OAAOlB,KAAKc,OACf,MAAM,SAAE0V,EAAQ,OAAEzP,EAAM,OAAErD,EAAM,SAAEgS,EAAQ,UAAED,EAAS,IAAE0B,GAAQnX,KAO/D,OANAoY,EAAG3C,UAAYA,EACf2C,EAAG1C,SAAWA,EACd0C,EAAG1U,OAASA,EACZ0U,EAAGjB,IAAMA,EACLzT,EAAS8S,GACT4B,EAAGrR,OAAO7F,IAAI6F,GACXqR,CACX,CACA,KAAAC,GACI,OAAOrY,KAAKmY,YAChB,EAOG,MAaMG,EAA4BC,YAAYzB,KAAK,CACtD,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,YC3IlF0B,EAA6BrM,OAAO,GAAK,GAAK,GAC9CsM,EAAuBtM,OAAO,IACpC,SAASuM,EAAQtV,EAAGuV,GAAK,GACrB,OAAIA,EACO,CAAEC,EAAGzJ,OAAO/L,EAAIoV,GAAaK,EAAG1J,OAAQ/L,GAAKqV,EAAQD,IACzD,CAAEI,EAAsC,EAAnCzJ,OAAQ/L,GAAKqV,EAAQD,GAAiBK,EAA4B,EAAzB1J,OAAO/L,EAAIoV,GACpE,CAWA,MAEMM,EAAQ,CAACF,EAAGG,EAAIC,IAAMJ,IAAMI,EAC5BC,EAAQ,CAACL,EAAGC,EAAGG,IAAOJ,GAAM,GAAKI,EAAOH,IAAMG,EAE9CE,EAAS,CAACN,EAAGC,EAAGG,IAAOJ,IAAMI,EAAMH,GAAM,GAAKG,EAC9CG,EAAS,CAACP,EAAGC,EAAGG,IAAOJ,GAAM,GAAKI,EAAOH,IAAMG,EAE/CI,EAAS,CAACR,EAAGC,EAAGG,IAAOJ,GAAM,GAAKI,EAAOH,IAAOG,EAAI,GACpDK,EAAS,CAACT,EAAGC,EAAGG,IAAOJ,IAAOI,EAAI,GAAQH,GAAM,GAAKG,EAY3D,SAASM,EAAIC,EAAIC,EAAIC,EAAIC,GACrB,MAAMb,GAAKW,IAAO,IAAME,IAAO,GAC/B,MAAO,CAAEd,EAAIW,EAAKE,GAAOZ,EAAI,GAAK,GAAM,GAAM,EAAGA,EAAO,EAAJA,EACxD,CAEA,MAAMc,EAAQ,CAACH,EAAIE,EAAIE,KAAQJ,IAAO,IAAME,IAAO,IAAME,IAAO,GAC1DC,EAAQ,CAACC,EAAKP,EAAIE,EAAIM,IAAQR,EAAKE,EAAKM,GAAOD,EAAM,GAAK,GAAM,GAAM,EACtEE,EAAQ,CAACR,EAAIE,EAAIE,EAAIK,KAAQT,IAAO,IAAME,IAAO,IAAME,IAAO,IAAMK,IAAO,GAC3EC,EAAQ,CAACJ,EAAKP,EAAIE,EAAIM,EAAII,IAAQZ,EAAKE,EAAKM,EAAKI,GAAOL,EAAM,GAAK,GAAM,GAAM,EAC/EM,EAAQ,CAACZ,EAAIE,EAAIE,EAAIK,EAAII,KAAQb,IAAO,IAAME,IAAO,IAAME,IAAO,IAAMK,IAAO,IAAMI,IAAO,GAC5FC,EAAQ,CAACR,EAAKP,EAAIE,EAAIM,EAAII,EAAII,IAAQhB,EAAKE,EAAKM,EAAKI,EAAKI,GAAOT,EAAM,GAAK,GAAM,GAAM,EC0ExFU,EAAuB,KDnH7B,SAAeC,EAAK9B,GAAK,GACrB,MAAM5N,EAAM0P,EAAI/W,OAChB,IAAI6V,EAAK,IAAIhB,YAAYxN,GACrByO,EAAK,IAAIjB,YAAYxN,GACzB,IAAK,IAAIxH,EAAI,EAAGA,EAAIwH,EAAKxH,IAAK,CAC1B,MAAM,EAAEqV,EAAC,EAAEC,GAAMH,EAAQ+B,EAAIlX,GAAIoV,IAChCY,EAAGhW,GAAIiW,EAAGjW,IAAM,CAACqV,EAAGC,EACzB,CACA,MAAO,CAACU,EAAIC,EAChB,CC0GoC,CAAU,CAC1C,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,sBACpEkB,IAAItX,GAAK+I,OAAO/I,KArBW,GAsBvBuX,EAA4B,KAAOH,EAAK,GAAZ,GAC5BI,EAA4B,KAAOJ,EAAK,GAAZ,GAE5BK,EAA6B,IAAItC,YAAY,IAC7CuC,EAA6B,IAAIvC,YAAY,IAEnD,MAAMwC,UAAiBhE,EACnB,WAAAnX,CAAY2W,GACRxW,MAAM,IAAKwW,EAAW,IAAI,EAC9B,CAEA,GAAAzV,GACI,MAAM,GAAEyY,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEK,EAAE,GAAEH,EAAE,GAAEO,EAAE,GAAEF,EAAE,GAAEM,EAAE,GAAEF,EAAE,GAAEW,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,GAAOrb,KAC3E,MAAO,CAACuZ,EAAIC,EAAIC,EAAIC,EAAIK,EAAIH,EAAIO,EAAIF,EAAIM,EAAIF,EAAIW,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EACxE,CAEA,GAAAna,CAAIqY,EAAIC,EAAIC,EAAIC,EAAIK,EAAIH,EAAIO,EAAIF,EAAIM,EAAIF,EAAIW,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC5Drb,KAAKuZ,GAAU,EAALA,EACVvZ,KAAKwZ,GAAU,EAALA,EACVxZ,KAAKyZ,GAAU,EAALA,EACVzZ,KAAK0Z,GAAU,EAALA,EACV1Z,KAAK+Z,GAAU,EAALA,EACV/Z,KAAK4Z,GAAU,EAALA,EACV5Z,KAAKma,GAAU,EAALA,EACVna,KAAKia,GAAU,EAALA,EACVja,KAAKua,GAAU,EAALA,EACVva,KAAKqa,GAAU,EAALA,EACVra,KAAKgb,GAAU,EAALA,EACVhb,KAAKib,GAAU,EAALA,EACVjb,KAAKkb,GAAU,EAALA,EACVlb,KAAKmb,GAAU,EAALA,EACVnb,KAAKob,GAAU,EAALA,EACVpb,KAAKqb,GAAU,EAALA,CACd,CACA,OAAA7D,CAAQN,EAAMoE,GAEV,IAAK,IAAI/X,EAAI,EAAGA,EAAI,GAAIA,IAAK+X,GAAU,EACnCT,EAAWtX,GAAK2T,EAAKqE,UAAUD,GAC/BR,EAAWvX,GAAK2T,EAAKqE,UAAWD,GAAU,GAE9C,IAAK,IAAI/X,EAAI,GAAIA,EAAI,GAAIA,IAAK,CAE1B,MAAMiY,EAA4B,EAArBX,EAAWtX,EAAI,IACtBkY,EAA4B,EAArBX,EAAWvX,EAAI,IACtBmY,EAAM,EAAWF,EAAMC,EAAM,GAAK,EAAWD,EAAMC,EAAM,GAAK,EAAUD,EAAMC,EAAM,GACpFE,EAAM,EAAWH,EAAMC,EAAM,GAAK,EAAWD,EAAMC,EAAM,GAAK,EAAUD,EAAMC,EAAM,GAEpFG,EAA0B,EAApBf,EAAWtX,EAAI,GACrBsY,EAA0B,EAApBf,EAAWvX,EAAI,GACrBuY,EAAM,EAAWF,EAAKC,EAAK,IAAM,EAAWD,EAAKC,EAAK,IAAM,EAAUD,EAAKC,EAAK,GAChFE,EAAM,EAAWH,EAAKC,EAAK,IAAM,EAAWD,EAAKC,EAAK,IAAM,EAAUD,EAAKC,EAAK,GAEhFG,EAAO,EAAUL,EAAKI,EAAKjB,EAAWvX,EAAI,GAAIuX,EAAWvX,EAAI,KAC7D0Y,EAAO,EAAUD,EAAMN,EAAKI,EAAKjB,EAAWtX,EAAI,GAAIsX,EAAWtX,EAAI,KACzEsX,EAAWtX,GAAY,EAAP0Y,EAChBnB,EAAWvX,GAAY,EAAPyY,CACpB,CACA,IAAI,GAAEzC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEK,EAAE,GAAEH,EAAE,GAAEO,EAAE,GAAEF,EAAE,GAAEM,EAAE,GAAEF,EAAE,GAAEW,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,GAAOrb,KAEzE,IAAK,IAAIuD,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAEzB,MAAM2Y,EAAU,EAAW3B,EAAIF,EAAI,IAAM,EAAWE,EAAIF,EAAI,IAAM,EAAWE,EAAIF,EAAI,IAC/E8B,EAAU,EAAW5B,EAAIF,EAAI,IAAM,EAAWE,EAAIF,EAAI,IAAM,EAAWE,EAAIF,EAAI,IAE/E+B,EAAQ7B,EAAKS,GAAQT,EAAKW,EAI1BmB,EAAO,EAAUhB,EAAIc,EAHb9B,EAAKY,GAAQZ,EAAKc,EAGUP,EAAUrX,GAAIuX,EAAWvX,IAC7D+Y,EAAM,EAAUD,EAAMjB,EAAIc,EAASE,EAAMzB,EAAUpX,GAAIsX,EAAWtX,IAClEgZ,EAAa,EAAPF,EAENG,EAAU,EAAWjD,EAAIC,EAAI,IAAM,EAAWD,EAAIC,EAAI,IAAM,EAAWD,EAAIC,EAAI,IAC/EiD,EAAU,EAAWlD,EAAIC,EAAI,IAAM,EAAWD,EAAIC,EAAI,IAAM,EAAWD,EAAIC,EAAI,IAC/EkD,EAAQnD,EAAKE,EAAOF,EAAKQ,EAAON,EAAKM,EACrC4C,EAAQnD,EAAKE,EAAOF,EAAKI,EAAOF,EAAKE,EAC3CwB,EAAU,EAALF,EACLG,EAAU,EAALF,EACLD,EAAU,EAALF,EACLG,EAAU,EAALF,EACLD,EAAU,EAALT,EACLU,EAAU,EAALZ,IACFzB,EAAG2B,EAAI1B,EAAGwB,GAAO,EAAa,EAALF,EAAa,EAALF,EAAc,EAANqC,EAAe,EAANC,IACrDpC,EAAU,EAALJ,EACLE,EAAU,EAALL,EACLG,EAAU,EAALN,EACLG,EAAU,EAALF,EACLD,EAAU,EAALF,EACLG,EAAU,EAALF,EACL,MAAMoD,EAAM,EAAUL,EAAKE,EAASE,GACpCpD,EAAK,EAAUqD,EAAKN,EAAKE,EAASE,GAClClD,EAAW,EAANoD,CACT,GAEGhE,EAAGW,EAAIV,EAAGW,GAAO,EAAkB,EAAVxZ,KAAKuZ,GAAkB,EAAVvZ,KAAKwZ,GAAa,EAALD,EAAa,EAALC,MAC3DZ,EAAGa,EAAIZ,EAAGa,GAAO,EAAkB,EAAV1Z,KAAKyZ,GAAkB,EAAVzZ,KAAK0Z,GAAa,EAALD,EAAa,EAALC,MAC3Dd,EAAGmB,EAAIlB,EAAGe,GAAO,EAAkB,EAAV5Z,KAAK+Z,GAAkB,EAAV/Z,KAAK4Z,GAAa,EAALG,EAAa,EAALH,MAC3DhB,EAAGuB,EAAItB,EAAGoB,GAAO,EAAkB,EAAVja,KAAKma,GAAkB,EAAVna,KAAKia,GAAa,EAALE,EAAa,EAALF,MAC3DrB,EAAG2B,EAAI1B,EAAGwB,GAAO,EAAkB,EAAVra,KAAKua,GAAkB,EAAVva,KAAKqa,GAAa,EAALE,EAAa,EAALF,MAC3DzB,EAAGoC,EAAInC,EAAGoC,GAAO,EAAkB,EAAVjb,KAAKgb,GAAkB,EAAVhb,KAAKib,GAAa,EAALD,EAAa,EAALC,MAC3DrC,EAAGsC,EAAIrC,EAAGsC,GAAO,EAAkB,EAAVnb,KAAKkb,GAAkB,EAAVlb,KAAKmb,GAAa,EAALD,EAAa,EAALC,MAC3DvC,EAAGwC,EAAIvC,EAAGwC,GAAO,EAAkB,EAAVrb,KAAKob,GAAkB,EAAVpb,KAAKqb,GAAa,EAALD,EAAa,EAALC,IAC9Drb,KAAKkB,IAAIqY,EAAIC,EAAIC,EAAIC,EAAIK,EAAIH,EAAIO,EAAIF,EAAIM,EAAIF,EAAIW,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EACzE,CACA,UAAA3D,GACI/B,EAAMkF,EAAYC,EACtB,CACA,OAAA5C,GACIvC,EAAM3V,KAAK+G,QACX/G,KAAKkB,IAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAC1D,EAGG,MAAM2b,UAAgB9B,EACzBxB,GAAoB,EAAfjB,EAAU,GACfkB,GAAoB,EAAflB,EAAU,GACfmB,GAAoB,EAAfnB,EAAU,GACfoB,GAAoB,EAAfpB,EAAU,GACfyB,GAAoB,EAAfzB,EAAU,GACfsB,GAAoB,EAAftB,EAAU,GACf6B,GAAoB,EAAf7B,EAAU,GACf2B,GAAoB,EAAf3B,EAAU,GACfiC,GAAoB,EAAfjC,EAAU,GACf+B,GAAoB,EAAf/B,EAAU,GACf0C,GAAqB,EAAhB1C,EAAU,IACf2C,GAAqB,EAAhB3C,EAAU,IACf4C,GAAqB,EAAhB5C,EAAU,IACf6C,GAAqB,EAAhB7C,EAAU,IACf8C,GAAqB,EAAhB9C,EAAU,IACf+C,GAAqB,EAAhB/C,EAAU,IACf,WAAA1Y,GACIG,MAAM,GACV,EA4FG,MAMM+c,EAAyB,EAAa,IAAM,IAAID,EAC7C,EAAQ,G,2CClWxB,MAAME,EAAgB,CAClBvR,EAAG,oEACHpI,EAAG,oEACHwV,EAAG,GACHpV,EAAG,oEACH8G,EAAG,oEACH0S,GAAI,oEACJC,GAAI,sEAEAzR,EAAG0R,EAAG9Z,EAAG+Z,EAAC,GAAEH,EAAE,GAAEC,EAAIzZ,EAAG4Z,EAAI9S,EAAG+S,EAAE,EAAEzE,GAAMmE,EAW1CO,EAAM,CAACxd,EAAU,MACnB,MAAMD,EAAI,IAAIF,MAAMG,GAEpB,KARiB,KAAIyd,KACjB,sBAAuB5d,OAA4C,mBAA5BA,MAAM6d,mBAC7C7d,MAAM6d,qBAAqBD,IAK/BE,CAAa5d,EAAGyd,GACVzd,GAMJqV,EAAS,CAAC/T,EAAOuC,EAAQyR,EAAQ,MACnC,MAAMrL,GAHOtG,EAGSrC,aAHU6B,YAAeuG,YAAY6L,OAAO5R,IAA6B,eAAvBA,EAAE5D,YAAYK,KAA1E,IAACuD,EAIb,MAAMuH,EAAM5J,GAAOuC,OACb2R,OAAsB9S,IAAXmB,EAOjB,QANKoG,GAAUuL,GAAYtK,IAAQrH,IAI/B4Z,GAHenI,GAAS,IAAIA,OAGf,uBAFCE,EAAW,cAAc3R,IAAW,IAEL,UADjCoG,EAAQ,UAAUiB,IAAQ,eAAe5J,IAGlDA,GAGLuc,EAAO3S,GAAQ,IAAI/H,WAAW+H,GAC9B4S,EAAQ3O,GAAQhM,WAAW8T,KAAK9H,GAChC4O,EAAO,CAACxa,EAAGmQ,IAAQnQ,EAAEya,SAAS,IAAIC,SAASvK,EAAK,KAChDwK,EAActa,GAAMsQ,MAAM+C,KAAK5B,EAAOzR,IACvCiX,IAAK7a,GAAM+d,EAAK/d,EAAG,IACnBme,KAAK,IAEJC,EAAOC,GACLA,GAFQ,IAEMA,GAFE,GAGTA,EAHC,GAIRA,GAJuB,IAIVA,GAJiB,GAKvBA,EAAK,GACZA,GANqC,IAMxBA,GAN+B,IAOrCA,EAAK,QADhB,EAIEC,EAAcC,IAChB,MAAMve,EAAI,cACV,GAlC8B,iBAkCnBue,EACP,OAAOd,EAAIzd,GACf,MAAMwe,EAAKD,EAAI1a,OACT4a,EAAKD,EAAK,EAChB,GAAIA,EAAK,EACL,OAAOf,EAAIzd,GACf,MAAM0e,EAAQb,EAAIY,GAClB,IAAK,IAAIE,EAAK,EAAGC,EAAK,EAAGD,EAAKF,EAAIE,IAAMC,GAAM,EAAG,CAE7C,MAAMC,EAAKT,EAAIG,EAAI/U,WAAWoV,IACxBE,EAAKV,EAAIG,EAAI/U,WAAWoV,EAAK,IACnC,QAAWlc,IAAPmc,QAA2Bnc,IAAPoc,EACpB,OAAOrB,EAAIzd,GACf0e,EAAMC,GAAW,GAALE,EAAUC,CAC1B,CACA,OAAOJ,GAELK,EAAK,IAAMje,YAAYgC,OAGvBkc,EAAc,IAAIC,KACpB,MAAMC,EAAIrB,EAAIoB,EAAKE,OAAO,CAACC,EAAKzb,IAAMyb,EAAM/J,EAAO1R,GAAGE,OAAQ,IAC9D,IAAI6P,EAAM,EAEV,OADAuL,EAAKI,QAAQ1b,IAAOub,EAAE7d,IAAIsC,EAAG+P,GAAMA,GAAO/P,EAAEE,SACrCqb,GAOLI,EAAMhT,OACNiT,EAAc,CAAChc,EAAGkU,EAAK+H,EAAKlJ,EAAM,6BAnE1B,CAAC/S,GAAmB,iBAANA,EAmE4Ckc,CAAMlc,IAAMkU,GAAOlU,GAAKA,EAAIic,EAAMjc,EAAIka,EAAInH,GAE5GoJ,EAAI,CAAC/b,EAAGC,EAAIyZ,KACd,MAAM6B,EAAIvb,EAAIC,EACd,OAAOsb,GAAK,GAAKA,EAAItb,EAAIsb,GAKvBS,EAAS,CAACC,EAAKC,MACL,KAARD,GAAcC,GAAM,KACpBpC,EAAI,gBAAkBmC,EAAM,QAAUC,GAC1C,IAAIlc,EAAI+b,EAAEE,EAAKC,GAAKjc,EAAIic,EAAIzc,EAAI,GAAI0c,EAAI,GAAIC,EAAI,GAAIlY,EAAI,GACxD,KAAa,KAANlE,GAAU,CACb,MAAMqc,EAAIpc,EAAID,EAAGub,EAAItb,EAAID,EACnBsc,EAAI7c,EAAI2c,EAAIC,EAAGzc,EAAIuc,EAAIjY,EAAImY,EACjCpc,EAAID,EAAGA,EAAIub,EAAG9b,EAAI2c,EAAGD,EAAIjY,EAAGkY,EAAIE,EAAGpY,EAAItE,CAC3C,CACA,OAAa,KAANK,EAAW8b,EAAEtc,EAAGyc,GAAMpC,EAAI,eAU/ByC,EAAUvU,GAAOA,aAAawU,EAAQxU,EAAI8R,EAAI,kBAG9C2C,EAAO,IAAM,KAEnB,MAAMD,EACFE,YACAA,YACAC,EACAC,EACAC,EACAC,EACA,WAAA1gB,CAAYugB,EAAGC,EAAGC,EAAGC,GACjB,MAAMjB,EAAMY,EACZjgB,KAAKmgB,EAAIf,EAAYe,EAAG,GAAId,GAC5Brf,KAAKogB,EAAIhB,EAAYgB,EAAG,GAAIf,GAC5Brf,KAAKqgB,EAAIjB,EAAYiB,EAAG,GAAIhB,GAC5Brf,KAAKsgB,EAAIlB,EAAYkB,EAAG,GAAIjB,GAC5Bld,OAAOwU,OAAO3W,KAClB,CACA,YAAOugB,GACH,OAAOxD,CACX,CACA,iBAAOyD,CAAWhV,GACd,OAAO,IAAIwU,EAAMxU,EAAEvI,EAAGuI,EAAEmU,EAAG,GAAIJ,EAAE/T,EAAEvI,EAAIuI,EAAEmU,GAC7C,CAEA,gBAAOc,CAAUrC,EAAKsC,GAAS,GAC3B,MAAMpW,EAAI+S,EAEJsD,EAAShD,EAAKzI,EAAOkJ,EA5IzB,KA8IIwC,EAAWxC,EAAI,IACrBuC,EAAO,KAAiB,IAAXC,EACb,MAAMjB,EAAIkB,EAAaF,GAIvBvB,EAAYO,EAAG,GADHe,EAAST,EAAO/C,GAE5B,MAAM4D,EAAKvB,EAAEI,EAAIA,GACXC,EAAIL,EAAEuB,EAAK,IACXpZ,EAAI6X,EAAEjV,EAAIwW,EAAK,IACrB,IAAI,QAAEC,EAAS5f,MAAO8B,GAAM+d,EAAQpB,EAAGlY,GAClCqZ,GACDzD,EAAI,yBACR,MAAM2D,EAAsB,KAAR,GAAJhe,GACVie,KAA4B,IAAXN,GAKvB,OAJKF,GAAgB,KAANzd,GAAYie,GACvB5D,EAAI,kCACJ4D,IAAkBD,IAClBhe,EAAIsc,GAAGtc,IACJ,IAAI+c,EAAM/c,EAAG0c,EAAG,GAAIJ,EAAEtc,EAAI0c,GACrC,CACA,cAAOwB,CAAQ/C,EAAKsC,GAChB,OAAOV,EAAMS,UAAUtC,EAAWC,GAAMsC,EAC5C,CACA,KAAIzd,GACA,OAAOjD,KAAKohB,WAAWne,CAC3B,CACA,KAAI0c,GACA,OAAO3f,KAAKohB,WAAWzB,CAC3B,CAEA,cAAA0B,GACI,MAAM7d,EAAI4Z,EACJ9S,EAAI+S,EAEV,GADUrd,KACJshB,MACF,OAAOhE,EAAI,mBAGf,MAAM,EAAE6C,EAAC,EAAEC,EAAC,EAAEC,EAAC,EAAEC,GALPtgB,KAMJuhB,EAAKhC,EAAEY,EAAIA,GACXqB,EAAKjC,EAAEa,EAAIA,GACXqB,EAAKlC,EAAEc,EAAIA,GACXqB,EAAKnC,EAAEkC,EAAKA,GACZE,EAAMpC,EAAEgC,EAAK/d,GAGnB,OAFa+b,EAAEkC,EAAKlC,EAAEoC,EAAMH,MACdjC,EAAEmC,EAAKnC,EAAEjV,EAAIiV,EAAEgC,EAAKC,KAEvBlE,EAAI,yCAEJiC,EAAEY,EAAIC,KACNb,EAAEc,EAAIC,GAENhD,EAAI,yCACRtd,IACX,CAEA,MAAA4hB,CAAOC,GACH,MAAQ1B,EAAG2B,EAAI1B,EAAG2B,EAAI1B,EAAG2B,GAAOhiB,MACxBmgB,EAAGoB,EAAInB,EAAGoB,EAAInB,EAAGoB,GAAO1B,EAAO8B,GACjCI,EAAO1C,EAAEuC,EAAKL,GACdS,EAAO3C,EAAEgC,EAAKS,GACdG,EAAO5C,EAAEwC,EAAKN,GACdW,EAAO7C,EAAEiC,EAAKQ,GACpB,OAAOC,IAASC,GAAQC,IAASC,CACrC,CACA,GAAAd,GACI,OAAOthB,KAAK4hB,OAAOS,EACvB,CAEA,MAAAC,GACI,OAAO,IAAItC,EAAMT,GAAGvf,KAAKmgB,GAAIngB,KAAKogB,EAAGpgB,KAAKqgB,EAAGd,GAAGvf,KAAKsgB,GACzD,CAEA,MAAAiC,GACI,MAAQpC,EAAG2B,EAAI1B,EAAG2B,EAAI1B,EAAG2B,GAAOhiB,KAC1BwD,EAAI4Z,EAEJoF,EAAIjD,EAAEuC,EAAKA,GACXW,EAAIlD,EAAEwC,EAAKA,GACXW,EAAInD,EAAE,GAAKA,EAAEyC,EAAKA,IAClBW,EAAIpD,EAAE/b,EAAIgf,GACVI,EAAOd,EAAKC,EACZc,EAAItD,EAAEA,EAAEqD,EAAOA,GAAQJ,EAAIC,GAC3BK,EAAIH,EAAIF,EACRM,EAAID,EAAIJ,EACRM,EAAIL,EAAIF,EACRQ,EAAK1D,EAAEsD,EAAIE,GACXG,EAAK3D,EAAEuD,EAAIE,GACXG,EAAK5D,EAAEsD,EAAIG,GACXI,EAAK7D,EAAEwD,EAAID,GACjB,OAAO,IAAI9C,EAAMiD,EAAIC,EAAIE,EAAID,EACjC,CAEA,GAAA7J,CAAIuI,GACA,MAAQ1B,EAAG2B,EAAI1B,EAAG2B,EAAI1B,EAAG2B,EAAI1B,EAAG+C,GAAOrjB,MAC/BmgB,EAAGoB,EAAInB,EAAGoB,EAAInB,EAAGoB,EAAInB,EAAGgD,GAAOvD,EAAO8B,GACxCre,EAAI4Z,EACJ9S,EAAI+S,EAEJmF,EAAIjD,EAAEuC,EAAKP,GACXkB,EAAIlD,EAAEwC,EAAKP,GACXkB,EAAInD,EAAE8D,EAAK/Y,EAAIgZ,GACfX,EAAIpD,EAAEyC,EAAKP,GACXoB,EAAItD,GAAGuC,EAAKC,IAAOR,EAAKC,GAAMgB,EAAIC,GAClCM,EAAIxD,EAAEoD,EAAID,GACVI,EAAIvD,EAAEoD,EAAID,GACVM,EAAIzD,EAAEkD,EAAIjf,EAAIgf,GACdS,EAAK1D,EAAEsD,EAAIE,GACXG,EAAK3D,EAAEuD,EAAIE,GACXG,EAAK5D,EAAEsD,EAAIG,GACXI,EAAK7D,EAAEwD,EAAID,GACjB,OAAO,IAAI9C,EAAMiD,EAAIC,EAAIE,EAAID,EACjC,CACA,QAAAI,CAAS1B,GACL,OAAO7hB,KAAKsZ,IAAIyG,EAAO8B,GAAOS,SAClC,CAQA,QAAAkB,CAASpgB,EAAGqgB,GAAO,GACf,IAAKA,IAAe,KAANrgB,GAAYpD,KAAKshB,OAC3B,OAAOe,EAEX,GADAjD,EAAYhc,EAAG,GAAI+Z,GACT,KAAN/Z,EACA,OAAOpD,KACX,GAAIA,KAAK4hB,OAAOkB,GACZ,OAAOY,EAAKtgB,GAAGoI,EAEnB,IAAIA,EAAI6W,EACJtS,EAAI+S,EACR,IAAK,IAAIxY,EAAItK,KAAMoD,EAAI,GAAIkH,EAAIA,EAAEiY,SAAUnf,IAAM,GAGrC,GAAJA,EACAoI,EAAIA,EAAE8N,IAAIhP,GACLmZ,IACL1T,EAAIA,EAAEuJ,IAAIhP,IAElB,OAAOkB,CACX,CACA,cAAAmY,CAAeC,GACX,OAAO5jB,KAAKwjB,SAASI,GAAQ,EACjC,CAEA,QAAAxC,GACI,MAAM,EAAEjB,EAAC,EAAEC,EAAC,EAAEC,GAAMrgB,KAEpB,GAAIA,KAAK4hB,OAAOS,GACZ,MAAO,CAAEpf,EAAG,GAAI0c,EAAG,IACvB,MAAMkE,EAAKrE,EAAOa,EAAGnD,GAOrB,OALkB,KAAdqC,EAAEc,EAAIwD,IACNvG,EAAI,mBAID,CAAEra,EAFCsc,EAAEY,EAAI0D,GAEJlE,EADFJ,EAAEa,EAAIyD,GAEpB,CACA,OAAAC,GACI,MAAM,EAAE7gB,EAAC,EAAE0c,GAAM3f,KAAKqhB,iBAAiBD,WACjC3d,EAAIsgB,EAAWpE,GAGrB,OADAlc,EAAE,KAAW,GAAJR,EAAS,IAAO,EAClBQ,CACX,CACA,KAAAugB,GACI,OAAOjG,EAAW/d,KAAK8jB,UAC3B,CACA,aAAAG,GACI,OAAOjkB,KAAKwjB,SAASrE,EAAIvG,IAAI,EACjC,CACA,YAAAsL,GACI,OAAOlkB,KAAKikB,gBAAgB3C,KAChC,CACA,aAAA6C,GAEI,IAAI3Y,EAAIxL,KAAKwjB,SAASrG,EAAI,IAAI,GAAOoF,SAGrC,OAFIpF,EAAI,KACJ3R,EAAIA,EAAE8N,IAAItZ,OACPwL,EAAE8V,KACb,EAGJ,MAAMwB,EAAI,IAAI9C,EAAMhD,EAAIC,EAAI,GAAIsC,EAAEvC,EAAKC,IAEjCoF,EAAI,IAAIrC,EAAM,GAAI,GAAI,GAAI,IAEhCA,EAAMoE,KAAOtB,EACb9C,EAAMqE,KAAOhC,EACb,MAAM0B,EAActE,GAAQtB,EAAWP,EAAKwB,EAAYK,EAAK,GAAIQ,GA/UtD,KA+UkEqE,UACvEzD,EAAgBpd,GAAM0b,EAAI,KAAOpB,EAAWJ,EAAKzI,EAAOzR,IAAI6gB,YAC5DC,EAAO,CAACthB,EAAGuhB,KAEb,IAAIzF,EAAI9b,EACR,KAAOuhB,KAAU,IACbzF,GAAKA,EACLA,GAAK7B,EAET,OAAO6B,GAkBL0F,EAAM,oEAGNzD,EAAU,CAACpB,EAAGlY,KAChB,MAAMgd,EAAKnF,EAAE7X,EAAIA,EAAIA,GAEfid,EArBU,CAAC1hB,IACjB,MACM2hB,EADM3hB,EAAIA,EAAKia,EACJja,EAAKia,EAChB2H,EAAMN,EAAKK,EAAI,IAAMA,EAAM1H,EAC3B4H,EAAMP,EAAKM,EAAI,IAAM5hB,EAAKia,EAC1B6H,EAAOR,EAAKO,EAAI,IAAMA,EAAM5H,EAC5B8H,EAAOT,EAAKQ,EAAK,KAAOA,EAAO7H,EAC/B+H,EAAOV,EAAKS,EAAK,KAAOA,EAAO9H,EAC/BgI,EAAOX,EAAKU,EAAK,KAAOA,EAAO/H,EAC/BiI,EAAQZ,EAAKW,EAAK,KAAOA,EAAOhI,EAChCkI,EAAQb,EAAKY,EAAM,KAAOD,EAAOhI,EACjCmI,EAAQd,EAAKa,EAAM,KAAOL,EAAO7H,EAEvC,MAAO,CAAEoI,UADUf,EAAKc,EAAM,IAAMpiB,EAAKia,EACrB0H,OAQRW,CAAY3F,EADbL,EAAEmF,EAAKA,EAAKhd,IACS4d,UAChC,IAAIriB,EAAIsc,EAAEK,EAAI8E,EAAKC,GACnB,MAAMa,EAAMjG,EAAE7X,EAAIzE,EAAIA,GAChBwiB,EAAQxiB,EACRyiB,EAAQnG,EAAEtc,EAAIwhB,GACdkB,EAAWH,IAAQ5F,EACnBgG,EAAWJ,IAAQjG,GAAGK,GACtBiG,EAASL,IAAQjG,GAAGK,EAAI6E,GAO9B,OANIkB,IACA1iB,EAAIwiB,IACJG,GAAYC,KACZ5iB,EAAIyiB,GACY,KAAR,GAAPnG,EAAEtc,MACHA,EAAIsc,GAAGtc,IACJ,CAAE8d,QAAS4E,GAAYC,EAAUzkB,MAAO8B,IAG7C6iB,EAAWpb,IAASqb,OA1SZviB,EA0SiBqd,EAAanW,GA1SxB6U,EAAE/b,EAAG2Z,GAAZ,IAAC3Z,GA8SRwiB,EAAU,IAAIlG,IAhSH,CAAC7f,IAEd,MAAMgmB,EAAKC,EAAOjmB,GAGlB,MAFkB,mBAAPgmB,GACP3I,EAAI,UAAYrd,EAAO,YACpBgmB,GA2ReE,CAAS,SAATA,CAAmBtH,KAAeiB,IAgBtDsG,EAAwBC,GAdZ,CAACC,IAEf,MAAMC,EAAOD,EAAOxa,MAAM,EA1YpB,IA2YNya,EAAK,IAAM,IACXA,EAAK,KAAO,IACZA,EAAK,KAAO,GACZ,MAAMrT,EAASoT,EAAOxa,MA9YhB,GACC,IA8YD8X,EAASkC,EAAQS,GACjBC,EAAQ1D,EAAEU,SAASI,GACnB6C,EAAaD,EAAM1C,UACzB,MAAO,CAAEyC,OAAMrT,SAAQ0Q,SAAQ4C,QAAOC,eAIEC,CAAUV,EAAQ9Q,EAAOmR,EAtZ3D,MA0ZJM,EAAgBC,GAASR,EAAqBQ,GAAMH,WAwEpDI,EAAM,CACR9I,WAAYA,EACZI,WAAYA,EACZU,YAAaA,EACbiI,IAAKvH,EACLC,OAAQA,EACRuH,YA3ZgB,CAAChc,EA7EX,KA8EI6T,IACDoI,gBAAgBtJ,EAAI3S,KA2Z3Bmb,EAAS,CACXe,YAAavkB,MAAO5C,IAChB,MAAMkZ,EAxaO4F,KAAMhc,QAAU0a,EAAI,oDAya3BwC,EAAIjB,EAAY/e,GACtB,OAAO4d,QAAU1E,EAAE1C,OAAO,UAAWwJ,EAAE/Y,UAE3C+V,YAAQva,GAyBN2kB,EAAW7P,KAAK8P,KAAKC,IAAkB,EAiB7C,IAAIC,EAEJ,MAAMC,EAAQ,CAACC,EAAK/b,KAChB,MAAMpI,EAAIoI,EAAE8W,SACZ,OAAOiF,EAAMnkB,EAAIoI,GAafkY,EAAQtgB,IACV,MAAMokB,EAAOH,IAAUA,EAjCR,MACf,MAAMI,EAAS,GACf,IAAIjc,EAAIsX,EACJrf,EAAI+H,EACR,IAAK,IAAInI,EAAI,EAAGA,EAAI6jB,EAAU7jB,IAAK,CAC/BI,EAAI+H,EACJic,EAAO9T,KAAKlQ,GACZ,IAAK,IAAIF,EAAI,EAAGA,EARJ,IAQqBA,IAC7BE,EAAIA,EAAE6V,IAAI9N,GACVic,EAAO9T,KAAKlQ,GAEhB+H,EAAI/H,EAAE8e,QACV,CACA,OAAOkF,GAoBwBC,IAC/B,IAAIlc,EAAI6W,EACJtS,EAAI+S,EACR,MAEM6E,EAAOxI,EAAIyI,KACXC,EAAU1I,EA3CV,GA4CN,IAAK,IAAI9b,EAAI,EAAGA,EAAI6jB,EAAU7jB,IAAK,CAC/B,IAAIykB,EAAQ3Y,OAAO/L,EAAIukB,GACvBvkB,IAAMykB,EAMFC,EAjDQ,MAkDRA,GAbQ,IAcR1kB,GAAK,IAET,MAAM2kB,EArDM,IAqDA1kB,EACN2kB,EAAOD,EACPE,EAAOF,EAAM1Q,KAAK6Q,IAAIJ,GAAS,EAC/BK,EAAS9kB,EAAI,GAAM,EACnB+kB,EAAQN,EAAQ,EACR,IAAVA,EAEA/X,EAAIA,EAAEuJ,IAAIgO,EAAMa,EAAQX,EAAKQ,KAG7Bxc,EAAIA,EAAE8N,IAAIgO,EAAMc,EAAOZ,EAAKS,IAEpC,CAGA,OAFU,KAAN7kB,GACAka,EAAI,gBACD,CAAE9R,IAAGuE,K","sources":["webpack://export-tests/./node_modules/@hpke/common/esm/src/errors.js","webpack://export-tests/./node_modules/@hpke/common/esm/_dnt.shims.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/algorithm.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/identifiers.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/consts.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/interfaces/kemInterface.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/utils/misc.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/kems/dhkem.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/utils/bignum.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/kems/dhkemPrimitives/ec.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/kdfs/hkdf.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/interfaces/aeadEncryptionContext.js","webpack://export-tests/./node_modules/@hpke/common/esm/src/curve/montgomery.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/aeads/aesGcm.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/utils/emitNotSupported.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/exporterContext.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/encryptionContext.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/mutex.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/recipientContext.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/senderContext.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/cipherSuiteNative.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/kems/dhkemNative.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/native.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x25519.js","webpack://export-tests/./node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x448.js","webpack://export-tests/./node_modules/bech32/dist/index.js","webpack://export-tests/./node_modules/@noble/hashes/utils.js","webpack://export-tests/./node_modules/@noble/hashes/_md.js","webpack://export-tests/./node_modules/@noble/hashes/_u64.js","webpack://export-tests/./node_modules/@noble/hashes/sha2.js","webpack://export-tests/./node_modules/@noble/ed25519/index.js"],"sourcesContent":["/**\n * The base error class of hpke-js.\n * @group Errors\n */\nexport class HpkeError extends Error {\n    constructor(e) {\n        let message;\n        if (e instanceof Error) {\n            message = e.message;\n        }\n        else if (typeof e === \"string\") {\n            message = e;\n        }\n        else {\n            message = \"\";\n        }\n        super(message);\n        this.name = this.constructor.name;\n    }\n}\n/**\n * Invalid parameter.\n * @group Errors\n */\nexport class InvalidParamError extends HpkeError {\n}\n/**\n * KEM input or output validation failure.\n * @group Errors\n */\nexport class ValidationError extends HpkeError {\n}\n/**\n * Public or private key serialization failure.\n * @group Errors\n */\nexport class SerializeError extends HpkeError {\n}\n/**\n * Public or private key deserialization failure.\n * @group Errors\n */\nexport class DeserializeError extends HpkeError {\n}\n/**\n * encap() failure.\n * @group Errors\n */\nexport class EncapError extends HpkeError {\n}\n/**\n * decap() failure.\n * @group Errors\n */\nexport class DecapError extends HpkeError {\n}\n/**\n * Secret export failure.\n * @group Errors\n */\nexport class ExportError extends HpkeError {\n}\n/**\n * seal() failure.\n * @group Errors\n */\nexport class SealError extends HpkeError {\n}\n/**\n * open() failure.\n * @group Errors\n */\nexport class OpenError extends HpkeError {\n}\n/**\n * Sequence number overflow on the encryption context.\n * @group Errors\n */\nexport class MessageLimitReachedError extends HpkeError {\n}\n/**\n * Key pair derivation failure.\n * @group Errors\n */\nexport class DeriveKeyPairError extends HpkeError {\n}\n/**\n * Not supported failure.\n * @group Errors\n */\nexport class NotSupportedError extends HpkeError {\n}\n","const dntGlobals = {};\nexport const dntGlobalThis = createMergeProxy(globalThis, dntGlobals);\nfunction createMergeProxy(baseObj, extObj) {\n    return new Proxy(baseObj, {\n        get(_target, prop, _receiver) {\n            if (prop in extObj) {\n                return extObj[prop];\n            }\n            else {\n                return baseObj[prop];\n            }\n        },\n        set(_target, prop, value) {\n            if (prop in extObj) {\n                delete extObj[prop];\n            }\n            baseObj[prop] = value;\n            return true;\n        },\n        deleteProperty(_target, prop) {\n            let success = false;\n            if (prop in extObj) {\n                delete extObj[prop];\n                success = true;\n            }\n            if (prop in baseObj) {\n                delete baseObj[prop];\n                success = true;\n            }\n            return success;\n        },\n        ownKeys(_target) {\n            const baseKeys = Reflect.ownKeys(baseObj);\n            const extKeys = Reflect.ownKeys(extObj);\n            const extKeysSet = new Set(extKeys);\n            return [...baseKeys.filter((k) => !extKeysSet.has(k)), ...extKeys];\n        },\n        defineProperty(_target, prop, desc) {\n            if (prop in extObj) {\n                delete extObj[prop];\n            }\n            Reflect.defineProperty(baseObj, prop, desc);\n            return true;\n        },\n        getOwnPropertyDescriptor(_target, prop) {\n            if (prop in extObj) {\n                return Reflect.getOwnPropertyDescriptor(extObj, prop);\n            }\n            else {\n                return Reflect.getOwnPropertyDescriptor(baseObj, prop);\n            }\n        },\n        has(_target, prop) {\n            return prop in extObj || prop in baseObj;\n        },\n    });\n}\n","import * as dntShim from \"../_dnt.shims.js\";\nimport { NotSupportedError } from \"./errors.js\";\nasync function loadSubtleCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto.subtle;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto.subtle;\n    }\n    catch (e) {\n        throw new NotSupportedError(e);\n    }\n}\nexport class NativeAlgorithm {\n    constructor() {\n        Object.defineProperty(this, \"_api\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n    }\n    async _setup() {\n        if (this._api !== undefined) {\n            return;\n        }\n        this._api = await loadSubtleCrypto();\n    }\n}\n","/**\n * The supported HPKE modes.\n */\nexport const Mode = {\n    Base: 0x00,\n    Psk: 0x01,\n    Auth: 0x02,\n    AuthPsk: 0x03,\n};\n/**\n * The supported Key Encapsulation Mechanism (KEM) identifiers.\n */\nexport const KemId = {\n    NotAssigned: 0x0000,\n    DhkemP256HkdfSha256: 0x0010,\n    DhkemP384HkdfSha384: 0x0011,\n    DhkemP521HkdfSha512: 0x0012,\n    DhkemSecp256k1HkdfSha256: 0x0013,\n    DhkemX25519HkdfSha256: 0x0020,\n    DhkemX448HkdfSha512: 0x0021,\n    HybridkemX25519Kyber768: 0x0030,\n    MlKem512: 0x0040,\n    MlKem768: 0x0041,\n    MlKem1024: 0x0042,\n    XWing: 0x647a,\n};\n/**\n * The supported Key Derivation Function (KDF) identifiers.\n */\nexport const KdfId = {\n    HkdfSha256: 0x0001,\n    HkdfSha384: 0x0002,\n    HkdfSha512: 0x0003,\n};\n/**\n * The supported Authenticated Encryption with Associated Data (AEAD) identifiers.\n */\nexport const AeadId = {\n    Aes128Gcm: 0x0001,\n    Aes256Gcm: 0x0002,\n    Chacha20Poly1305: 0x0003,\n    ExportOnly: 0xFFFF,\n};\n","// The input length limit (psk, psk_id, info, exporter_context, ikm).\nexport const INPUT_LENGTH_LIMIT = 8192;\nexport const INFO_LENGTH_LIMIT = 65536;\n// The minimum length of a PSK.\nexport const MINIMUM_PSK_LENGTH = 32;\n// b\"\"\nexport const EMPTY = new Uint8Array(0);\n","// b\"KEM\"\nexport const SUITE_ID_HEADER_KEM = new Uint8Array([\n    75,\n    69,\n    77,\n    0,\n    0,\n]);\n","import * as dntShim from \"../../_dnt.shims.js\";\nimport { KemId } from \"../identifiers.js\";\nexport const isDenoV1 = () => \n// deno-lint-ignore no-explicit-any\ndntShim.dntGlobalThis.process === undefined;\n/**\n * Checks whether the runtime is Deno or not (Node.js).\n * @returns boolean - true if the runtime is Deno, false Node.js.\n */\nexport function isDeno() {\n    // deno-lint-ignore no-explicit-any\n    if (dntShim.dntGlobalThis.process === undefined) {\n        return true;\n    }\n    // deno-lint-ignore no-explicit-any\n    return dntShim.dntGlobalThis.process?.versions?.deno !== undefined;\n}\n/**\n * Checks whetehr the type of input is CryptoKeyPair or not.\n */\nexport const isCryptoKeyPair = (x) => typeof x === \"object\" &&\n    x !== null &&\n    typeof x.privateKey === \"object\" &&\n    typeof x.publicKey === \"object\";\n/**\n * Converts integer to octet string. I2OSP implementation.\n */\nexport function i2Osp(n, w) {\n    if (w <= 0) {\n        throw new Error(\"i2Osp: too small size\");\n    }\n    if (n >= 256 ** w) {\n        throw new Error(\"i2Osp: too large integer\");\n    }\n    const ret = new Uint8Array(w);\n    for (let i = 0; i < w && n; i++) {\n        ret[w - (i + 1)] = n % 256;\n        n = n >> 8;\n    }\n    return ret;\n}\n/**\n * Concatenates two Uint8Arrays.\n * @param a Uint8Array\n * @param b Uint8Array\n * @returns Concatenated Uint8Array\n */\nexport function concat(a, b) {\n    const ret = new Uint8Array(a.length + b.length);\n    ret.set(a, 0);\n    ret.set(b, a.length);\n    return ret;\n}\n/**\n * Decodes Base64Url-encoded data.\n * @param v Base64Url-encoded string\n * @returns Uint8Array\n */\nexport function base64UrlToBytes(v) {\n    const base64 = v.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const byteString = atob(base64);\n    const ret = new Uint8Array(byteString.length);\n    for (let i = 0; i < byteString.length; i++) {\n        ret[i] = byteString.charCodeAt(i);\n    }\n    return ret;\n}\n/**\n * Encodes Uint8Array to Base64Url.\n * @param v Uint8Array\n * @returns Base64Url-encoded string\n */\nexport function bytesToBase64Url(v) {\n    return btoa(String.fromCharCode(...v))\n        .replace(/\\+/g, \"-\")\n        .replace(/\\//g, \"_\")\n        .replace(/=*$/g, \"\");\n}\n/**\n * Decodes hex string to Uint8Array.\n * @param v Hex string\n * @returns Uint8Array\n * @throws Error if the input is not a hex string.\n */\nexport function hexToBytes(v) {\n    if (v.length === 0) {\n        return new Uint8Array([]);\n    }\n    const res = v.match(/[\\da-f]{2}/gi);\n    if (res == null) {\n        throw new Error(\"Not hex string.\");\n    }\n    return new Uint8Array(res.map(function (h) {\n        return parseInt(h, 16);\n    }));\n}\n/**\n * Encodes Uint8Array to hex string.\n * @param v Uint8Array\n * @returns Hex string\n */\nexport function bytesToHex(v) {\n    return [...v].map((x) => x.toString(16).padStart(2, \"0\")).join(\"\");\n}\n/**\n * Converts KemId to KeyAlgorithm.\n * @param kem KemId\n * @returns KeyAlgorithm\n */\nexport function kemToKeyGenAlgorithm(kem) {\n    switch (kem) {\n        case KemId.DhkemP256HkdfSha256:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-256\",\n            };\n        case KemId.DhkemP384HkdfSha384:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-384\",\n            };\n        case KemId.DhkemP521HkdfSha512:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-521\",\n            };\n        default:\n            // case KemId.DhkemX25519HkdfSha256\n            return {\n                name: \"X25519\",\n            };\n    }\n}\nexport async function loadSubtleCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto.subtle;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto.subtle;\n    }\n    catch (_e) {\n        throw new Error(\"Failed to load SubtleCrypto\");\n    }\n}\nexport async function loadCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto;\n    }\n    catch (_e) {\n        throw new Error(\"Web Cryptograph API not supported\");\n    }\n}\n/**\n * XOR for Uint8Array.\n */\nexport function xor(a, b) {\n    if (a.byteLength !== b.byteLength) {\n        throw new Error(\"xor: different length inputs\");\n    }\n    const buf = new Uint8Array(a.byteLength);\n    for (let i = 0; i < a.byteLength; i++) {\n        buf[i] = a[i] ^ b[i];\n    }\n    return buf;\n}\n","import { EMPTY, INPUT_LENGTH_LIMIT } from \"../consts.js\";\nimport { DecapError, EncapError, InvalidParamError } from \"../errors.js\";\nimport { SUITE_ID_HEADER_KEM } from \"../interfaces/kemInterface.js\";\nimport { concat, i2Osp, isCryptoKeyPair } from \"../utils/misc.js\";\n// b\"eae_prk\"\nconst LABEL_EAE_PRK = new Uint8Array([101, 97, 101, 95, 112, 114, 107]);\n// b\"shared_secret\"\n// deno-fmt-ignore\nconst LABEL_SHARED_SECRET = new Uint8Array([\n    115, 104, 97, 114, 101, 100, 95, 115, 101, 99,\n    114, 101, 116,\n]);\nfunction concat3(a, b, c) {\n    const ret = new Uint8Array(a.length + b.length + c.length);\n    ret.set(a, 0);\n    ret.set(b, a.length);\n    ret.set(c, a.length + b.length);\n    return ret;\n}\nexport class Dhkem {\n    constructor(id, prim, kdf) {\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"_prim\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.id = id;\n        this._prim = prim;\n        this._kdf = kdf;\n        const suiteId = new Uint8Array(SUITE_ID_HEADER_KEM);\n        suiteId.set(i2Osp(this.id, 2), 3);\n        this._kdf.init(suiteId);\n    }\n    async serializePublicKey(key) {\n        return await this._prim.serializePublicKey(key);\n    }\n    async deserializePublicKey(key) {\n        return await this._prim.deserializePublicKey(key);\n    }\n    async serializePrivateKey(key) {\n        return await this._prim.serializePrivateKey(key);\n    }\n    async deserializePrivateKey(key) {\n        return await this._prim.deserializePrivateKey(key);\n    }\n    async importKey(format, key, isPublic = true) {\n        return await this._prim.importKey(format, key, isPublic);\n    }\n    async generateKeyPair() {\n        return await this._prim.generateKeyPair();\n    }\n    async deriveKeyPair(ikm) {\n        if (ikm.byteLength > INPUT_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long ikm\");\n        }\n        return await this._prim.deriveKeyPair(ikm);\n    }\n    async encap(params) {\n        let ke;\n        if (params.ekm === undefined) {\n            ke = await this.generateKeyPair();\n        }\n        else if (isCryptoKeyPair(params.ekm)) {\n            // params.ekm is only used for testing.\n            ke = params.ekm;\n        }\n        else {\n            // params.ekm is only used for testing.\n            ke = await this.deriveKeyPair(params.ekm);\n        }\n        const enc = await this._prim.serializePublicKey(ke.publicKey);\n        const pkrm = await this._prim.serializePublicKey(params.recipientPublicKey);\n        try {\n            let dh;\n            if (params.senderKey === undefined) {\n                dh = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));\n            }\n            else {\n                const sks = isCryptoKeyPair(params.senderKey)\n                    ? params.senderKey.privateKey\n                    : params.senderKey;\n                const dh1 = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));\n                const dh2 = new Uint8Array(await this._prim.dh(sks, params.recipientPublicKey));\n                dh = concat(dh1, dh2);\n            }\n            let kemContext;\n            if (params.senderKey === undefined) {\n                kemContext = concat(new Uint8Array(enc), new Uint8Array(pkrm));\n            }\n            else {\n                const pks = isCryptoKeyPair(params.senderKey)\n                    ? params.senderKey.publicKey\n                    : await this._prim.derivePublicKey(params.senderKey);\n                const pksm = await this._prim.serializePublicKey(pks);\n                kemContext = concat3(new Uint8Array(enc), new Uint8Array(pkrm), new Uint8Array(pksm));\n            }\n            const sharedSecret = await this._generateSharedSecret(dh, kemContext);\n            return {\n                enc: enc,\n                sharedSecret: sharedSecret,\n            };\n        }\n        catch (e) {\n            throw new EncapError(e);\n        }\n    }\n    async decap(params) {\n        const pke = await this._prim.deserializePublicKey(params.enc);\n        const skr = isCryptoKeyPair(params.recipientKey)\n            ? params.recipientKey.privateKey\n            : params.recipientKey;\n        const pkr = isCryptoKeyPair(params.recipientKey)\n            ? params.recipientKey.publicKey\n            : await this._prim.derivePublicKey(params.recipientKey);\n        const pkrm = await this._prim.serializePublicKey(pkr);\n        try {\n            let dh;\n            if (params.senderPublicKey === undefined) {\n                dh = new Uint8Array(await this._prim.dh(skr, pke));\n            }\n            else {\n                const dh1 = new Uint8Array(await this._prim.dh(skr, pke));\n                const dh2 = new Uint8Array(await this._prim.dh(skr, params.senderPublicKey));\n                dh = concat(dh1, dh2);\n            }\n            let kemContext;\n            if (params.senderPublicKey === undefined) {\n                kemContext = concat(new Uint8Array(params.enc), new Uint8Array(pkrm));\n            }\n            else {\n                const pksm = await this._prim.serializePublicKey(params.senderPublicKey);\n                kemContext = new Uint8Array(params.enc.byteLength + pkrm.byteLength + pksm.byteLength);\n                kemContext.set(new Uint8Array(params.enc), 0);\n                kemContext.set(new Uint8Array(pkrm), params.enc.byteLength);\n                kemContext.set(new Uint8Array(pksm), params.enc.byteLength + pkrm.byteLength);\n            }\n            return await this._generateSharedSecret(dh, kemContext);\n        }\n        catch (e) {\n            throw new DecapError(e);\n        }\n    }\n    async _generateSharedSecret(dh, kemContext) {\n        const labeledIkm = this._kdf.buildLabeledIkm(LABEL_EAE_PRK, dh);\n        const labeledInfo = this._kdf.buildLabeledInfo(LABEL_SHARED_SECRET, kemContext, this.secretSize);\n        return await this._kdf.extractAndExpand(EMPTY.buffer, labeledIkm.buffer, labeledInfo.buffer, this.secretSize);\n    }\n}\n","// The key usages for KEM.\nexport const KEM_USAGES = [\"deriveBits\"];\n// b\"dkp_prk\"\nexport const LABEL_DKP_PRK = new Uint8Array([\n    100,\n    107,\n    112,\n    95,\n    112,\n    114,\n    107,\n]);\n// b\"sk\"\nexport const LABEL_SK = new Uint8Array([115, 107]);\n","/**\n * The minimum inplementation of bignum to derive an EC key pair.\n */\nexport class Bignum {\n    constructor(size) {\n        Object.defineProperty(this, \"_num\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._num = new Uint8Array(size);\n    }\n    val() {\n        return this._num;\n    }\n    reset() {\n        this._num.fill(0);\n    }\n    set(src) {\n        if (src.length !== this._num.length) {\n            throw new Error(\"Bignum.set: invalid argument\");\n        }\n        this._num.set(src);\n    }\n    isZero() {\n        for (let i = 0; i < this._num.length; i++) {\n            if (this._num[i] !== 0) {\n                return false;\n            }\n        }\n        return true;\n    }\n    lessThan(v) {\n        if (v.length !== this._num.length) {\n            throw new Error(\"Bignum.lessThan: invalid argument\");\n        }\n        for (let i = 0; i < this._num.length; i++) {\n            if (this._num[i] < v[i]) {\n                return true;\n            }\n            if (this._num[i] > v[i]) {\n                return false;\n            }\n        }\n        return false;\n    }\n}\n","import { NativeAlgorithm } from \"../../algorithm.js\";\nimport { EMPTY } from \"../../consts.js\";\nimport { DeriveKeyPairError, DeserializeError, NotSupportedError, SerializeError, } from \"../../errors.js\";\nimport { KemId } from \"../../identifiers.js\";\nimport { KEM_USAGES, LABEL_DKP_PRK } from \"../../interfaces/dhkemPrimitives.js\";\nimport { Bignum } from \"../../utils/bignum.js\";\nimport { base64UrlToBytes, i2Osp } from \"../../utils/misc.js\";\n// b\"candidate\"\n// deno-fmt-ignore\nconst LABEL_CANDIDATE = new Uint8Array([\n    99, 97, 110, 100, 105, 100, 97, 116, 101,\n]);\n// the order of the curve being used.\n// deno-fmt-ignore\nconst ORDER_P_256 = new Uint8Array([\n    0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xbc, 0xe6, 0xfa, 0xad, 0xa7, 0x17, 0x9e, 0x84,\n    0xf3, 0xb9, 0xca, 0xc2, 0xfc, 0x63, 0x25, 0x51,\n]);\n// deno-fmt-ignore\nconst ORDER_P_384 = new Uint8Array([\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xc7, 0x63, 0x4d, 0x81, 0xf4, 0x37, 0x2d, 0xdf,\n    0x58, 0x1a, 0x0d, 0xb2, 0x48, 0xb0, 0xa7, 0x7a,\n    0xec, 0xec, 0x19, 0x6a, 0xcc, 0xc5, 0x29, 0x73,\n]);\n// deno-fmt-ignore\nconst ORDER_P_521 = new Uint8Array([\n    0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xfa, 0x51, 0x86, 0x87, 0x83, 0xbf, 0x2f,\n    0x96, 0x6b, 0x7f, 0xcc, 0x01, 0x48, 0xf7, 0x09,\n    0xa5, 0xd0, 0x3b, 0xb5, 0xc9, 0xb8, 0x89, 0x9c,\n    0x47, 0xae, 0xbb, 0x6f, 0xb7, 0x1e, 0x91, 0x38,\n    0x64, 0x09,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_256 = new Uint8Array([\n    48, 65, 2, 1, 0, 48, 19, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 8, 42, 134,\n    72, 206, 61, 3, 1, 7, 4, 39, 48, 37,\n    2, 1, 1, 4, 32,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_384 = new Uint8Array([\n    48, 78, 2, 1, 0, 48, 16, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 5, 43, 129,\n    4, 0, 34, 4, 55, 48, 53, 2, 1, 1,\n    4, 48,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_521 = new Uint8Array([\n    48, 96, 2, 1, 0, 48, 16, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 5, 43, 129,\n    4, 0, 35, 4, 73, 48, 71, 2, 1, 1,\n    4, 66,\n]);\nexport class Ec extends NativeAlgorithm {\n    constructor(kem, hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // EC specific arguments for deriving key pair.\n        Object.defineProperty(this, \"_order\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_bitmask\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._hkdf = hkdf;\n        switch (kem) {\n            case KemId.DhkemP256HkdfSha256:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-256\" };\n                this._nPk = 65;\n                this._nSk = 32;\n                this._nDh = 32;\n                this._order = ORDER_P_256;\n                this._bitmask = 0xFF;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_256;\n                break;\n            case KemId.DhkemP384HkdfSha384:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-384\" };\n                this._nPk = 97;\n                this._nSk = 48;\n                this._nDh = 48;\n                this._order = ORDER_P_384;\n                this._bitmask = 0xFF;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_384;\n                break;\n            default:\n                // case KemId.DhkemP521HkdfSha512:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-521\" };\n                this._nPk = 133;\n                this._nSk = 66;\n                this._nDh = 66;\n                this._order = ORDER_P_521;\n                this._bitmask = 0x01;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_521;\n                break;\n        }\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(this._alg, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const bn = new Bignum(this._nSk);\n            for (let counter = 0; bn.isZero() || !bn.lessThan(this._order); counter++) {\n                if (counter > 255) {\n                    throw new Error(\"Faild to derive a key pair\");\n                }\n                const bytes = new Uint8Array(await this._hkdf.labeledExpand(dkpPrk, LABEL_CANDIDATE, i2Osp(counter, 1), this._nSk));\n                bytes[0] = bytes[0] & this._bitmask;\n                bn.set(bytes);\n            }\n            const sk = await this._deserializePkcs8Key(bn.val());\n            bn.reset();\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        try {\n            await this._setup();\n            const bits = await this._api.deriveBits({\n                name: \"ECDH\",\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.crv === \"undefined\" || key.crv !== this._alg.namedCurve) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n","import { EMPTY } from \"../consts.js\";\nimport { InvalidParamError } from \"../errors.js\";\nimport { KdfId } from \"../identifiers.js\";\nimport { NativeAlgorithm } from \"../algorithm.js\";\n// b\"HPKE-v1\"\nconst HPKE_VERSION = new Uint8Array([72, 80, 75, 69, 45, 118, 49]);\nexport class HkdfNative extends NativeAlgorithm {\n    constructor() {\n        super();\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha256\n        });\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"_suiteId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: EMPTY\n        });\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-256\",\n                length: 256,\n            }\n        });\n    }\n    init(suiteId) {\n        this._suiteId = suiteId;\n    }\n    buildLabeledIkm(label, ikm) {\n        this._checkInit();\n        const ret = new Uint8Array(7 + this._suiteId.byteLength + label.byteLength + ikm.byteLength);\n        ret.set(HPKE_VERSION, 0);\n        ret.set(this._suiteId, 7);\n        ret.set(label, 7 + this._suiteId.byteLength);\n        ret.set(ikm, 7 + this._suiteId.byteLength + label.byteLength);\n        return ret;\n    }\n    buildLabeledInfo(label, info, len) {\n        this._checkInit();\n        const ret = new Uint8Array(9 + this._suiteId.byteLength + label.byteLength + info.byteLength);\n        ret.set(new Uint8Array([0, len]), 0);\n        ret.set(HPKE_VERSION, 2);\n        ret.set(this._suiteId, 9);\n        ret.set(label, 9 + this._suiteId.byteLength);\n        ret.set(info, 9 + this._suiteId.byteLength + label.byteLength);\n        return ret;\n    }\n    async extract(salt, ikm) {\n        await this._setup();\n        if (salt.byteLength === 0) {\n            salt = new ArrayBuffer(this.hashSize);\n        }\n        if (salt.byteLength !== this.hashSize) {\n            throw new InvalidParamError(\"The salt length must be the same as the hashSize\");\n        }\n        const key = await this._api.importKey(\"raw\", salt, this.algHash, false, [\n            \"sign\",\n        ]);\n        return await this._api.sign(\"HMAC\", key, ikm);\n    }\n    async expand(prk, info, len) {\n        await this._setup();\n        const key = await this._api.importKey(\"raw\", prk, this.algHash, false, [\n            \"sign\",\n        ]);\n        const okm = new ArrayBuffer(len);\n        const p = new Uint8Array(okm);\n        let prev = EMPTY;\n        const mid = new Uint8Array(info);\n        const tail = new Uint8Array(1);\n        if (len > 255 * this.hashSize) {\n            throw new Error(\"Entropy limit reached\");\n        }\n        const tmp = new Uint8Array(this.hashSize + mid.length + 1);\n        for (let i = 1, cur = 0; cur < p.length; i++) {\n            tail[0] = i;\n            tmp.set(prev, 0);\n            tmp.set(mid, prev.length);\n            tmp.set(tail, prev.length + mid.length);\n            prev = new Uint8Array(await this._api.sign(\"HMAC\", key, tmp.slice(0, prev.length + mid.length + 1)));\n            if (p.length - cur >= prev.length) {\n                p.set(prev, cur);\n                cur += prev.length;\n            }\n            else {\n                p.set(prev.slice(0, p.length - cur), cur);\n                cur += p.length - cur;\n            }\n        }\n        return okm;\n    }\n    async extractAndExpand(salt, ikm, info, len) {\n        await this._setup();\n        const baseKey = await this._api.importKey(\"raw\", ikm, \"HKDF\", false, [\"deriveBits\"]);\n        return await this._api.deriveBits({\n            name: \"HKDF\",\n            hash: this.algHash.hash,\n            salt: salt,\n            info: info,\n        }, baseKey, len * 8);\n    }\n    async labeledExtract(salt, label, ikm) {\n        return await this.extract(salt, this.buildLabeledIkm(label, ikm).buffer);\n    }\n    async labeledExpand(prk, label, info, len) {\n        return await this.expand(prk, this.buildLabeledInfo(label, info, len).buffer, len);\n    }\n    _checkInit() {\n        if (this._suiteId === EMPTY) {\n            throw new Error(\"Not initialized. Call init()\");\n        }\n    }\n}\nexport class HkdfSha256Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha256 (0x0001) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha256\n        });\n        /** 32 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-256\",\n                length: 256,\n            }\n        });\n    }\n}\nexport class HkdfSha384Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha384 (0x0002) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha384\n        });\n        /** 48 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-384\",\n                length: 384,\n            }\n        });\n    }\n}\nexport class HkdfSha512Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha512 (0x0003) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha512\n        });\n        /** 64 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-512\",\n                length: 512,\n            }\n        });\n    }\n}\n","// The key usages for AEAD.\nexport const AEAD_USAGES = [\"encrypt\", \"decrypt\"];\n","/**\n * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).\n *\n * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)\n *\n * The original file is located at:\n * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/abstract/montgomery.ts\n */\n/**\n * Montgomery curve methods. It's not really whole montgomery curve,\n * just bunch of very specific methods for X25519 / X448 from\n * [RFC 7748](https://www.rfc-editor.org/rfc/rfc7748)\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { abytes, aInRange, bytesToNumberLE, copyBytes, numberToBytesLE, randomBytesAsync, validateObject, } from \"../utils/noble.js\";\nimport { createKeygen } from \"./curve.js\";\nimport { mod } from \"./modular.js\";\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nfunction validateOpts(curve) {\n    validateObject(curve, {\n        adjustScalarBytes: \"function\",\n        powPminus2: \"function\",\n    });\n    return Object.freeze({ ...curve });\n}\nexport function montgomery(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { P, type, adjustScalarBytes, powPminus2, randomBytes: rand } = CURVE;\n    const is25519 = type === \"x25519\";\n    if (!is25519 && type !== \"x448\")\n        throw new Error(\"invalid type\");\n    const randomBytes_ = rand || randomBytesAsync;\n    const montgomeryBits = is25519 ? 255 : 448;\n    const fieldLen = is25519 ? 32 : 56;\n    const Gu = is25519 ? BigInt(9) : BigInt(5);\n    // RFC 7748 #5:\n    // The constant a24 is (486662 - 2) / 4 = 121665 for curve25519/X25519 and\n    // (156326 - 2) / 4 = 39081 for curve448/X448\n    // const a = is25519 ? 156326n : 486662n;\n    const a24 = is25519 ? BigInt(121665) : BigInt(39081);\n    // RFC: x25519 \"the resulting integer is of the form 2^254 plus\n    // eight times a value between 0 and 2^251 - 1 (inclusive)\"\n    // x448: \"2^447 plus four times a value between 0 and 2^445 - 1 (inclusive)\"\n    const minScalar = is25519 ? _2n ** BigInt(254) : _2n ** BigInt(447);\n    const maxAdded = is25519\n        ? BigInt(8) * _2n ** BigInt(251) - _1n\n        : BigInt(4) * _2n ** BigInt(445) - _1n;\n    const maxScalar = minScalar + maxAdded + _1n; // (inclusive)\n    const modP = (n) => mod(n, P);\n    const GuBytes = encodeU(Gu);\n    function encodeU(u) {\n        return numberToBytesLE(modP(u), fieldLen);\n    }\n    function decodeU(u) {\n        const _u = copyBytes(abytes(u, fieldLen, \"uCoordinate\"));\n        // RFC: When receiving such an array, implementations of X25519\n        // (but not X448) MUST mask the most significant bit in the final byte.\n        if (is25519)\n            _u[31] &= 127; // 0b0111_1111\n        // RFC: Implementations MUST accept non-canonical values and process them as\n        // if they had been reduced modulo the field prime.  The non-canonical\n        // values are 2^255 - 19 through 2^255 - 1 for X25519 and 2^448 - 2^224\n        // - 1 through 2^448 - 1 for X448.\n        return modP(bytesToNumberLE(_u));\n    }\n    function decodeScalar(scalar) {\n        return bytesToNumberLE(adjustScalarBytes(copyBytes(abytes(scalar, fieldLen, \"scalar\"))));\n    }\n    function scalarMult(scalar, u) {\n        const pu = montgomeryLadder(decodeU(u), decodeScalar(scalar));\n        // Some public keys are useless, of low-order. Curve author doesn't think\n        // it needs to be validated, but we do it nonetheless.\n        // https://cr.yp.to/ecdh.html#validate\n        if (pu === _0n)\n            throw new Error(\"invalid private or public key received\");\n        return encodeU(pu);\n    }\n    // Computes public key from private. By doing scalar multiplication of base point.\n    function scalarMultBase(scalar) {\n        return scalarMult(scalar, GuBytes);\n    }\n    const getPublicKey = scalarMultBase;\n    const getSharedSecret = scalarMult;\n    // cswap from RFC7748 \"example code\"\n    function cswap(swap, x_2, x_3) {\n        // dummy = mask(swap) AND (x_2 XOR x_3)\n        // Where mask(swap) is the all-1 or all-0 word of the same length as x_2\n        // and x_3, computed, e.g., as mask(swap) = 0 - swap.\n        const dummy = modP(swap * (x_2 - x_3));\n        x_2 = modP(x_2 - dummy); // x_2 = x_2 XOR dummy\n        x_3 = modP(x_3 + dummy); // x_3 = x_3 XOR dummy\n        return { x_2, x_3 };\n    }\n    /**\n     * Montgomery x-only multiplication ladder.\n     * @param pointU u coordinate (x) on Montgomery Curve 25519\n     * @param scalar by which the point would be multiplied\n     * @returns new Point on Montgomery curve\n     */\n    function montgomeryLadder(u, scalar) {\n        aInRange(\"u\", u, _0n, P);\n        aInRange(\"scalar\", scalar, minScalar, maxScalar);\n        const k = scalar;\n        const x_1 = u;\n        let x_2 = _1n;\n        let z_2 = _0n;\n        let x_3 = u;\n        let z_3 = _1n;\n        let swap = _0n;\n        for (let t = BigInt(montgomeryBits - 1); t >= _0n; t--) {\n            const k_t = (k >> t) & _1n;\n            swap ^= k_t;\n            ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n            ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n            swap = k_t;\n            const A = x_2 + z_2;\n            const AA = modP(A * A);\n            const B = x_2 - z_2;\n            const BB = modP(B * B);\n            const E = AA - BB;\n            const C = x_3 + z_3;\n            const D = x_3 - z_3;\n            const DA = modP(D * A);\n            const CB = modP(C * B);\n            const dacb = DA + CB;\n            const da_cb = DA - CB;\n            x_3 = modP(dacb * dacb);\n            z_3 = modP(x_1 * modP(da_cb * da_cb));\n            x_2 = modP(AA * BB);\n            z_2 = modP(E * (AA + modP(a24 * E)));\n        }\n        ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n        ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n        const z2 = powPminus2(z_2); // `Fp.pow(x, P - _2n)` is much slower equivalent\n        return modP(x_2 * z2); // Return x_2 * (z_2^(p - 2))\n    }\n    const lengths = {\n        secretKey: fieldLen,\n        publicKey: fieldLen,\n        seed: fieldLen,\n    };\n    const randomSecretKey = async (seed) => {\n        if (seed === undefined) {\n            seed = await randomBytes_(fieldLen);\n        }\n        abytes(seed, lengths.seed, \"seed\");\n        return seed;\n    };\n    const utils = { randomSecretKey };\n    return Object.freeze({\n        keygen: createKeygen(randomSecretKey, getPublicKey),\n        getSharedSecret,\n        getPublicKey,\n        scalarMult,\n        scalarMultBase,\n        utils,\n        GuBytes: GuBytes.slice(),\n        lengths,\n    });\n}\n","import { AEAD_USAGES, AeadId, NativeAlgorithm } from \"@hpke/common\";\nexport class AesGcmContext extends NativeAlgorithm {\n    constructor(key) {\n        super();\n        Object.defineProperty(this, \"_rawKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_key\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n        this._rawKey = key;\n    }\n    async seal(iv, data, aad) {\n        await this._setupKey();\n        const alg = {\n            name: \"AES-GCM\",\n            iv: iv,\n            additionalData: aad,\n        };\n        const ct = await this._api.encrypt(alg, this._key, data);\n        return ct;\n    }\n    async open(iv, data, aad) {\n        await this._setupKey();\n        const alg = {\n            name: \"AES-GCM\",\n            iv: iv,\n            additionalData: aad,\n        };\n        const pt = await this._api.decrypt(alg, this._key, data);\n        return pt;\n    }\n    async _setupKey() {\n        if (this._key !== undefined) {\n            return;\n        }\n        await this._setup();\n        const key = await this._importKey(this._rawKey);\n        (new Uint8Array(this._rawKey)).fill(0);\n        this._key = key;\n        return;\n    }\n    async _importKey(key) {\n        return await this._api.importKey(\"raw\", key, { name: \"AES-GCM\" }, true, AEAD_USAGES);\n    }\n}\n/**\n * The AES-128-GCM for HPKE AEAD implementing {@link AeadInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `aead` parameter of {@link CipherSuiteParams} instead of `AeadId.Aes128Gcm`.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class Aes128Gcm {\n    constructor() {\n        /** AeadId.Aes128Gcm (0x0001) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: AeadId.Aes128Gcm\n        });\n        /** 16 */\n        Object.defineProperty(this, \"keySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n        /** 12 */\n        Object.defineProperty(this, \"nonceSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 12\n        });\n        /** 16 */\n        Object.defineProperty(this, \"tagSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n    }\n    createEncryptionContext(key) {\n        return new AesGcmContext(key);\n    }\n}\n/**\n * The AES-256-GCM for HPKE AEAD implementing {@link AeadInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `aead` parameter of {@link CipherSuiteParams} instead of `AeadId.Aes256Gcm`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class Aes256Gcm extends Aes128Gcm {\n    constructor() {\n        super(...arguments);\n        /** AeadId.Aes256Gcm (0x0002) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: AeadId.Aes256Gcm\n        });\n        /** 32 */\n        Object.defineProperty(this, \"keySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** 12 */\n        Object.defineProperty(this, \"nonceSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 12\n        });\n        /** 16 */\n        Object.defineProperty(this, \"tagSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n    }\n}\n","import { NotSupportedError } from \"@hpke/common\";\nexport function emitNotSupported() {\n    return new Promise((_resolve, reject) => {\n        reject(new NotSupportedError(\"Not supported\"));\n    });\n}\n","import { ExportError, INPUT_LENGTH_LIMIT, InvalidParamError, } from \"@hpke/common\";\nimport { emitNotSupported } from \"./utils/emitNotSupported.js\";\n// b\"sec\"\nconst LABEL_SEC = new Uint8Array([115, 101, 99]);\nexport class ExporterContextImpl {\n    constructor(api, kdf, exporterSecret) {\n        Object.defineProperty(this, \"_api\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"exporterSecret\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._api = api;\n        this._kdf = kdf;\n        this.exporterSecret = exporterSecret;\n    }\n    async seal(_data, _aad) {\n        return await emitNotSupported();\n    }\n    async open(_data, _aad) {\n        return await emitNotSupported();\n    }\n    async export(exporterContext, len) {\n        if (exporterContext.byteLength > INPUT_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long exporter context\");\n        }\n        try {\n            return await this._kdf.labeledExpand(this.exporterSecret, LABEL_SEC, new Uint8Array(exporterContext), len);\n        }\n        catch (e) {\n            throw new ExportError(e);\n        }\n    }\n}\nexport class RecipientExporterContextImpl extends ExporterContextImpl {\n}\nexport class SenderExporterContextImpl extends ExporterContextImpl {\n    constructor(api, kdf, exporterSecret, enc) {\n        super(api, kdf, exporterSecret);\n        Object.defineProperty(this, \"enc\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.enc = enc;\n        return;\n    }\n}\n","import { i2Osp, MessageLimitReachedError, xor } from \"@hpke/common\";\nimport { ExporterContextImpl } from \"./exporterContext.js\";\nexport class EncryptionContextImpl extends ExporterContextImpl {\n    constructor(api, kdf, params) {\n        super(api, kdf, params.exporterSecret);\n        // AEAD id.\n        Object.defineProperty(this, \"_aead\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of a key for the algorithm.\n        Object.defineProperty(this, \"_nK\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of a nonce for the algorithm.\n        Object.defineProperty(this, \"_nN\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of an authentication tag for the algorithm.\n        Object.defineProperty(this, \"_nT\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The end-to-end encryption key information.\n        Object.defineProperty(this, \"_ctx\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        if (params.key === undefined || params.baseNonce === undefined ||\n            params.seq === undefined) {\n            throw new Error(\"Required parameters are missing\");\n        }\n        this._aead = params.aead;\n        this._nK = this._aead.keySize;\n        this._nN = this._aead.nonceSize;\n        this._nT = this._aead.tagSize;\n        const key = this._aead.createEncryptionContext(params.key);\n        this._ctx = {\n            key: key,\n            baseNonce: params.baseNonce,\n            seq: params.seq,\n        };\n    }\n    computeNonce(k) {\n        const seqBytes = i2Osp(k.seq, k.baseNonce.byteLength);\n        return xor(k.baseNonce, seqBytes).buffer;\n    }\n    incrementSeq(k) {\n        // if (this.seq >= (1 << (8 * this.baseNonce.byteLength)) - 1) {\n        if (k.seq > Number.MAX_SAFE_INTEGER) {\n            throw new MessageLimitReachedError(\"Message limit reached\");\n        }\n        k.seq += 1;\n        return;\n    }\n}\n","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _Mutex_locked;\nexport class Mutex {\n    constructor() {\n        _Mutex_locked.set(this, Promise.resolve());\n    }\n    async lock() {\n        let releaseLock;\n        const nextLock = new Promise((resolve) => {\n            releaseLock = resolve;\n        });\n        const previousLock = __classPrivateFieldGet(this, _Mutex_locked, \"f\");\n        __classPrivateFieldSet(this, _Mutex_locked, nextLock, \"f\");\n        await previousLock;\n        return releaseLock;\n    }\n}\n_Mutex_locked = new WeakMap();\n","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _RecipientContextImpl_mutex;\nimport { EMPTY, OpenError } from \"@hpke/common\";\nimport { EncryptionContextImpl } from \"./encryptionContext.js\";\nimport { Mutex } from \"./mutex.js\";\nexport class RecipientContextImpl extends EncryptionContextImpl {\n    constructor() {\n        super(...arguments);\n        _RecipientContextImpl_mutex.set(this, void 0);\n    }\n    async open(data, aad = EMPTY.buffer) {\n        __classPrivateFieldSet(this, _RecipientContextImpl_mutex, __classPrivateFieldGet(this, _RecipientContextImpl_mutex, \"f\") ?? new Mutex(), \"f\");\n        const release = await __classPrivateFieldGet(this, _RecipientContextImpl_mutex, \"f\").lock();\n        let pt;\n        try {\n            pt = await this._ctx.key.open(this.computeNonce(this._ctx), data, aad);\n        }\n        catch (e) {\n            throw new OpenError(e);\n        }\n        finally {\n            release();\n        }\n        this.incrementSeq(this._ctx);\n        return pt;\n    }\n}\n_RecipientContextImpl_mutex = new WeakMap();\n","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _SenderContextImpl_mutex;\nimport { EMPTY, SealError } from \"@hpke/common\";\nimport { EncryptionContextImpl } from \"./encryptionContext.js\";\nimport { Mutex } from \"./mutex.js\";\nexport class SenderContextImpl extends EncryptionContextImpl {\n    constructor(api, kdf, params, enc) {\n        super(api, kdf, params);\n        Object.defineProperty(this, \"enc\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        _SenderContextImpl_mutex.set(this, void 0);\n        this.enc = enc;\n    }\n    async seal(data, aad = EMPTY.buffer) {\n        __classPrivateFieldSet(this, _SenderContextImpl_mutex, __classPrivateFieldGet(this, _SenderContextImpl_mutex, \"f\") ?? new Mutex(), \"f\");\n        const release = await __classPrivateFieldGet(this, _SenderContextImpl_mutex, \"f\").lock();\n        let ct;\n        try {\n            ct = await this._ctx.key.seal(this.computeNonce(this._ctx), data, aad);\n        }\n        catch (e) {\n            throw new SealError(e);\n        }\n        finally {\n            release();\n        }\n        this.incrementSeq(this._ctx);\n        return ct;\n    }\n}\n_SenderContextImpl_mutex = new WeakMap();\n","import { AeadId, EMPTY, i2Osp, INFO_LENGTH_LIMIT, INPUT_LENGTH_LIMIT, InvalidParamError, MINIMUM_PSK_LENGTH, Mode, NativeAlgorithm, } from \"@hpke/common\";\nimport { RecipientExporterContextImpl, SenderExporterContextImpl, } from \"./exporterContext.js\";\nimport { RecipientContextImpl } from \"./recipientContext.js\";\nimport { SenderContextImpl } from \"./senderContext.js\";\n// b\"base_nonce\"\n// deno-fmt-ignore\nconst LABEL_BASE_NONCE = new Uint8Array([\n    98, 97, 115, 101, 95, 110, 111, 110, 99, 101,\n]);\n// b\"exp\"\nconst LABEL_EXP = new Uint8Array([101, 120, 112]);\n// b\"info_hash\"\n// deno-fmt-ignore\nconst LABEL_INFO_HASH = new Uint8Array([\n    105, 110, 102, 111, 95, 104, 97, 115, 104,\n]);\n// b\"key\"\nconst LABEL_KEY = new Uint8Array([107, 101, 121]);\n// b\"psk_id_hash\"\n// deno-fmt-ignore\nconst LABEL_PSK_ID_HASH = new Uint8Array([\n    112, 115, 107, 95, 105, 100, 95, 104, 97, 115, 104,\n]);\n// b\"secret\"\nconst LABEL_SECRET = new Uint8Array([115, 101, 99, 114, 101, 116]);\n// b\"HPKE\"\n// deno-fmt-ignore\nconst SUITE_ID_HEADER_HPKE = new Uint8Array([\n    72, 80, 75, 69, 0, 0, 0, 0, 0, 0,\n]);\n/**\n * The Hybrid Public Key Encryption (HPKE) ciphersuite,\n * which is implemented using only\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n *\n * This is the super class of {@link CipherSuite} and the same as\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuite | @hpke/core#CipherSuite} as follows:\n * which supports only the ciphersuites that can be implemented on the native\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n * Therefore, the following cryptographic algorithms are not supported for now:\n *   - DHKEM(X25519, HKDF-SHA256)\n *   - DHKEM(X448, HKDF-SHA512)\n *   - ChaCha20Poly1305\n *\n * In addtion, the HKDF functions contained in this class can only derive\n * keys of the same length as the `hashSize`.\n *\n * If you want to use the unsupported cryptographic algorithms\n * above or derive keys longer than the `hashSize`,\n * please use {@link CipherSuite}.\n *\n * This class provides following functions:\n *\n * - Creates encryption contexts both for senders and recipients.\n *   - {@link createSenderContext}\n *   - {@link createRecipientContext}\n * - Provides single-shot encryption API.\n *   - {@link seal}\n *   - {@link open}\n *\n * The calling of the constructor of this class is the starting\n * point for HPKE operations for both senders and recipients.\n *\n * @example Use only ciphersuites supported by Web Cryptography API.\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n *   CipherSuite,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n *\n * @example Use a ciphersuite which is currently not supported by Web Cryptography API.\n *\n * ```ts\n * import { Aes128Gcm, HkdfSha256, CipherSuite } from \"@hpke/core\";\n * // Use an extension module.\n * import { DhkemX25519HkdfSha256 } from \"@hpke/dhkem-x25519\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemX25519HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class CipherSuiteNative extends NativeAlgorithm {\n    /**\n     * @param params A set of parameters for building a cipher suite.\n     *\n     * If the error occurred, throws {@link InvalidParamError}.\n     *\n     * @throws {@link InvalidParamError}\n     */\n    constructor(params) {\n        super();\n        Object.defineProperty(this, \"_kem\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_aead\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_suiteId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // KEM\n        if (typeof params.kem === \"number\") {\n            throw new InvalidParamError(\"KemId cannot be used\");\n        }\n        this._kem = params.kem;\n        // KDF\n        if (typeof params.kdf === \"number\") {\n            throw new InvalidParamError(\"KdfId cannot be used\");\n        }\n        this._kdf = params.kdf;\n        // AEAD\n        if (typeof params.aead === \"number\") {\n            throw new InvalidParamError(\"AeadId cannot be used\");\n        }\n        this._aead = params.aead;\n        this._suiteId = new Uint8Array(SUITE_ID_HEADER_HPKE);\n        this._suiteId.set(i2Osp(this._kem.id, 2), 4);\n        this._suiteId.set(i2Osp(this._kdf.id, 2), 6);\n        this._suiteId.set(i2Osp(this._aead.id, 2), 8);\n        this._kdf.init(this._suiteId);\n    }\n    /**\n     * Gets the KEM context of the ciphersuite.\n     */\n    get kem() {\n        return this._kem;\n    }\n    /**\n     * Gets the KDF context of the ciphersuite.\n     */\n    get kdf() {\n        return this._kdf;\n    }\n    /**\n     * Gets the AEAD context of the ciphersuite.\n     */\n    get aead() {\n        return this._aead;\n    }\n    /**\n     * Creates an encryption context for a sender.\n     *\n     * If the error occurred, throws {@link DecapError} | {@link ValidationError}.\n     *\n     * @param params A set of parameters for the sender encryption context.\n     * @returns A sender encryption context.\n     * @throws {@link EncapError}, {@link ValidationError}\n     */\n    async createSenderContext(params) {\n        this._validateInputLength(params);\n        await this._setup();\n        const dh = await this._kem.encap(params);\n        let mode;\n        if (params.psk !== undefined) {\n            mode = params.senderKey !== undefined ? Mode.AuthPsk : Mode.Psk;\n        }\n        else {\n            mode = params.senderKey !== undefined ? Mode.Auth : Mode.Base;\n        }\n        return await this._keyScheduleS(mode, dh.sharedSecret, dh.enc, params);\n    }\n    /**\n     * Creates an encryption context for a recipient.\n     *\n     * If the error occurred, throws {@link DecapError}\n     * | {@link DeserializeError} | {@link ValidationError}.\n     *\n     * @param params A set of parameters for the recipient encryption context.\n     * @returns A recipient encryption context.\n     * @throws {@link DecapError}, {@link DeserializeError}, {@link ValidationError}\n     */\n    async createRecipientContext(params) {\n        this._validateInputLength(params);\n        await this._setup();\n        const sharedSecret = await this._kem.decap(params);\n        let mode;\n        if (params.psk !== undefined) {\n            mode = params.senderPublicKey !== undefined ? Mode.AuthPsk : Mode.Psk;\n        }\n        else {\n            mode = params.senderPublicKey !== undefined ? Mode.Auth : Mode.Base;\n        }\n        return await this._keyScheduleR(mode, sharedSecret, params);\n    }\n    /**\n     * Encrypts a message to a recipient.\n     *\n     * If the error occurred, throws `EncapError` | `MessageLimitReachedError` | `SealError` | `ValidationError`.\n     *\n     * @param params A set of parameters for building a sender encryption context.\n     * @param pt A plain text as bytes to be encrypted.\n     * @param aad Additional authenticated data as bytes fed by an application.\n     * @returns A cipher text and an encapsulated key as bytes.\n     * @throws {@link EncapError}, {@link MessageLimitReachedError}, {@link SealError}, {@link ValidationError}\n     */\n    async seal(params, pt, aad = EMPTY.buffer) {\n        const ctx = await this.createSenderContext(params);\n        return {\n            ct: await ctx.seal(pt, aad),\n            enc: ctx.enc,\n        };\n    }\n    /**\n     * Decrypts a message from a sender.\n     *\n     * If the error occurred, throws `DecapError` | `DeserializeError` | `OpenError` | `ValidationError`.\n     *\n     * @param params A set of parameters for building a recipient encryption context.\n     * @param ct An encrypted text as bytes to be decrypted.\n     * @param aad Additional authenticated data as bytes fed by an application.\n     * @returns A decrypted plain text as bytes.\n     * @throws {@link DecapError}, {@link DeserializeError}, {@link OpenError}, {@link ValidationError}\n     */\n    async open(params, ct, aad = EMPTY.buffer) {\n        const ctx = await this.createRecipientContext(params);\n        return await ctx.open(ct, aad);\n    }\n    // private verifyPskInputs(mode: Mode, params: KeyScheduleParams) {\n    //   const gotPsk = (params.psk !== undefined);\n    //   const gotPskId = (params.psk !== undefined && params.psk.id.byteLength > 0);\n    //   if (gotPsk !== gotPskId) {\n    //     throw new Error('Inconsistent PSK inputs');\n    //   }\n    //   if (gotPsk && (mode === Mode.Base || mode === Mode.Auth)) {\n    //     throw new Error('PSK input provided when not needed');\n    //   }\n    //   if (!gotPsk && (mode === Mode.Psk || mode === Mode.AuthPsk)) {\n    //     throw new Error('Missing required PSK input');\n    //   }\n    //   return;\n    // }\n    async _keySchedule(mode, sharedSecret, params) {\n        // Currently, there is no point in executing this function\n        // because this hpke library does not allow users to explicitly specify the mode.\n        //\n        // this.verifyPskInputs(mode, params);\n        const pskId = params.psk === undefined\n            ? EMPTY\n            : new Uint8Array(params.psk.id);\n        const pskIdHash = await this._kdf.labeledExtract(EMPTY.buffer, LABEL_PSK_ID_HASH, pskId);\n        const info = params.info === undefined\n            ? EMPTY\n            : new Uint8Array(params.info);\n        const infoHash = await this._kdf.labeledExtract(EMPTY.buffer, LABEL_INFO_HASH, info);\n        const keyScheduleContext = new Uint8Array(1 + pskIdHash.byteLength + infoHash.byteLength);\n        keyScheduleContext.set(new Uint8Array([mode]), 0);\n        keyScheduleContext.set(new Uint8Array(pskIdHash), 1);\n        keyScheduleContext.set(new Uint8Array(infoHash), 1 + pskIdHash.byteLength);\n        const psk = params.psk === undefined\n            ? EMPTY\n            : new Uint8Array(params.psk.key);\n        const ikm = this._kdf.buildLabeledIkm(LABEL_SECRET, psk)\n            .buffer;\n        const exporterSecretInfo = this._kdf.buildLabeledInfo(LABEL_EXP, keyScheduleContext, this._kdf.hashSize).buffer;\n        const exporterSecret = await this._kdf.extractAndExpand(sharedSecret, ikm, exporterSecretInfo, this._kdf.hashSize);\n        if (this._aead.id === AeadId.ExportOnly) {\n            return { aead: this._aead, exporterSecret: exporterSecret };\n        }\n        const keyInfo = this._kdf.buildLabeledInfo(LABEL_KEY, keyScheduleContext, this._aead.keySize).buffer;\n        const key = await this._kdf.extractAndExpand(sharedSecret, ikm, keyInfo, this._aead.keySize);\n        const baseNonceInfo = this._kdf.buildLabeledInfo(LABEL_BASE_NONCE, keyScheduleContext, this._aead.nonceSize).buffer;\n        const baseNonce = await this._kdf.extractAndExpand(sharedSecret, ikm, baseNonceInfo, this._aead.nonceSize);\n        return {\n            aead: this._aead,\n            exporterSecret: exporterSecret,\n            key: key,\n            baseNonce: new Uint8Array(baseNonce),\n            seq: 0,\n        };\n    }\n    async _keyScheduleS(mode, sharedSecret, enc, params) {\n        const res = await this._keySchedule(mode, sharedSecret, params);\n        if (res.key === undefined) {\n            return new SenderExporterContextImpl(this._api, this._kdf, res.exporterSecret, enc);\n        }\n        return new SenderContextImpl(this._api, this._kdf, res, enc);\n    }\n    async _keyScheduleR(mode, sharedSecret, params) {\n        const res = await this._keySchedule(mode, sharedSecret, params);\n        if (res.key === undefined) {\n            return new RecipientExporterContextImpl(this._api, this._kdf, res.exporterSecret);\n        }\n        return new RecipientContextImpl(this._api, this._kdf, res);\n    }\n    _validateInputLength(params) {\n        if (params.info !== undefined &&\n            params.info.byteLength > INFO_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long info\");\n        }\n        if (params.psk !== undefined) {\n            if (params.psk.key.byteLength < MINIMUM_PSK_LENGTH) {\n                throw new InvalidParamError(`PSK must have at least ${MINIMUM_PSK_LENGTH} bytes`);\n            }\n            if (params.psk.key.byteLength > INPUT_LENGTH_LIMIT) {\n                throw new InvalidParamError(\"Too long psk.key\");\n            }\n            if (params.psk.id.byteLength > INPUT_LENGTH_LIMIT) {\n                throw new InvalidParamError(\"Too long psk.id\");\n            }\n        }\n        return;\n    }\n}\n","import { Dhkem, Ec, HkdfSha256Native, HkdfSha384Native, HkdfSha512Native, KemId, } from \"@hpke/common\";\nexport class DhkemP256HkdfSha256Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha256Native();\n        const prim = new Ec(KemId.DhkemP256HkdfSha256, kdf);\n        super(KemId.DhkemP256HkdfSha256, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP256HkdfSha256\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 65\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 65\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n    }\n}\nexport class DhkemP384HkdfSha384Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha384Native();\n        const prim = new Ec(KemId.DhkemP384HkdfSha384, kdf);\n        super(KemId.DhkemP384HkdfSha384, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP384HkdfSha384\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 97\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 97\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n    }\n}\nexport class DhkemP521HkdfSha512Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha512Native();\n        const prim = new Ec(KemId.DhkemP521HkdfSha512, kdf);\n        super(KemId.DhkemP521HkdfSha512, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP521HkdfSha512\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 133\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 133\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n    }\n}\n","import { HkdfSha256Native, HkdfSha384Native, HkdfSha512Native, } from \"@hpke/common\";\nimport { CipherSuiteNative } from \"./cipherSuiteNative.js\";\nimport { DhkemP256HkdfSha256Native, DhkemP384HkdfSha384Native, DhkemP521HkdfSha512Native, } from \"./kems/dhkemNative.js\";\n/**\n * The Hybrid Public Key Encryption (HPKE) ciphersuite,\n * which is implemented using only\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n *\n * This class is the same as\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuiteNative | @hpke/core#CipherSuiteNative} as follows:\n * which supports only the ciphersuites that can be implemented on the native\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n * Therefore, the following cryptographic algorithms are not supported for now:\n * - `DHKEM(X25519, HKDF-SHA256)`\n * - `DHKEM(X448, HKDF-SHA512)`\n * - `ChaCha20Poly1305`\n *\n * In addtion, the HKDF functions contained in this `CipherSuiteNative`\n * class can only derive keys of the same length as the `hashSize`.\n *\n * If you want to use the unsupported cryptographic algorithms\n * above or derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * This class provides following functions:\n *\n * - Creates encryption contexts both for senders and recipients.\n *     - {@link createSenderContext}\n *     - {@link createRecipientContext}\n * - Provides single-shot encryption API.\n *     - {@link seal}\n *     - {@link open}\n *\n * The calling of the constructor of this class is the starting\n * point for HPKE operations for both senders and recipients.\n *\n * @example Use only ciphersuites supported by Web Cryptography API.\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n *   CipherSuite,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n *\n * @example Use a ciphersuite which is currently not supported by Web Cryptography API.\n *\n * ```ts\n * import { Aes128Gcm, HkdfSha256, CipherSuite } from \"@hpke/core\";\n * import { DhkemX25519HkdfSha256 } from \"@hpke/dhkem-x25519\";\n * const suite = new CipherSuite({\n *   kem: new DhkemX25519HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class CipherSuite extends CipherSuiteNative {\n}\n/**\n * The DHKEM(P-256, HKDF-SHA256) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP256HkdfSha256`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class DhkemP256HkdfSha256 extends DhkemP256HkdfSha256Native {\n}\n/**\n * The DHKEM(P-384, HKDF-SHA384) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP384HkdfSha384`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP384HkdfSha384,\n *   HkdfSha384,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP384HkdfSha384(),\n *   kdf: new HkdfSha384(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class DhkemP384HkdfSha384 extends DhkemP384HkdfSha384Native {\n}\n/**\n * The DHKEM(P-521, HKDF-SHA512) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP521HkdfSha512`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP521HkdfSha512,\n *   HkdfSha512,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP521HkdfSha512(),\n *   kdf: new HkdfSha512(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class DhkemP521HkdfSha512 extends DhkemP521HkdfSha512Native {\n}\n/**\n * The HKDF-SHA256 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha256`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class HkdfSha256 extends HkdfSha256Native {\n}\n/**\n * The HKDF-SHA384 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha384`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP384HkdfSha384,\n *   HkdfSha384,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP384HkdfSha384(),\n *   kdf: new HkdfSha384(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class HkdfSha384 extends HkdfSha384Native {\n}\n/**\n * The HKDF-SHA512 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha512`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP521HkdfSha512,\n *   HkdfSha512,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP521HkdfSha512(),\n *   kdf: new HkdfSha512(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class HkdfSha512 extends HkdfSha512Native {\n}\n","import { base64UrlToBytes, DeriveKeyPairError, DeserializeError, EMPTY, KEM_USAGES, LABEL_DKP_PRK, LABEL_SK, NativeAlgorithm, NotSupportedError, SerializeError, } from \"@hpke/common\";\nconst ALG_NAME = \"X25519\";\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_X25519 = new Uint8Array([\n    0x30, 0x2e, 0x02, 0x01, 0x00, 0x30, 0x05, 0x06,\n    0x03, 0x2b, 0x65, 0x6e, 0x04, 0x22, 0x04, 0x20,\n]);\nexport class X25519 extends NativeAlgorithm {\n    constructor(hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._alg = { name: ALG_NAME };\n        this._hkdf = hkdf;\n        this._nPk = 32;\n        this._nSk = 32;\n        this._nDh = 32;\n        this._pkcs8AlgId = PKCS8_ALG_ID_X25519;\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(ALG_NAME, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const rawSk = await this._hkdf.labeledExpand(dkpPrk, LABEL_SK, EMPTY, this._nSk);\n            const rawSkBytes = new Uint8Array(rawSk);\n            const sk = await this._deserializePkcs8Key(rawSkBytes);\n            rawSkBytes.fill(0);\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        await this._setup();\n        try {\n            const bits = await this._api.deriveBits({\n                name: ALG_NAME,\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.kty === \"undefined\" || key.kty !== \"OKP\") {\n            throw new Error(`Invalid kty: ${key.crv}`);\n        }\n        if (typeof key.crv === \"undefined\" || key.crv !== ALG_NAME) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n","import { base64UrlToBytes, DeriveKeyPairError, DeserializeError, EMPTY, KEM_USAGES, LABEL_DKP_PRK, LABEL_SK, NativeAlgorithm, NotSupportedError, SerializeError, } from \"@hpke/common\";\nconst ALG_NAME = \"X448\";\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_X448 = new Uint8Array([\n    0x30, 0x46, 0x02, 0x01, 0x00, 0x30, 0x05, 0x06,\n    0x03, 0x2b, 0x65, 0x6f, 0x04, 0x3a, 0x04, 0x38,\n]);\nexport class X448 extends NativeAlgorithm {\n    constructor(hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._alg = { name: ALG_NAME };\n        this._hkdf = hkdf;\n        this._nPk = 56;\n        this._nSk = 56;\n        this._nDh = 56;\n        this._pkcs8AlgId = PKCS8_ALG_ID_X448;\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(ALG_NAME, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const rawSk = await this._hkdf.labeledExpand(dkpPrk, LABEL_SK, EMPTY, this._nSk);\n            const rawSkBytes = new Uint8Array(rawSk);\n            const sk = await this._deserializePkcs8Key(rawSkBytes);\n            rawSkBytes.fill(0);\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        await this._setup();\n        try {\n            const bits = await this._api.deriveBits({\n                name: ALG_NAME,\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.kty === \"undefined\" || key.kty !== \"OKP\") {\n            throw new Error(`Invalid kty: ${key.crv}`);\n        }\n        if (typeof key.crv === \"undefined\" || key.crv !== ALG_NAME) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bech32m = exports.bech32 = void 0;\nconst ALPHABET = 'qpzry9x8gf2tvdw0s3jn54khce6mua7l';\nconst ALPHABET_MAP = {};\nfor (let z = 0; z < ALPHABET.length; z++) {\n    const x = ALPHABET.charAt(z);\n    ALPHABET_MAP[x] = z;\n}\nfunction polymodStep(pre) {\n    const b = pre >> 25;\n    return (((pre & 0x1ffffff) << 5) ^\n        (-((b >> 0) & 1) & 0x3b6a57b2) ^\n        (-((b >> 1) & 1) & 0x26508e6d) ^\n        (-((b >> 2) & 1) & 0x1ea119fa) ^\n        (-((b >> 3) & 1) & 0x3d4233dd) ^\n        (-((b >> 4) & 1) & 0x2a1462b3));\n}\nfunction prefixChk(prefix) {\n    let chk = 1;\n    for (let i = 0; i < prefix.length; ++i) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            return 'Invalid prefix (' + prefix + ')';\n        chk = polymodStep(chk) ^ (c >> 5);\n    }\n    chk = polymodStep(chk);\n    for (let i = 0; i < prefix.length; ++i) {\n        const v = prefix.charCodeAt(i);\n        chk = polymodStep(chk) ^ (v & 0x1f);\n    }\n    return chk;\n}\nfunction convert(data, inBits, outBits, pad) {\n    let value = 0;\n    let bits = 0;\n    const maxV = (1 << outBits) - 1;\n    const result = [];\n    for (let i = 0; i < data.length; ++i) {\n        value = (value << inBits) | data[i];\n        bits += inBits;\n        while (bits >= outBits) {\n            bits -= outBits;\n            result.push((value >> bits) & maxV);\n        }\n    }\n    if (pad) {\n        if (bits > 0) {\n            result.push((value << (outBits - bits)) & maxV);\n        }\n    }\n    else {\n        if (bits >= inBits)\n            return 'Excess padding';\n        if ((value << (outBits - bits)) & maxV)\n            return 'Non-zero padding';\n    }\n    return result;\n}\nfunction toWords(bytes) {\n    return convert(bytes, 8, 5, true);\n}\nfunction fromWordsUnsafe(words) {\n    const res = convert(words, 5, 8, false);\n    if (Array.isArray(res))\n        return res;\n}\nfunction fromWords(words) {\n    const res = convert(words, 5, 8, false);\n    if (Array.isArray(res))\n        return res;\n    throw new Error(res);\n}\nfunction getLibraryFromEncoding(encoding) {\n    let ENCODING_CONST;\n    if (encoding === 'bech32') {\n        ENCODING_CONST = 1;\n    }\n    else {\n        ENCODING_CONST = 0x2bc830a3;\n    }\n    function encode(prefix, words, LIMIT) {\n        LIMIT = LIMIT || 90;\n        if (prefix.length + 7 + words.length > LIMIT)\n            throw new TypeError('Exceeds length limit');\n        prefix = prefix.toLowerCase();\n        // determine chk mod\n        let chk = prefixChk(prefix);\n        if (typeof chk === 'string')\n            throw new Error(chk);\n        let result = prefix + '1';\n        for (let i = 0; i < words.length; ++i) {\n            const x = words[i];\n            if (x >> 5 !== 0)\n                throw new Error('Non 5-bit word');\n            chk = polymodStep(chk) ^ x;\n            result += ALPHABET.charAt(x);\n        }\n        for (let i = 0; i < 6; ++i) {\n            chk = polymodStep(chk);\n        }\n        chk ^= ENCODING_CONST;\n        for (let i = 0; i < 6; ++i) {\n            const v = (chk >> ((5 - i) * 5)) & 0x1f;\n            result += ALPHABET.charAt(v);\n        }\n        return result;\n    }\n    function __decode(str, LIMIT) {\n        LIMIT = LIMIT || 90;\n        if (str.length < 8)\n            return str + ' too short';\n        if (str.length > LIMIT)\n            return 'Exceeds length limit';\n        // don't allow mixed case\n        const lowered = str.toLowerCase();\n        const uppered = str.toUpperCase();\n        if (str !== lowered && str !== uppered)\n            return 'Mixed-case string ' + str;\n        str = lowered;\n        const split = str.lastIndexOf('1');\n        if (split === -1)\n            return 'No separator character for ' + str;\n        if (split === 0)\n            return 'Missing prefix for ' + str;\n        const prefix = str.slice(0, split);\n        const wordChars = str.slice(split + 1);\n        if (wordChars.length < 6)\n            return 'Data too short';\n        let chk = prefixChk(prefix);\n        if (typeof chk === 'string')\n            return chk;\n        const words = [];\n        for (let i = 0; i < wordChars.length; ++i) {\n            const c = wordChars.charAt(i);\n            const v = ALPHABET_MAP[c];\n            if (v === undefined)\n                return 'Unknown character ' + c;\n            chk = polymodStep(chk) ^ v;\n            // not in the checksum?\n            if (i + 6 >= wordChars.length)\n                continue;\n            words.push(v);\n        }\n        if (chk !== ENCODING_CONST)\n            return 'Invalid checksum for ' + str;\n        return { prefix, words };\n    }\n    function decodeUnsafe(str, LIMIT) {\n        const res = __decode(str, LIMIT);\n        if (typeof res === 'object')\n            return res;\n    }\n    function decode(str, LIMIT) {\n        const res = __decode(str, LIMIT);\n        if (typeof res === 'object')\n            return res;\n        throw new Error(res);\n    }\n    return {\n        decodeUnsafe,\n        decode,\n        encode,\n        toWords,\n        fromWordsUnsafe,\n        fromWords,\n    };\n}\nexports.bech32 = getLibraryFromEncoding('bech32');\nexports.bech32m = getLibraryFromEncoding('bech32m');\n","/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n/** Asserts something is positive integer. */\nexport function anumber(n, title = '') {\n    if (!Number.isSafeInteger(n) || n < 0) {\n        const prefix = title && `\"${title}\" `;\n        throw new Error(`${prefix}expected integer >= 0, got ${n}`);\n    }\n}\n/** Asserts something is Uint8Array. */\nexport function abytes(value, length, title = '') {\n    const bytes = isBytes(value);\n    const len = value?.length;\n    const needsLen = length !== undefined;\n    if (!bytes || (needsLen && len !== length)) {\n        const prefix = title && `\"${title}\" `;\n        const ofLen = needsLen ? ` of length ${length}` : '';\n        const got = bytes ? `length=${len}` : `type=${typeof value}`;\n        throw new Error(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n    }\n    return value;\n}\n/** Asserts something is hash */\nexport function ahash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash must wrapped by utils.createHasher');\n    anumber(h.outputLen);\n    anumber(h.blockLen);\n}\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out, instance) {\n    abytes(out, undefined, 'digestInto() output');\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error('\"digestInto() output\" expected to be of length >=' + min);\n    }\n}\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr) {\n    return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr) {\n    return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays) {\n    for (let i = 0; i < arrays.length; i++) {\n        arrays[i].fill(0);\n    }\n}\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr) {\n    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word, shift) {\n    return (word << (32 - shift)) | (word >>> shift);\n}\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word, shift) {\n    return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE = /* @__PURE__ */ (() => new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n/** The byte swap operation for uint32 */\nexport function byteSwap(word) {\n    return (((word << 24) & 0xff000000) |\n        ((word << 8) & 0xff0000) |\n        ((word >>> 8) & 0xff00) |\n        ((word >>> 24) & 0xff));\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const swap8IfBE = isLE\n    ? (n) => n\n    : (n) => byteSwap(n);\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n    return arr;\n}\nexport const swap32IfBE = isLE\n    ? (u) => u\n    : byteSwap32;\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin = /* @__PURE__ */ (() => \n// @ts-ignore\ntypeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return bytes.toHex();\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return Uint8Array.fromHex(hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async () => { };\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * Converts string to bytes using UTF8 encoding.\n * Built-in doesn't validate input to be string: we do the check.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error('string expected');\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Helper for KDFs: consumes uint8array or string.\n * When string is passed, does utf8 decoding, using TextDecoder.\n */\nexport function kdfInputToBytes(data, errorTitle = '') {\n    if (typeof data === 'string')\n        return utf8ToBytes(data);\n    return abytes(data, undefined, errorTitle);\n}\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n/** Merges default options and passed options. */\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n        throw new Error('options must be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\n/** Creates function with outputLen, blockLen, create properties from a class constructor. */\nexport function createHasher(hashCons, info = {}) {\n    const hashC = (msg, opts) => hashCons(opts).update(msg).digest();\n    const tmp = hashCons(undefined);\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    Object.assign(hashC, info);\n    return Object.freeze(hashC);\n}\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32) {\n    const cr = typeof globalThis === 'object' ? globalThis.crypto : null;\n    if (typeof cr?.getRandomValues !== 'function')\n        throw new Error('crypto.getRandomValues must be defined');\n    return cr.getRandomValues(new Uint8Array(bytesLength));\n}\n/** Creates OID opts for NIST hashes, with prefix 06 09 60 86 48 01 65 03 04 02. */\nexport const oidNist = (suffix) => ({\n    oid: Uint8Array.from([0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, suffix]),\n});\n//# sourceMappingURL=utils.js.map","/**\n * Internal Merkle-Damgard hash utils.\n * @module\n */\nimport { abytes, aexists, aoutput, clean, createView } from \"./utils.js\";\n/** Choice: a ? b : c */\nexport function Chi(a, b, c) {\n    return (a & b) ^ (~a & c);\n}\n/** Majority function, true if any two inputs is true. */\nexport function Maj(a, b, c) {\n    return (a & b) ^ (a & c) ^ (b & c);\n}\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport class HashMD {\n    blockLen;\n    outputLen;\n    padOffset;\n    isLE;\n    // For partial updates less than block size\n    buffer;\n    view;\n    finished = false;\n    length = 0;\n    pos = 0;\n    destroyed = false;\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        aexists(this);\n        abytes(data);\n        const { view, buffer, blockLen } = this;\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        aexists(this);\n        aoutput(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        clean(this.buffer.subarray(pos));\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        view.setBigUint64(blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which must be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen must be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to ||= new this.constructor();\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.destroyed = destroyed;\n        to.finished = finished;\n        to.length = length;\n        to.pos = pos;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n    clone() {\n        return this._cloneInto();\n    }\n}\n/**\n * Initial SHA-2 state: fractional parts of square roots of first 16 primes 2..53.\n * Check out `test/misc/sha2-gen-iv.js` for recomputation guide.\n */\n/** Initial SHA256 state. Bits 0..32 of frac part of sqrt of primes 2..19 */\nexport const SHA256_IV = /* @__PURE__ */ Uint32Array.from([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,\n]);\n/** Initial SHA224 state. Bits 32..64 of frac part of sqrt of primes 23..53 */\nexport const SHA224_IV = /* @__PURE__ */ Uint32Array.from([\n    0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939, 0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4,\n]);\n/** Initial SHA384 state. Bits 0..64 of frac part of sqrt of primes 23..53 */\nexport const SHA384_IV = /* @__PURE__ */ Uint32Array.from([\n    0xcbbb9d5d, 0xc1059ed8, 0x629a292a, 0x367cd507, 0x9159015a, 0x3070dd17, 0x152fecd8, 0xf70e5939,\n    0x67332667, 0xffc00b31, 0x8eb44a87, 0x68581511, 0xdb0c2e0d, 0x64f98fa7, 0x47b5481d, 0xbefa4fa4,\n]);\n/** Initial SHA512 state. Bits 0..64 of frac part of sqrt of primes 2..19 */\nexport const SHA512_IV = /* @__PURE__ */ Uint32Array.from([\n    0x6a09e667, 0xf3bcc908, 0xbb67ae85, 0x84caa73b, 0x3c6ef372, 0xfe94f82b, 0xa54ff53a, 0x5f1d36f1,\n    0x510e527f, 0xade682d1, 0x9b05688c, 0x2b3e6c1f, 0x1f83d9ab, 0xfb41bd6b, 0x5be0cd19, 0x137e2179,\n]);\n//# sourceMappingURL=_md.js.map","/**\n * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.\n * @todo re-check https://issues.chromium.org/issues/42212588\n * @module\n */\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    const len = lst.length;\n    let Ah = new Uint32Array(len);\n    let Al = new Uint32Array(len);\n    for (let i = 0; i < len; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { add, add3H, add3L, add4H, add4L, add5H, add5L, fromBig, rotlBH, rotlBL, rotlSH, rotlSL, rotr32H, rotr32L, rotrBH, rotrBL, rotrSH, rotrSL, shrSH, shrSL, split, toBig };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","/**\n * SHA2 hash function. A.k.a. sha256, sha384, sha512, sha512_224, sha512_256.\n * SHA256 is the fastest hash implementable in JS, even faster than Blake3.\n * Check out [RFC 4634](https://www.rfc-editor.org/rfc/rfc4634) and\n * [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).\n * @module\n */\nimport { Chi, HashMD, Maj, SHA224_IV, SHA256_IV, SHA384_IV, SHA512_IV } from \"./_md.js\";\nimport * as u64 from \"./_u64.js\";\nimport { clean, createHasher, oidNist, rotr } from \"./utils.js\";\n/**\n * Round constants:\n * First 32 bits of fractional parts of the cube roots of the first 64 primes 2..311)\n */\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ Uint32Array.from([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n/** Reusable temporary buffer. \"W\" comes straight from spec. */\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\n/** Internal 32-byte base SHA2 hash class. */\nclass SHA2_32B extends HashMD {\n    constructor(outputLen) {\n        super(64, outputLen, 8, false);\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        clean(SHA256_W);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        clean(this.buffer);\n    }\n}\n/** Internal SHA2-256 hash class. */\nexport class _SHA256 extends SHA2_32B {\n    // We cannot use array here since array allows indexing by variable\n    // which means optimizer/compiler cannot use registers.\n    A = SHA256_IV[0] | 0;\n    B = SHA256_IV[1] | 0;\n    C = SHA256_IV[2] | 0;\n    D = SHA256_IV[3] | 0;\n    E = SHA256_IV[4] | 0;\n    F = SHA256_IV[5] | 0;\n    G = SHA256_IV[6] | 0;\n    H = SHA256_IV[7] | 0;\n    constructor() {\n        super(32);\n    }\n}\n/** Internal SHA2-224 hash class. */\nexport class _SHA224 extends SHA2_32B {\n    A = SHA224_IV[0] | 0;\n    B = SHA224_IV[1] | 0;\n    C = SHA224_IV[2] | 0;\n    D = SHA224_IV[3] | 0;\n    E = SHA224_IV[4] | 0;\n    F = SHA224_IV[5] | 0;\n    G = SHA224_IV[6] | 0;\n    H = SHA224_IV[7] | 0;\n    constructor() {\n        super(28);\n    }\n}\n// SHA2-512 is slower than sha256 in js because u64 operations are slow.\n// Round contants\n// First 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409\n// prettier-ignore\nconst K512 = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\nconst SHA512_Kh = /* @__PURE__ */ (() => K512[0])();\nconst SHA512_Kl = /* @__PURE__ */ (() => K512[1])();\n// Reusable temporary buffers\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\n/** Internal 64-byte base SHA2 hash class. */\nclass SHA2_64B extends HashMD {\n    constructor(outputLen) {\n        super(128, outputLen, 16, false);\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        clean(SHA512_W_H, SHA512_W_L);\n    }\n    destroy() {\n        clean(this.buffer);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\n/** Internal SHA2-512 hash class. */\nexport class _SHA512 extends SHA2_64B {\n    Ah = SHA512_IV[0] | 0;\n    Al = SHA512_IV[1] | 0;\n    Bh = SHA512_IV[2] | 0;\n    Bl = SHA512_IV[3] | 0;\n    Ch = SHA512_IV[4] | 0;\n    Cl = SHA512_IV[5] | 0;\n    Dh = SHA512_IV[6] | 0;\n    Dl = SHA512_IV[7] | 0;\n    Eh = SHA512_IV[8] | 0;\n    El = SHA512_IV[9] | 0;\n    Fh = SHA512_IV[10] | 0;\n    Fl = SHA512_IV[11] | 0;\n    Gh = SHA512_IV[12] | 0;\n    Gl = SHA512_IV[13] | 0;\n    Hh = SHA512_IV[14] | 0;\n    Hl = SHA512_IV[15] | 0;\n    constructor() {\n        super(64);\n    }\n}\n/** Internal SHA2-384 hash class. */\nexport class _SHA384 extends SHA2_64B {\n    Ah = SHA384_IV[0] | 0;\n    Al = SHA384_IV[1] | 0;\n    Bh = SHA384_IV[2] | 0;\n    Bl = SHA384_IV[3] | 0;\n    Ch = SHA384_IV[4] | 0;\n    Cl = SHA384_IV[5] | 0;\n    Dh = SHA384_IV[6] | 0;\n    Dl = SHA384_IV[7] | 0;\n    Eh = SHA384_IV[8] | 0;\n    El = SHA384_IV[9] | 0;\n    Fh = SHA384_IV[10] | 0;\n    Fl = SHA384_IV[11] | 0;\n    Gh = SHA384_IV[12] | 0;\n    Gl = SHA384_IV[13] | 0;\n    Hh = SHA384_IV[14] | 0;\n    Hl = SHA384_IV[15] | 0;\n    constructor() {\n        super(48);\n    }\n}\n/**\n * Truncated SHA512/256 and SHA512/224.\n * SHA512_IV is XORed with 0xa5a5a5a5a5a5a5a5, then used as \"intermediary\" IV of SHA512/t.\n * Then t hashes string to produce result IV.\n * See `test/misc/sha2-gen-iv.js`.\n */\n/** SHA512/224 IV */\nconst T224_IV = /* @__PURE__ */ Uint32Array.from([\n    0x8c3d37c8, 0x19544da2, 0x73e19966, 0x89dcd4d6, 0x1dfab7ae, 0x32ff9c82, 0x679dd514, 0x582f9fcf,\n    0x0f6d2b69, 0x7bd44da8, 0x77e36f73, 0x04c48942, 0x3f9d85a8, 0x6a1d36c8, 0x1112e6ad, 0x91d692a1,\n]);\n/** SHA512/256 IV */\nconst T256_IV = /* @__PURE__ */ Uint32Array.from([\n    0x22312194, 0xfc2bf72c, 0x9f555fa3, 0xc84c64c2, 0x2393b86b, 0x6f53b151, 0x96387719, 0x5940eabd,\n    0x96283ee2, 0xa88effe3, 0xbe5e1e25, 0x53863992, 0x2b0199fc, 0x2c85b8aa, 0x0eb72ddc, 0x81c52ca2,\n]);\n/** Internal SHA2-512/224 hash class. */\nexport class _SHA512_224 extends SHA2_64B {\n    Ah = T224_IV[0] | 0;\n    Al = T224_IV[1] | 0;\n    Bh = T224_IV[2] | 0;\n    Bl = T224_IV[3] | 0;\n    Ch = T224_IV[4] | 0;\n    Cl = T224_IV[5] | 0;\n    Dh = T224_IV[6] | 0;\n    Dl = T224_IV[7] | 0;\n    Eh = T224_IV[8] | 0;\n    El = T224_IV[9] | 0;\n    Fh = T224_IV[10] | 0;\n    Fl = T224_IV[11] | 0;\n    Gh = T224_IV[12] | 0;\n    Gl = T224_IV[13] | 0;\n    Hh = T224_IV[14] | 0;\n    Hl = T224_IV[15] | 0;\n    constructor() {\n        super(28);\n    }\n}\n/** Internal SHA2-512/256 hash class. */\nexport class _SHA512_256 extends SHA2_64B {\n    Ah = T256_IV[0] | 0;\n    Al = T256_IV[1] | 0;\n    Bh = T256_IV[2] | 0;\n    Bl = T256_IV[3] | 0;\n    Ch = T256_IV[4] | 0;\n    Cl = T256_IV[5] | 0;\n    Dh = T256_IV[6] | 0;\n    Dl = T256_IV[7] | 0;\n    Eh = T256_IV[8] | 0;\n    El = T256_IV[9] | 0;\n    Fh = T256_IV[10] | 0;\n    Fl = T256_IV[11] | 0;\n    Gh = T256_IV[12] | 0;\n    Gl = T256_IV[13] | 0;\n    Hh = T256_IV[14] | 0;\n    Hl = T256_IV[15] | 0;\n    constructor() {\n        super(32);\n    }\n}\n/**\n * SHA2-256 hash function from RFC 4634. In JS it's the fastest: even faster than Blake3. Some info:\n *\n * - Trying 2^128 hashes would get 50% chance of collision, using birthday attack.\n * - BTC network is doing 2^70 hashes/sec (2^95 hashes/year) as per 2025.\n * - Each sha256 hash is executing 2^18 bit operations.\n * - Good 2024 ASICs can do 200Th/sec with 3500 watts of power, corresponding to 2^36 hashes/joule.\n */\nexport const sha256 = /* @__PURE__ */ createHasher(() => new _SHA256(), \n/* @__PURE__ */ oidNist(0x01));\n/** SHA2-224 hash function from RFC 4634 */\nexport const sha224 = /* @__PURE__ */ createHasher(() => new _SHA224(), \n/* @__PURE__ */ oidNist(0x04));\n/** SHA2-512 hash function from RFC 4634. */\nexport const sha512 = /* @__PURE__ */ createHasher(() => new _SHA512(), \n/* @__PURE__ */ oidNist(0x03));\n/** SHA2-384 hash function from RFC 4634. */\nexport const sha384 = /* @__PURE__ */ createHasher(() => new _SHA384(), \n/* @__PURE__ */ oidNist(0x02));\n/**\n * SHA2-512/256 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_256 = /* @__PURE__ */ createHasher(() => new _SHA512_256(), \n/* @__PURE__ */ oidNist(0x06));\n/**\n * SHA2-512/224 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_224 = /* @__PURE__ */ createHasher(() => new _SHA512_224(), \n/* @__PURE__ */ oidNist(0x05));\n//# sourceMappingURL=sha2.js.map","/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */\n/**\n * 5KB JS implementation of ed25519 EdDSA signatures.\n * Compliant with RFC8032, FIPS 186-5 & ZIP215.\n * @module\n * @example\n * ```js\nimport * as ed from '@noble/ed25519';\n(async () => {\n  const secretKey = ed.utils.randomSecretKey();\n  const message = Uint8Array.from([0xab, 0xbc, 0xcd, 0xde]);\n  const pubKey = await ed.getPublicKeyAsync(secretKey); // Sync methods are also present\n  const signature = await ed.signAsync(message, secretKey);\n  const isValid = await ed.verifyAsync(signature, message, pubKey);\n})();\n```\n */\n/**\n * Curve params. ed25519 is twisted edwards curve. Equation is x + y = -a + dxy.\n * * P = `2n**255n - 19n` // field over which calculations are done\n * * N = `2n**252n + 27742317777372353535851937790883648493n` // group order, amount of curve points\n * * h = 8 // cofactor\n * * a = `Fp.create(BigInt(-1))` // equation param\n * * d = -121665/121666 a.k.a. `Fp.neg(121665 * Fp.inv(121666))` // equation param\n * * Gx, Gy are coordinates of Generator / base point\n */\nconst ed25519_CURVE = {\n    p: 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,\n    n: 0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,\n    h: 8n,\n    a: 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,\n    d: 0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,\n    Gx: 0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,\n    Gy: 0x6666666666666666666666666666666666666666666666666666666666666658n,\n};\nconst { p: P, n: N, Gx, Gy, a: _a, d: _d, h } = ed25519_CURVE;\nconst L = 32; // field / group byte length\nconst L2 = 64;\n// Helpers and Precomputes sections are reused between libraries\n// ## Helpers\n// ----------\nconst captureTrace = (...args) => {\n    if ('captureStackTrace' in Error && typeof Error.captureStackTrace === 'function') {\n        Error.captureStackTrace(...args);\n    }\n};\nconst err = (message = '') => {\n    const e = new Error(message);\n    captureTrace(e, err);\n    throw e;\n};\nconst isBig = (n) => typeof n === 'bigint'; // is big integer\nconst isStr = (s) => typeof s === 'string'; // is string\nconst isBytes = (a) => a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n/** Asserts something is Uint8Array. */\nconst abytes = (value, length, title = '') => {\n    const bytes = isBytes(value);\n    const len = value?.length;\n    const needsLen = length !== undefined;\n    if (!bytes || (needsLen && len !== length)) {\n        const prefix = title && `\"${title}\" `;\n        const ofLen = needsLen ? ` of length ${length}` : '';\n        const got = bytes ? `length=${len}` : `type=${typeof value}`;\n        err(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n    }\n    return value;\n};\n/** create Uint8Array */\nconst u8n = (len) => new Uint8Array(len);\nconst u8fr = (buf) => Uint8Array.from(buf);\nconst padh = (n, pad) => n.toString(16).padStart(pad, '0');\nconst bytesToHex = (b) => Array.from(abytes(b))\n    .map((e) => padh(e, 2))\n    .join('');\nconst C = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 }; // ASCII characters\nconst _ch = (ch) => {\n    if (ch >= C._0 && ch <= C._9)\n        return ch - C._0; // '2' => 50-48\n    if (ch >= C.A && ch <= C.F)\n        return ch - (C.A - 10); // 'B' => 66-(65-10)\n    if (ch >= C.a && ch <= C.f)\n        return ch - (C.a - 10); // 'b' => 98-(97-10)\n    return;\n};\nconst hexToBytes = (hex) => {\n    const e = 'hex invalid';\n    if (!isStr(hex))\n        return err(e);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        return err(e);\n    const array = u8n(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        // treat each char as ASCII\n        const n1 = _ch(hex.charCodeAt(hi)); // parse first char, multiply it by 16\n        const n2 = _ch(hex.charCodeAt(hi + 1)); // parse second char\n        if (n1 === undefined || n2 === undefined)\n            return err(e);\n        array[ai] = n1 * 16 + n2; // example: 'A9' => 10*16 + 9\n    }\n    return array;\n};\nconst cr = () => globalThis?.crypto; // WebCrypto is available in all modern environments\nconst subtle = () => cr()?.subtle ?? err('crypto.subtle must be defined, consider polyfill');\n// prettier-ignore\nconst concatBytes = (...arrs) => {\n    const r = u8n(arrs.reduce((sum, a) => sum + abytes(a).length, 0)); // create u8a of summed length\n    let pad = 0; // walk through each array,\n    arrs.forEach(a => { r.set(a, pad); pad += a.length; }); // ensure they have proper type\n    return r;\n};\n/** WebCrypto OS-level CSPRNG (random number generator). Will throw when not available. */\nconst randomBytes = (len = L) => {\n    const c = cr();\n    return c.getRandomValues(u8n(len));\n};\nconst big = BigInt;\nconst assertRange = (n, min, max, msg = 'bad number: out of range') => (isBig(n) && min <= n && n < max ? n : err(msg));\n/** modular division */\nconst M = (a, b = P) => {\n    const r = a % b;\n    return r >= 0n ? r : b + r;\n};\nconst modN = (a) => M(a, N);\n/** Modular inversion using euclidean GCD (non-CT). No negative exponent for now. */\n// prettier-ignore\nconst invert = (num, md) => {\n    if (num === 0n || md <= 0n)\n        err('no inverse n=' + num + ' mod=' + md);\n    let a = M(num, md), b = md, x = 0n, y = 1n, u = 1n, v = 0n;\n    while (a !== 0n) {\n        const q = b / a, r = b % a;\n        const m = x - u * q, n = y - v * q;\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    return b === 1n ? M(x, md) : err('no inverse'); // b is gcd at this point\n};\nconst callHash = (name) => {\n    // @ts-ignore\n    const fn = hashes[name];\n    if (typeof fn !== 'function')\n        err('hashes.' + name + ' not set');\n    return fn;\n};\nconst hash = (msg) => callHash('sha512')(msg);\nconst apoint = (p) => (p instanceof Point ? p : err('Point expected'));\n// ## End of Helpers\n// -----------------\nconst B256 = 2n ** 256n;\n/** Point in XYZT extended coordinates. */\nclass Point {\n    static BASE;\n    static ZERO;\n    X;\n    Y;\n    Z;\n    T;\n    constructor(X, Y, Z, T) {\n        const max = B256;\n        this.X = assertRange(X, 0n, max);\n        this.Y = assertRange(Y, 0n, max);\n        this.Z = assertRange(Z, 1n, max);\n        this.T = assertRange(T, 0n, max);\n        Object.freeze(this);\n    }\n    static CURVE() {\n        return ed25519_CURVE;\n    }\n    static fromAffine(p) {\n        return new Point(p.x, p.y, 1n, M(p.x * p.y));\n    }\n    /** RFC8032 5.1.3: Uint8Array to Point. */\n    static fromBytes(hex, zip215 = false) {\n        const d = _d;\n        // Copy array to not mess it up.\n        const normed = u8fr(abytes(hex, L));\n        // adjust first LE byte = last BE byte\n        const lastByte = hex[31];\n        normed[31] = lastByte & ~0x80;\n        const y = bytesToNumLE(normed);\n        // zip215=true:           0 <= y < 2^256\n        // zip215=false, RFC8032: 0 <= y < 2^255-19\n        const max = zip215 ? B256 : P;\n        assertRange(y, 0n, max);\n        const y2 = M(y * y); // y\n        const u = M(y2 - 1n); // u=y-1\n        const v = M(d * y2 + 1n); // v=dy+1\n        let { isValid, value: x } = uvRatio(u, v); // (uv)(uv)^(p-5)/8; square root\n        if (!isValid)\n            err('bad point: y not sqrt'); // not square root: bad point\n        const isXOdd = (x & 1n) === 1n; // adjust sign of x coordinate\n        const isLastByteOdd = (lastByte & 0x80) !== 0; // x_0, last bit\n        if (!zip215 && x === 0n && isLastByteOdd)\n            err('bad point: x==0, isLastByteOdd'); // x=0, x_0=1\n        if (isLastByteOdd !== isXOdd)\n            x = M(-x);\n        return new Point(x, y, 1n, M(x * y)); // Z=1, T=xy\n    }\n    static fromHex(hex, zip215) {\n        return Point.fromBytes(hexToBytes(hex), zip215);\n    }\n    get x() {\n        return this.toAffine().x;\n    }\n    get y() {\n        return this.toAffine().y;\n    }\n    /** Checks if the point is valid and on-curve. */\n    assertValidity() {\n        const a = _a;\n        const d = _d;\n        const p = this;\n        if (p.is0())\n            return err('bad point: ZERO'); // TODO: optimize, with vars below?\n        // Equation in affine coordinates: ax + y = 1 + dxy\n        // Equation in projective coordinates (X/Z, Y/Z, Z):  (aX + Y)Z = Z + dXY\n        const { X, Y, Z, T } = p;\n        const X2 = M(X * X); // X\n        const Y2 = M(Y * Y); // Y\n        const Z2 = M(Z * Z); // Z\n        const Z4 = M(Z2 * Z2); // Z\n        const aX2 = M(X2 * a); // aX\n        const left = M(Z2 * M(aX2 + Y2)); // (aX + Y)Z\n        const right = M(Z4 + M(d * M(X2 * Y2))); // Z + dXY\n        if (left !== right)\n            return err('bad point: equation left != right (1)');\n        // In Extended coordinates we also have T, which is x*y=T/Z: check X*Y == Z*T\n        const XY = M(X * Y);\n        const ZT = M(Z * T);\n        if (XY !== ZT)\n            return err('bad point: equation left != right (2)');\n        return this;\n    }\n    /** Equality check: compare points P&Q. */\n    equals(other) {\n        const { X: X1, Y: Y1, Z: Z1 } = this;\n        const { X: X2, Y: Y2, Z: Z2 } = apoint(other); // checks class equality\n        const X1Z2 = M(X1 * Z2);\n        const X2Z1 = M(X2 * Z1);\n        const Y1Z2 = M(Y1 * Z2);\n        const Y2Z1 = M(Y2 * Z1);\n        return X1Z2 === X2Z1 && Y1Z2 === Y2Z1;\n    }\n    is0() {\n        return this.equals(I);\n    }\n    /** Flip point over y coordinate. */\n    negate() {\n        return new Point(M(-this.X), this.Y, this.Z, M(-this.T));\n    }\n    /** Point doubling. Complete formula. Cost: `4M + 4S + 1*a + 6add + 1*2`. */\n    double() {\n        const { X: X1, Y: Y1, Z: Z1 } = this;\n        const a = _a;\n        // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#doubling-dbl-2008-hwcd\n        const A = M(X1 * X1);\n        const B = M(Y1 * Y1);\n        const C = M(2n * M(Z1 * Z1));\n        const D = M(a * A);\n        const x1y1 = X1 + Y1;\n        const E = M(M(x1y1 * x1y1) - A - B);\n        const G = D + B;\n        const F = G - C;\n        const H = D - B;\n        const X3 = M(E * F);\n        const Y3 = M(G * H);\n        const T3 = M(E * H);\n        const Z3 = M(F * G);\n        return new Point(X3, Y3, Z3, T3);\n    }\n    /** Point addition. Complete formula. Cost: `8M + 1*k + 8add + 1*2`. */\n    add(other) {\n        const { X: X1, Y: Y1, Z: Z1, T: T1 } = this;\n        const { X: X2, Y: Y2, Z: Z2, T: T2 } = apoint(other); // doesn't check if other on-curve\n        const a = _a;\n        const d = _d;\n        // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended-1.html#addition-add-2008-hwcd-3\n        const A = M(X1 * X2);\n        const B = M(Y1 * Y2);\n        const C = M(T1 * d * T2);\n        const D = M(Z1 * Z2);\n        const E = M((X1 + Y1) * (X2 + Y2) - A - B);\n        const F = M(D - C);\n        const G = M(D + C);\n        const H = M(B - a * A);\n        const X3 = M(E * F);\n        const Y3 = M(G * H);\n        const T3 = M(E * H);\n        const Z3 = M(F * G);\n        return new Point(X3, Y3, Z3, T3);\n    }\n    subtract(other) {\n        return this.add(apoint(other).negate());\n    }\n    /**\n     * Point-by-scalar multiplication. Scalar must be in range 1 <= n < CURVE.n.\n     * Uses {@link wNAF} for base point.\n     * Uses fake point to mitigate side-channel leakage.\n     * @param n scalar by which point is multiplied\n     * @param safe safe mode guards against timing attacks; unsafe mode is faster\n     */\n    multiply(n, safe = true) {\n        if (!safe && (n === 0n || this.is0()))\n            return I;\n        assertRange(n, 1n, N);\n        if (n === 1n)\n            return this;\n        if (this.equals(G))\n            return wNAF(n).p;\n        // init result point & fake point\n        let p = I;\n        let f = G;\n        for (let d = this; n > 0n; d = d.double(), n >>= 1n) {\n            // if bit is present, add to point\n            // if not present, add to fake, for timing safety\n            if (n & 1n)\n                p = p.add(d);\n            else if (safe)\n                f = f.add(d);\n        }\n        return p;\n    }\n    multiplyUnsafe(scalar) {\n        return this.multiply(scalar, false);\n    }\n    /** Convert point to 2d xy affine point. (X, Y, Z)  (x=X/Z, y=Y/Z) */\n    toAffine() {\n        const { X, Y, Z } = this;\n        // fast-paths for ZERO point OR Z=1\n        if (this.equals(I))\n            return { x: 0n, y: 1n };\n        const iz = invert(Z, P);\n        // (Z * Z^-1) must be 1, otherwise bad math\n        if (M(Z * iz) !== 1n)\n            err('invalid inverse');\n        // x = X*Z^-1; y = Y*Z^-1\n        const x = M(X * iz);\n        const y = M(Y * iz);\n        return { x, y };\n    }\n    toBytes() {\n        const { x, y } = this.assertValidity().toAffine();\n        const b = numTo32bLE(y);\n        // store sign in first LE byte\n        b[31] |= x & 1n ? 0x80 : 0;\n        return b;\n    }\n    toHex() {\n        return bytesToHex(this.toBytes());\n    }\n    clearCofactor() {\n        return this.multiply(big(h), false);\n    }\n    isSmallOrder() {\n        return this.clearCofactor().is0();\n    }\n    isTorsionFree() {\n        // Multiply by big number N. We can't `mul(N)` because of checks. Instead, we `mul(N/2)*2+1`\n        let p = this.multiply(N / 2n, false).double();\n        if (N % 2n)\n            p = p.add(this);\n        return p.is0();\n    }\n}\n/** Generator / base point */\nconst G = new Point(Gx, Gy, 1n, M(Gx * Gy));\n/** Identity / zero point */\nconst I = new Point(0n, 1n, 1n, 0n);\n// Static aliases\nPoint.BASE = G;\nPoint.ZERO = I;\nconst numTo32bLE = (num) => hexToBytes(padh(assertRange(num, 0n, B256), L2)).reverse();\nconst bytesToNumLE = (b) => big('0x' + bytesToHex(u8fr(abytes(b)).reverse()));\nconst pow2 = (x, power) => {\n    // pow2(x, 4) == x^(2^4)\n    let r = x;\n    while (power-- > 0n) {\n        r *= r;\n        r %= P;\n    }\n    return r;\n};\n// prettier-ignore\nconst pow_2_252_3 = (x) => {\n    const x2 = (x * x) % P; // x^2,       bits 1\n    const b2 = (x2 * x) % P; // x^3,       bits 11\n    const b4 = (pow2(b2, 2n) * b2) % P; // x^(2^4-1), bits 1111\n    const b5 = (pow2(b4, 1n) * x) % P; // x^(2^5-1), bits 11111\n    const b10 = (pow2(b5, 5n) * b5) % P; // x^(2^10)\n    const b20 = (pow2(b10, 10n) * b10) % P; // x^(2^20)\n    const b40 = (pow2(b20, 20n) * b20) % P; // x^(2^40)\n    const b80 = (pow2(b40, 40n) * b40) % P; // x^(2^80)\n    const b160 = (pow2(b80, 80n) * b80) % P; // x^(2^160)\n    const b240 = (pow2(b160, 80n) * b80) % P; // x^(2^240)\n    const b250 = (pow2(b240, 10n) * b10) % P; // x^(2^250)\n    const pow_p_5_8 = (pow2(b250, 2n) * x) % P; // < To pow to (p+3)/8, multiply it by x.\n    return { pow_p_5_8, b2 };\n};\nconst RM1 = 0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n; // -1\n// for sqrt comp\n// prettier-ignore\nconst uvRatio = (u, v) => {\n    const v3 = M(v * v * v); // v\n    const v7 = M(v3 * v3 * v); // v\n    const pow = pow_2_252_3(u * v7).pow_p_5_8; // (uv)^(p-5)/8\n    let x = M(u * v3 * pow); // (uv)(uv)^(p-5)/8\n    const vx2 = M(v * x * x); // vx\n    const root1 = x; // First root candidate\n    const root2 = M(x * RM1); // Second root candidate; RM1 is -1\n    const useRoot1 = vx2 === u; // If vx = u (mod p), x is a square root\n    const useRoot2 = vx2 === M(-u); // If vx = -u, set x <-- x * 2^((p-1)/4)\n    const noRoot = vx2 === M(-u * RM1); // There is no valid root, vx = -u-1\n    if (useRoot1)\n        x = root1;\n    if (useRoot2 || noRoot)\n        x = root2; // We return root2 anyway, for const-time\n    if ((M(x) & 1n) === 1n)\n        x = M(-x); // edIsNegative\n    return { isValid: useRoot1 || useRoot2, value: x };\n};\n// N == L, just weird naming\nconst modL_LE = (hash) => modN(bytesToNumLE(hash)); // modulo L; but little-endian\n/** hashes.sha512 should conform to the interface. */\n// TODO: rename\nconst sha512a = (...m) => hashes.sha512Async(concatBytes(...m)); // Async SHA512\nconst sha512s = (...m) => callHash('sha512')(concatBytes(...m));\n// RFC8032 5.1.5\nconst hash2extK = (hashed) => {\n    // slice creates a copy, unlike subarray\n    const head = hashed.slice(0, L);\n    head[0] &= 248; // Clamp bits: 0b1111_1000\n    head[31] &= 127; // 0b0111_1111\n    head[31] |= 64; // 0b0100_0000\n    const prefix = hashed.slice(L, L2); // secret key \"prefix\"\n    const scalar = modL_LE(head); // modular division over curve order\n    const point = G.multiply(scalar); // public key point\n    const pointBytes = point.toBytes(); // point serialized to Uint8Array\n    return { head, prefix, scalar, point, pointBytes };\n};\n// RFC8032 5.1.5; getPublicKey async, sync. Hash priv key and extract point.\nconst getExtendedPublicKeyAsync = (secretKey) => sha512a(abytes(secretKey, L)).then(hash2extK);\nconst getExtendedPublicKey = (secretKey) => hash2extK(sha512s(abytes(secretKey, L)));\n/** Creates 32-byte ed25519 public key from 32-byte secret key. Async. */\nconst getPublicKeyAsync = (secretKey) => getExtendedPublicKeyAsync(secretKey).then((p) => p.pointBytes);\n/** Creates 32-byte ed25519 public key from 32-byte secret key. To use, set `hashes.sha512` first. */\nconst getPublicKey = (priv) => getExtendedPublicKey(priv).pointBytes;\nconst hashFinishA = (res) => sha512a(res.hashable).then(res.finish);\nconst hashFinishS = (res) => res.finish(sha512s(res.hashable));\n// Code, shared between sync & async sign\nconst _sign = (e, rBytes, msg) => {\n    const { pointBytes: P, scalar: s } = e;\n    const r = modL_LE(rBytes); // r was created outside, reduce it modulo L\n    const R = G.multiply(r).toBytes(); // R = [r]B\n    const hashable = concatBytes(R, P, msg); // dom2(F, C) || R || A || PH(M)\n    const finish = (hashed) => {\n        // k = SHA512(dom2(F, C) || R || A || PH(M))\n        const S = modN(r + modL_LE(hashed) * s); // S = (r + k * s) mod L; 0 <= s < l\n        return abytes(concatBytes(R, numTo32bLE(S)), L2); // 64-byte sig: 32b R.x + 32b LE(S)\n    };\n    return { hashable, finish };\n};\n/**\n * Signs message using secret key. Async.\n * Follows RFC8032 5.1.6.\n */\nconst signAsync = async (message, secretKey) => {\n    const m = abytes(message);\n    const e = await getExtendedPublicKeyAsync(secretKey);\n    const rBytes = await sha512a(e.prefix, m); // r = SHA512(dom2(F, C) || prefix || PH(M))\n    return hashFinishA(_sign(e, rBytes, m)); // gen R, k, S, then 64-byte signature\n};\n/**\n * Signs message using secret key. To use, set `hashes.sha512` first.\n * Follows RFC8032 5.1.6.\n */\nconst sign = (message, secretKey) => {\n    const m = abytes(message);\n    const e = getExtendedPublicKey(secretKey);\n    const rBytes = sha512s(e.prefix, m); // r = SHA512(dom2(F, C) || prefix || PH(M))\n    return hashFinishS(_sign(e, rBytes, m)); // gen R, k, S, then 64-byte signature\n};\nconst defaultVerifyOpts = { zip215: true };\nconst _verify = (sig, msg, pub, opts = defaultVerifyOpts) => {\n    sig = abytes(sig, L2); // Signature hex str/Bytes, must be 64 bytes\n    msg = abytes(msg); // Message hex str/Bytes\n    pub = abytes(pub, L);\n    const { zip215 } = opts; // switch between zip215 and rfc8032 verif\n    let A;\n    let R;\n    let s;\n    let SB;\n    let hashable = Uint8Array.of();\n    try {\n        A = Point.fromBytes(pub, zip215); // public key A decoded\n        R = Point.fromBytes(sig.slice(0, L), zip215); // 0 <= R < 2^256: ZIP215 R can be >= P\n        s = bytesToNumLE(sig.slice(L, L2)); // Decode second half as an integer S\n        SB = G.multiply(s, false); // in the range 0 <= s < L\n        hashable = concatBytes(R.toBytes(), A.toBytes(), msg); // dom2(F, C) || R || A || PH(M)\n    }\n    catch (error) { }\n    const finish = (hashed) => {\n        // k = SHA512(dom2(F, C) || R || A || PH(M))\n        if (SB == null)\n            return false; // false if try-catch catched an error\n        if (!zip215 && A.isSmallOrder())\n            return false; // false for SBS: Strongly Binding Signature\n        const k = modL_LE(hashed); // decode in little-endian, modulo L\n        const RkA = R.add(A.multiply(k, false)); // [8]R + [8][k]A'\n        return RkA.add(SB.negate()).clearCofactor().is0(); // [8][S]B = [8]R + [8][k]A'\n    };\n    return { hashable, finish };\n};\n/** Verifies signature on message and public key. Async. Follows RFC8032 5.1.7. */\nconst verifyAsync = async (signature, message, publicKey, opts = defaultVerifyOpts) => hashFinishA(_verify(signature, message, publicKey, opts));\n/** Verifies signature on message and public key. To use, set `hashes.sha512` first. Follows RFC8032 5.1.7. */\nconst verify = (signature, message, publicKey, opts = defaultVerifyOpts) => hashFinishS(_verify(signature, message, publicKey, opts));\n/** Math, hex, byte helpers. Not in `utils` because utils share API with noble-curves. */\nconst etc = {\n    bytesToHex: bytesToHex,\n    hexToBytes: hexToBytes,\n    concatBytes: concatBytes,\n    mod: M,\n    invert: invert,\n    randomBytes: randomBytes,\n};\nconst hashes = {\n    sha512Async: async (message) => {\n        const s = subtle();\n        const m = concatBytes(message);\n        return u8n(await s.digest('SHA-512', m.buffer));\n    },\n    sha512: undefined,\n};\n// FIPS 186 B.4.1 compliant key generation produces private keys\n// with modulo bias being neglible. takes >N+16 bytes, returns (hash mod n-1)+1\nconst randomSecretKey = (seed = randomBytes(L)) => seed;\nconst keygen = (seed) => {\n    const secretKey = randomSecretKey(seed);\n    const publicKey = getPublicKey(secretKey);\n    return { secretKey, publicKey };\n};\nconst keygenAsync = async (seed) => {\n    const secretKey = randomSecretKey(seed);\n    const publicKey = await getPublicKeyAsync(secretKey);\n    return { secretKey, publicKey };\n};\n/** ed25519-specific key utilities. */\nconst utils = {\n    getExtendedPublicKeyAsync: getExtendedPublicKeyAsync,\n    getExtendedPublicKey: getExtendedPublicKey,\n    randomSecretKey: randomSecretKey,\n};\n// ## Precomputes\n// --------------\nconst W = 8; // W is window size\nconst scalarBits = 256;\nconst pwindows = Math.ceil(scalarBits / W) + 1; // 33 for W=8, NOT 32 - see wNAF loop\nconst pwindowSize = 2 ** (W - 1); // 128 for W=8\nconst precompute = () => {\n    const points = [];\n    let p = G;\n    let b = p;\n    for (let w = 0; w < pwindows; w++) {\n        b = p;\n        points.push(b);\n        for (let i = 1; i < pwindowSize; i++) {\n            b = b.add(p);\n            points.push(b);\n        } // i=1, bc we skip 0\n        p = b.double();\n    }\n    return points;\n};\nlet Gpows = undefined; // precomputes for base point G\n// const-time negate\nconst ctneg = (cnd, p) => {\n    const n = p.negate();\n    return cnd ? n : p;\n};\n/**\n * Precomputes give 12x faster getPublicKey(), 10x sign(), 2x verify() by\n * caching multiples of G (base point). Cache is stored in 32MB of RAM.\n * Any time `G.multiply` is done, precomputes are used.\n * Not used for getSharedSecret, which instead multiplies random pubkey `P.multiply`.\n *\n * w-ary non-adjacent form (wNAF) precomputation method is 10% slower than windowed method,\n * but takes 2x less RAM. RAM reduction is possible by utilizing `.subtract`.\n *\n * !! Precomputes can be disabled by commenting-out call of the wNAF() inside Point#multiply().\n */\nconst wNAF = (n) => {\n    const comp = Gpows || (Gpows = precompute());\n    let p = I;\n    let f = G; // f must be G, or could become I in the end\n    const pow_2_w = 2 ** W; // 256 for W=8\n    const maxNum = pow_2_w; // 256 for W=8\n    const mask = big(pow_2_w - 1); // 255 for W=8 == mask 0b11111111\n    const shiftBy = big(W); // 8 for W=8\n    for (let w = 0; w < pwindows; w++) {\n        let wbits = Number(n & mask); // extract W bits.\n        n >>= shiftBy; // shift number by W bits.\n        // We use negative indexes to reduce size of precomputed table by 2x.\n        // Instead of needing precomputes 0..256, we only calculate them for 0..128.\n        // If an index > 128 is found, we do (256-index) - where 256 is next window.\n        // Naive: index +127 => 127, +224 => 224\n        // Optimized: index +127 => 127, +224 => 256-32\n        if (wbits > pwindowSize) {\n            wbits -= maxNum;\n            n += 1n;\n        }\n        const off = w * pwindowSize;\n        const offF = off; // offsets, evaluate both\n        const offP = off + Math.abs(wbits) - 1;\n        const isEven = w % 2 !== 0; // conditions, evaluate both\n        const isNeg = wbits < 0;\n        if (wbits === 0) {\n            // off == I: can't add it. Adding random offF instead.\n            f = f.add(ctneg(isEven, comp[offF])); // bits are 0: add garbage to fake point\n        }\n        else {\n            p = p.add(ctneg(isNeg, comp[offP])); // bits are 1: add to result point\n        }\n    }\n    if (n !== 0n)\n        err('invalid wnaf');\n    return { p, f }; // return both real and fake points for JIT\n};\n// !! Remove the export to easily use in REPL / browser console\nexport { etc, getPublicKey, getPublicKeyAsync, hash, hashes, keygen, keygenAsync, Point, sign, signAsync, utils, verify, verifyAsync, };\n"],"names":["HpkeError","Error","constructor","e","message","super","this","name","EncapError","DecapError","ExportError","SealError","OpenError","MessageLimitReachedError","DeriveKeyPairError","dntGlobalThis","baseObj","globalThis","extObj","Proxy","get","_target","prop","_receiver","set","value","deleteProperty","success","ownKeys","baseKeys","Reflect","extKeys","extKeysSet","Set","filter","k","has","defineProperty","desc","getOwnPropertyDescriptor","NativeAlgorithm","Object","enumerable","configurable","writable","undefined","_setup","_api","async","crypto","subtle","webcrypto","loadSubtleCrypto","INPUT_LENGTH_LIMIT","Uint8Array","x","privateKey","publicKey","n","w","ret","i","a","b","length","LABEL_EAE_PRK","LABEL_SHARED_SECRET","Dhkem","id","prim","kdf","_prim","_kdf","suiteId","init","serializePublicKey","key","deserializePublicKey","serializePrivateKey","deserializePrivateKey","importKey","format","isPublic","generateKeyPair","deriveKeyPair","ikm","byteLength","encap","params","ke","ekm","enc","pkrm","recipientPublicKey","dh","kemContext","senderKey","sks","pks","derivePublicKey","pksm","c","concat3","sharedSecret","_generateSharedSecret","decap","pke","skr","recipientKey","pkr","senderPublicKey","labeledIkm","buildLabeledIkm","labeledInfo","buildLabeledInfo","secretSize","extractAndExpand","buffer","KEM_USAGES","Bignum","size","_num","val","reset","fill","src","isZero","lessThan","v","LABEL_CANDIDATE","ORDER_P_256","ORDER_P_384","ORDER_P_521","PKCS8_ALG_ID_P_256","PKCS8_ALG_ID_P_384","PKCS8_ALG_ID_P_521","Ec","kem","hkdf","_hkdf","_alg","namedCurve","_nPk","_nSk","_nDh","_order","_bitmask","_pkcs8AlgId","exportKey","_importRawKey","jwk","base64","replace","byteString","atob","charCodeAt","base64UrlToBytes","ArrayBuffer","_importJWK","generateKey","dkpPrk","labeledExtract","bn","counter","bytes","labeledExpand","sk","_deserializePkcs8Key","pk","deriveBits","public","crv","d","pkcs8Key","HPKE_VERSION","HkdfNative","hash","_suiteId","label","_checkInit","info","len","extract","salt","hashSize","algHash","sign","expand","prk","okm","p","prev","mid","tail","tmp","cur","slice","baseKey","HkdfSha256Native","arguments","AEAD_USAGES","BigInt","AesGcmContext","_rawKey","seal","iv","data","aad","_setupKey","alg","additionalData","encrypt","_key","open","decrypt","_importKey","Aes128Gcm","createEncryptionContext","Aes256Gcm","emitNotSupported","Promise","_resolve","reject","LABEL_SEC","ExporterContextImpl","api","exporterSecret","_data","_aad","exporterContext","RecipientExporterContextImpl","SenderExporterContextImpl","EncryptionContextImpl","baseNonce","seq","_aead","aead","_nK","keySize","_nN","nonceSize","_nT","tagSize","_ctx","computeNonce","seqBytes","buf","xor","incrementSeq","Number","MAX_SAFE_INTEGER","_Mutex_locked","Mutex","resolve","lock","releaseLock","nextLock","previousLock","receiver","state","kind","f","TypeError","call","__classPrivateFieldGet","__classPrivateFieldSet","WeakMap","_RecipientContextImpl_mutex","RecipientContextImpl","release","pt","_SenderContextImpl_mutex","SenderContextImpl","ct","LABEL_BASE_NONCE","LABEL_EXP","LABEL_INFO_HASH","LABEL_KEY","LABEL_PSK_ID_HASH","LABEL_SECRET","SUITE_ID_HEADER_HPKE","CipherSuiteNative","_kem","createSenderContext","_validateInputLength","mode","psk","_keyScheduleS","createRecipientContext","_keyScheduleR","ctx","_keySchedule","pskId","pskIdHash","infoHash","keyScheduleContext","exporterSecretInfo","keyInfo","baseNonceInfo","res","DhkemP256HkdfSha256Native","CipherSuite","DhkemP256HkdfSha256","HkdfSha256","exports","ALPHABET","ALPHABET_MAP","z","charAt","polymodStep","pre","prefixChk","prefix","chk","convert","inBits","outBits","pad","bits","maxV","result","push","toWords","fromWordsUnsafe","words","Array","isArray","fromWords","getLibraryFromEncoding","encoding","ENCODING_CONST","__decode","str","LIMIT","lowered","toLowerCase","uppered","toUpperCase","split","lastIndexOf","wordChars","decodeUnsafe","decode","encode","abytes","title","isView","needsLen","aexists","instance","checkFinished","destroyed","finished","clean","arrays","createView","arr","DataView","byteOffset","hashCons","hashC","msg","opts","update","digest","outputLen","blockLen","create","assign","freeze","suffix","oid","from","HashMD","padOffset","isLE","view","pos","take","Math","min","dataView","process","subarray","roundClean","digestInto","out","aoutput","setBigUint64","oview","outLen","setUint32","destroy","_cloneInto","to","clone","SHA512_IV","Uint32Array","U32_MASK64","_32n","fromBig","le","h","l","shrSH","_l","s","shrSL","rotrSH","rotrSL","rotrBH","rotrBL","add","Ah","Al","Bh","Bl","add3L","Cl","add3H","low","Ch","add4L","Dl","add4H","Dh","add5L","El","add5H","Eh","K512","lst","map","SHA512_Kh","SHA512_Kl","SHA512_W_H","SHA512_W_L","SHA2_64B","Fh","Fl","Gh","Gl","Hh","Hl","offset","getUint32","W15h","W15l","s0h","s0l","W2h","W2l","s1h","s1l","SUMl","SUMh","sigma1h","sigma1l","CHIh","T1ll","T1h","T1l","sigma0h","sigma0l","MAJh","MAJl","All","_SHA512","sha512","ed25519_CURVE","Gx","Gy","P","N","_a","_d","err","args","captureStackTrace","captureTrace","u8n","u8fr","padh","toString","padStart","bytesToHex","join","_ch","ch","hexToBytes","hex","hl","al","array","ai","hi","n1","n2","cr","concatBytes","arrs","r","reduce","sum","forEach","big","assertRange","max","isBig","M","invert","num","md","y","u","q","m","apoint","Point","B256","static","X","Y","Z","T","CURVE","fromAffine","fromBytes","zip215","normed","lastByte","bytesToNumLE","y2","isValid","uvRatio","isXOdd","isLastByteOdd","fromHex","toAffine","assertValidity","is0","X2","Y2","Z2","Z4","aX2","equals","other","X1","Y1","Z1","X1Z2","X2Z1","Y1Z2","Y2Z1","I","negate","double","A","B","C","D","x1y1","E","G","F","H","X3","Y3","T3","Z3","T1","T2","subtract","multiply","safe","wNAF","multiplyUnsafe","scalar","iz","toBytes","numTo32bLE","toHex","clearCofactor","isSmallOrder","isTorsionFree","BASE","ZERO","reverse","pow2","power","RM1","v3","pow","b2","b4","b5","b10","b20","b40","b80","b160","b240","b250","pow_p_5_8","pow_2_252_3","vx2","root1","root2","useRoot1","useRoot2","noRoot","modL_LE","modN","sha512s","fn","hashes","callHash","getExtendedPublicKey","secretKey","hashed","head","point","pointBytes","hash2extK","getPublicKey","priv","etc","mod","randomBytes","getRandomValues","sha512Async","pwindows","ceil","scalarBits","Gpows","ctneg","cnd","comp","points","precompute","mask","pow_2_w","shiftBy","wbits","off","offF","offP","abs","isEven","isNeg"],"sourceRoot":""}